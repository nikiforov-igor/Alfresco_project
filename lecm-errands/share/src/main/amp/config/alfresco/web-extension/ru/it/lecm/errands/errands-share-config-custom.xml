<alfresco-config>
    <config>
        <forms>
            <dependencies>
                <js src="/scripts/lecm-errands/constraints/errands-request-cancel-new-executor-validator.js"/>
                <js src="/scripts/lecm-errands/constraints/errands-request-change-due-date-validator.js"/>
                <!--<js src="/scripts/lecm-errands/constraints/errands-limitation-date-validator.js"/>-->
                <js src="/scripts/lecm-errands/constraints/errands-check-coosing-executor.js"/>
            </dependencies>

           <default-controls>
                <type name="association:lecm-errands-dic:errand-titles" template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                    <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                    <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="notSelectedOptionShow">true</control-param>
                    <control-param name="notSelectedOptionLabel"> </control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                </type>
            </default-controls>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-errands:document">
        <forms>
            <form>
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Статус -->
                    <show id="lecm-statemachine:status" force="true"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Срок завершения поручения -->
                    <show id="lecm-errands:end-date"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Дата начала -->
                    <show id="lecm-errands:start-date"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор поручения -->
                    <show id="lecm-document:creator"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Исполнить точно в срок  -->
                    <show id="lecm-errands:just-in-time"/>
                    <!-- Разделительная линия -->
                    <show id="lecm-errands:line"/>
                    <!-- Дата исполнения -->
                    <show id="lecm-errands:execution-date"/>
                    <!-- Отчет об исполнении -->
                    <show id="lecm-errands:execution-report"/>
                    <!-- Отчеты соисполнителей -->
                    <show id="lecm-errands-ts:coexecutor-reports-assoc"/>
                </field-visibility>
                <appearance>
                    <set id="common" appearance=""/>
                    <set id="coexecutors-reports" appearance="title" label-id="title.errands.coexecutors-reports"/>

                    <field id="lecm-errands:is-important" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/important.ftl" />
                    </field>
                    <field id="lecm-statemachine:status" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/status.ftl" />
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="common">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Errands.checkChoosingInitiatorValidation" event="change"/>
                        </constraint-handlers>
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date" mandatory="true" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
	                <field id="lecm-errands:executor-assoc" set="common">
		                <control>
			                <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
		                </control>
	                </field>
                    <field id="lecm-errands:end-date" set="common"/>
					<field id="lecm-errands:controller-assoc" set="common">
						<control>
							<control-param name="showSearch">true</control-param>
						</control>
					</field>
					<field id="lecm-errands:start-date" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
					</field>
                    <field id="lecm-errands:content" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" set="common">
		                <control>
							<control-param name="showSearch">true</control-param>
			                <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
		                </control>
	                </field>
                    <field id="lecm-document:creator" set="common"/>
                    <field id="lecm-document:subject-assoc" set="common"/>
                    <field id="lecm-errands:without-initiator-approval" set="common"/>
                    <field id="lecm-errands:just-in-time" set="common"/>
                    <field id="lecm-errands:line" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/line.ftl"/>
                    </field>
					<field id="lecm-errands:execution-date" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
					</field>
                    <field id="lecm-errands:execution-report" set="common">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>

                    <field id="lecm-errands-ts:coexecutor-reports-assoc" set="coexecutors-reports">
                        <control template="/ru/it/lecm/errands/controls/coexecutors-reports-table-control.ftl">
                            <control-param name="datagridFormId">coexecutors-reports-datagrid</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="document-dashlet">
                <field-visibility>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                </field-visibility>
            </form>
            <form id="document">
                <field-visibility>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:initiator-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="nameSubstituteString">{lecm-orgstr:employee-short-name}</control-param>
                            <control-param name="itemType">lecm-orgstr:employee</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
	                        <control-param name="useStrictFilterByOrg">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="transfer-right">
                <field-visibility>
                    <show id="lecm-document:employee-ref"/>
                    <show id="lecm-document:istransmit" />
                    <show id="lecm-document:deprive-right" />
                </field-visibility>
                <appearance>
                    <field id="lecm-document:employee-ref" label-id="contract.creator-ref" mandatory="true">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="itemType">lecm-orgstr:employee</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
	                        <control-param name="useStrictFilterByOrg">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:istransmit" label-id="contract.istransmit" />
                    <field id="lecm-document:deprive-right" label-id="contract.deprive.right" />
                </appearance>
            </form>
            <form id="errands-dnd">
                <field-visibility>
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-document-aspects:attachments-temp-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                            <control-param name="showAttsLabel">false</control-param>
                            <control-param name="showAttsList">false</control-param>
                            <control-param name="autoSubmit">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-errands:document">
        <forms>
            <form>
                <create-form template="/ru/it/lecm/errands/components/errands-create-form-template.ftl" />
                <field-visibility>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Дата начала -->
                    <show id="lecm-errands:start-date"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Исполнить точно в срок  -->
                    <show id="lecm-errands:just-in-time"/>
                    <!--  Вложения -->
	                <show id="lecm-document-aspects:attachments-temp-assoc"/>

                    <!-- Свернута ли форма  -->
                    <show id="lecm-errands:is-short"/>
	                <!-- Ссылки  -->
                    <show id="lecm-errands:links-assoc"/>
	                <!-- отчёт об исполнении  -->
                    <show id="lecm-errands:execution-report"/>
	                <!-- Дата исполнения -->
	                <show id="lecm-errands:execution-date"/>
	                <!-- Поручения, созданные на основании -->
	                <show id="lecm-errands:child-errands"/>
	                <!-- Ссылки исполнения  -->
	                <show id="lecm-errands:execution-links-assoc"/>
                    <show id="change-executors-script" force="true"/>
                    <show id="lecm-document-aspects:template-name" force="true"/>
                    <show id="lecm-document-aspects:template-ref" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="collapsible1"/>
                    <set id="static1"/>
                    <set id="collapsible2"/>
                    <set id="exist-bussines-role" parent="collapsible2" template="/ru/it/lecm/deputy/controls/errands-choosing-set.ftl" />
                    <set id="collapsible2-inner" parent="collapsible2"/>
                    <set id="static2"/>

                    <field id="lecm-errands:title">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc">
                        <control>
	                        <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
							<control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
	                <field id="lecm-errands:coexecutors-assoc" set="collapsible1">
		                <control>
							<control-param name="showSearch">true</control-param>
			                <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
		                </control>
	                </field>
                    <field id="lecm-errands:limitation-date" mandatory="true" set="static1">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                    </field>
					<field id="lecm-errands:controller-assoc" set="collapsible2">
						<control>
							<control-param name="showSearch">true</control-param>
						</control>
					</field>
                    <field id="lecm-errands:initiator-assoc" set="exist-bussines-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="change-executors-script" set="exist-bussines-role">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-executors.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-important" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:without-initiator-approval" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
	                        <control-param name="defaultValueDataSource">lecm/errands/getDefaultWithoutInitiatorApproval</control-param>
                        </control>
                    </field>
					<field id="lecm-errands:start-date" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
					</field>
                    <field id="lecm-document:subject-assoc" set="collapsible2-inner">
                        <control>
	                        <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:just-in-time" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:attachments-temp-assoc" set="static2">
		                <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
			                <control-param name="uploadDirectoryPath">{usertemp}</control-param>
			                <control-param name="directoryName">label.errands.attachments</control-param>
		                </control>
	                </field>
                    <field id="lecm-errands:is-short">
                        <control template="/org/alfresco/components/form/controls/hidden.ftl"/>
                    </field>
	                <field id="lecm-errands:links-assoc">
		                <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
	                </field>
	                <field id="lecm-errands:execution-report">
                        <control template="/org/alfresco/components/form/controls/hidden.ftl"/>
                    </field>
	                <field id="lecm-errands:execution-date">
                        <control template="/org/alfresco/components/form/controls/hidden.ftl"/>
                    </field>
	                <field id="lecm-errands:child-errands" label-id="field.childErrands.title">
                        <control template="/org/alfresco/components/form/controls/hidden.ftl"/>
                    </field>
	                <field id="lecm-errands:execution-links-assoc">
		                <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
	                </field>
                    <field id="lecm-document-aspects:template-name">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-ref">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>
                </appearance>
            </form>
            <form id="document-template-fields">
                <create-form template="/ru/it/lecm/errands/components/errands-create-form-template.ftl" />
                <field-visibility>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Дата начала -->
                    <show id="lecm-errands:start-date"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Исполнить точно в срок  -->
                    <show id="lecm-errands:just-in-time"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:title">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc">
                        <control>
	                        <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
							<control-param name="useStrictFilterByOrg">true</control-param>
                            <control-param name="additionalFilter">{{EMPLOYEE_HAS_LOGIN}}</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
	                <field id="lecm-errands:coexecutors-assoc">
		                <control>
			                <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                            <control-param name="additionalFilter">{{EMPLOYEE_HAS_LOGIN}}</control-param>
		                </control>
	                </field>
                    <field id="lecm-errands:limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:controller-assoc">
                        <control>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                            <control-param name="additionalFilter">{{EMPLOYEE_HAS_LOGIN}}</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc">
                        <control>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                            <control-param name="additionalFilter">{{EMPLOYEE_HAS_LOGIN}}</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:without-initiator-approval">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
	                        <control-param name="defaultValueDataSource">lecm/errands/getDefaultWithoutInitiatorApproval</control-param>
                        </control>
                    </field>
					<field id="lecm-errands:start-date">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
					</field>
                    <field id="lecm-document:subject-assoc">
                        <control>
	                        <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-errands:is-important"/>
                    <show id="lecm-errands:baseDocString"/>
                    <show id="lecm-errands:number"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:is-expired"/>
                    <show id="lecm-errands:initiator-assoc"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-statemachine:status" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:is-important" label=""/>
                    <field id="lecm-errands:baseDocString" label="" substituteString="{lecm-errands:additional-document-assoc/lecm-document:present-string}"/>
                    <field id="lecm-errands:initiator-assoc"/>
                    <field id="lecm-errands:executor-assoc"/>
                    <field id="lecm-errands:execution-date"/>
                    <field id="lecm-errands:title"/>
                    <field id="lecm-statemachine:status" force="true"/>
                    <field id="lecm-errands:number" label-id="errands.number"/>
                </appearance>
            </form>
            <form id="search">
                <field-visibility>
                    <show id="lecm-errands:initiator-assoc"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="cm:created"/>
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-errands:number"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:is-important"/>
                    <show id="lecm-errands:is-expired"/>
                    <show id="lecm-errands:base-doc-number"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:initiator-assoc" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="cm:created">
                        <control template="/ru/it/lecm/base-share/components/controls/daterange-control.ftl">
                            <control-param name="forceEditable">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-date">
                        <control template="/ru/it/lecm/base-share/components/controls/daterange-control.ftl"/>
                    </field>
                    <field id="lecm-errands:title" mandatory="false">
                        <control template="/ru/it/lecm/base-share/components/controls/textfield.ftl">
                            <control-param name="hideValue"/>
                            <control-param name="mandatory">false</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:number">
                        <control template="/ru/it/lecm/base-share/components/controls/textfield.ftl">
                            <control-param name="hideValue"/>
                            <control-param name="nameSuffix">-strong-constant-upper-case</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" mandatory="false">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:is-important">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-expired">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:base-doc-number">
                        <control template="/ru/it/lecm/base-share/components/controls/textfield.ftl">
                            <control-param name="nameSuffix">-strong-constant-upper-case</control-param>
                        </control>
                    </field>

                </appearance>
            </form>
            <form id="workflow-form">
                <create-form template="/ru/it/lecm/errands/components/errands-create-form-template.ftl" />
                <field-visibility>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Дата начала -->
                    <show id="lecm-errands:start-date"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Исполнить точно в срок  -->
                    <show id="lecm-errands:just-in-time"/>
                    <!--  Вложения -->
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                    <!-- Свернута ли форма  -->
                    <show id="lecm-errands:is-short"/>
                    <!-- Ссылка на документ основание  -->
                    <show id="lecm-errands:additional-document-assoc"/>
                </field-visibility>
                <appearance>
                    <set id="collapsible1"/>
                    <set id="static1"/>
                    <set id="collapsible2"/>
                    <set id="exist-bussines-role" parent="collapsible2" appearance="ERRANDS_CHOOSING_INITIATOR" template="/ru/it/lecm/deputy/controls/errands-choosing-set.ftl" />
                    <set id="collapsible2-inner" parent="collapsible2"/>
                    <set id="static2"/>

                    <field id="lecm-errands:title">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc">
                        <control>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-orgstr:employee-short-name}</control-param>
                            <control-param name="allowedNodesScript">lecm/errands/getAvailableEmployeesForChildErrand?parentDoc={parentDoc}</control-param>
                            <control-param name="param_parentDoc">parentDoc</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
	                <field id="lecm-errands:coexecutors-assoc" set="collapsible1">
                        <control>
							<control-param name="showSearch">true</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-orgstr:employee-short-name}</control-param>
                            <control-param name="allowedNodesScript">lecm/errands/getAvailableEmployeesForChildErrand?parentDoc={parentDoc}</control-param>
                            <control-param name="param_parentDoc">parentDoc</control-param>
                        </control>
	                </field>
                    <field id="lecm-errands:limitation-date" mandatory="true" set="static1">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                            <control-param name="maxLimitArg">parentLimitationDate</control-param>
                        </control>
                    </field>
					<field id="lecm-errands:controller-assoc" set="collapsible2">
						<control>
							<control-param name="showSearch">true</control-param>
						</control>
					</field>
                    <field id="lecm-errands:initiator-assoc" set="exist-bussines-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-important" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:without-initiator-approval" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultWithoutInitiatorApproval</control-param>
                        </control>
                    </field>
					<field id="lecm-errands:start-date" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
					</field>
                    <field id="lecm-document:subject-assoc" set="collapsible2-inner">
	                    <control>
		                    <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
	                    </control>
                    </field>
                    <field id="lecm-errands:just-in-time" set="collapsible2-inner">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:attachments-temp-assoc" set="static2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-short" set="collapsable">
                        <control template="/org/alfresco/components/form/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-errands:additional-document-assoc">
                        <control template="/ru/it/lecm/errands/controls/additional-document-assoc.ftl">
	                        <control-param name="parentDocArg">parentDoc</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="statemachine-editable-fields">
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Статус -->
                    <show id="lecm-statemachine:status" force="true"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Срок завершения поручения -->
                    <show id="lecm-errands:end-date"/>
                    <!-- Контроллер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Дата начала -->
                    <show id="lecm-errands:start-date"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор поручения -->
                    <show id="lecm-document:creator"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Разделительная линия -->
                    <show id="lecm-errands:line"/>
                    <!-- Дата исполнения -->
                    <show id="lecm-errands:execution-date"/>
                    <!-- Отчет об исполнении -->
                    <show id="lecm-errands:execution-report"/>
                    <!-- Отчеты соисполнителей -->
                    <show id="lecm-errands-ts:coexecutor-reports-assoc"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Исполнить точно в срок  -->
                    <show id="lecm-errands:just-in-time"/>
                </field-visibility>
            </form>
            <form id="searchQueryGrid">
                <field-visibility>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-statemachine:status" force="true"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:controller-assoc"/>
                    <show id="lecm-errands:initiator-assoc"/>
                </field-visibility>
            </form>
            <form id="search-editor-fields">
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Статус -->
                    <show id="lecm-statemachine:status" force="true"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:number"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Срок завершения поручения -->
                    <show id="lecm-errands:end-date"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Дата начала -->
                    <show id="lecm-errands:start-date"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Исполнить точно в срок  -->
                    <show id="lecm-errands:just-in-time"/>
                    <!-- Дата исполнения -->
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-document:author-assoc"/>
                    <show id="lecm-errands:execution-report"/>

                    <show id="cm:created"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-errands-ts:coexecutor-report">
        <forms>
            <form id="coexecutors-reports-datagrid">
                <field-visibility>
                    <show id="lecm-errands-ts:coexecutor-assoc" force="true"/>
                    <show id="lecm-errands-ts:coexecutor-report-status" force="true"/>
                    <show id="cm:created" force="true"/>
                    <show id="lecm-errands-ts:coexecutor-report-attachment-assoc" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-errands-ts:coexecutor-report">
        <forms>
            <form id="table-structure-expand">
                <field-visibility>
                    <show id="lecm-errands-ts:coexecutor-report-text" force="true"/>
                </field-visibility>
            </form>
            <form>
                <field-visibility>
                    <show id="lecm-errands-ts:coexecutor-assoc" force="true"/>
                    <show id="lecm-errands-ts:coexecutor-report-text" force="true"/>
                    <show id="lecm-errands-ts:coexecutor-report-status" force="true"/>
                    <show id="lecm-errands-ts:coexecutor-report-attachment-assoc" force="true"/>
                    <show id="cm:created" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands-ts:coexecutor-report-attachment-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Отчёты соисполнителей</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-errands-ts:coexecutor-reports-table">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

	<config evaluator="node-type" condition="lecm-errands-dic:errand-titles">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands-dic:errand-title-code" read-only="true"/>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-errands-dic:errand-titles">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands-dic:errand-title-code">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
							<constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup" />
						</constraint-handlers>
					</field>
				</appearance>
			</form>
			<form id="search">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
				<appearance>
                    <field id="cm:name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
					<field id="lecm-errands-dic:errand-title-code" mandatory="false">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
						</constraint-handlers>
					</field>
				</appearance>
			</form>
			<form id="datagrid">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
			</form>
		</forms>
	</config>

	<config evaluator="node-type" condition="lecm-errands:settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:settings-mode-choosing-executors"/>
					<show id="lecm-errands:settings-transfer-rights"/>
                    <show id="lecm-errands:settings-hide-additional-attrs"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands:settings-mode-choosing-executors">
						<control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-errands:settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:settings-mode-choosing-executors"/>
					<show id="lecm-errands:settings-transfer-rights"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands:settings-mode-choosing-executors">
						<control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="node-type" condition="lecm-errands:user-settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:user-settings-without-initiator-approval"/>
					<show id="lecm-errands:user-settings-default-initiator-assoc"/>
					<show id="lecm-errands:user-settings-default-subject-assoc"/>
				</field-visibility>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-errands:user-settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:user-settings-without-initiator-approval"/>
					<show id="lecm-errands:user-settings-default-initiator-assoc"/>
					<show id="lecm-errands:user-settings-default-subject-assoc"/>
				</field-visibility>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsRemoveDraft">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsCreateChildErrand">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-links:link">
        <forms>
            <form>
                <field-visibility>
                    <!-- Название ссылки -->
                    <show id="cm:name"/>
                    <!-- Описание -->
                    <show id="cm:description"/>
                    <!-- Ссылка -->
                    <show id="lecm-links:url"/>
                </field-visibility>
            </form>
        </forms>
    </config>


    <config evaluator="string-compare" condition="activiti$errandsRequestDueDateChange">
        <forms>
            <form>
                <field-visibility>
                    <show id="bpm:workflowDescription"/>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:requestDueDateChangeNewDate"/>
                    <show id="lecmErrandWf:requestDueDateChangeReason"/>
                </field-visibility>
                <appearance>
	                <field id="bpm:workflowDescription">
		                <control template="/ru/it/lecm/documents/controls/workflow/document-present-string-hidden.ftl">
			                <control-param name="leftPartTextCode">ru.it.errand.requestDueDateChange.workflowDescription.message</control-param>
		                </control>
	                </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
					<field id="lecmErrandWf:requestDueDateChangeNewDate">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
					</field>
	                <field id="lecmErrandWf:requestDueDateChangeReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="task-type" condition="lecmErrandWf:requestDueDateChangeTask">
		<forms>
			<form>
				<field-visibility>
					<show id="lecmErrandWf:requestDueDateChangeTaskNewDate"/>
					<show id="lecmErrandWf:requestDueDateChangeTaskDateReason"/>
					<show id="lecmErrandWf:requestDueDateChangeTaskComment"/>
					<show id="lecmErrandWf:requestDueDateChangeTaskResult"/>
				</field-visibility>
				<appearance>
					<field id="lecmErrandWf:requestDueDateChangeTaskNewDate" mandatory="true" read-only="true">
						<control template="/ru/it/lecm/base-share/components/controls/date.ftl">
							<control-param name="minLimitCurrentDate">true</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestChangeDueDateTaskNewDateValidation" event="change"/>
						</constraint-handlers>
					</field>
					<field id="lecmErrandWf:requestDueDateChangeTaskDateReason" read-only="true">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
							<control-param name="rows">7</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestDueDateChangeTaskComment">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
							<control-param name="rows">7</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestDueDateChangeTaskResult" mandatory="true">
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestChangeDueDateTaskNewDateValidation" event="change"/>
						</constraint-handlers>
						<control template="/ru/it/lecm/base-share/components/controls/activiti-transitions-radiobuttons.ftl" />
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsChangeDueDate">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsChangeExecutor">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
	                <show id="lecmErrandWf:changeExecutorCurrentExecutor" />
	                <show id="lecmErrandWf:changeExecutorNewExecutor"/>
	                <show id="lecmErrandWf:changeExecutorReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:changeExecutorCurrentExecutor" label-id="field.changeExecutorCurrentExecutor.title">
		                <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
			                <control-param name="substituteString">
				                <![CDATA[
					                <a href='/share/page/view-metadata?nodeRef={lecm-errands:executor-assoc/nodeRef}'>
					                    {lecm-errands:executor-assoc/lecm-orgstr:employee-short-name} {lecm-errands:executor-assoc/..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}
					                </a>
				                ]]>
			                </control-param>
		                </control>
	                </field>
                    <field id="lecmErrandWf:changeExecutorNewExecutor">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                        </control>
                    </field>
	                <field id="lecmErrandWf:changeExecutorReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsChangeController">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:changeControllerCurrentController" />
                    <show id="lecmErrandWf:changeControllerNewController"/>
                    <show id="lecmErrandWf:changeControllerReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:changeControllerCurrentController" label-id="field.changeControllerCurrentController.title">
                        <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
                            <control-param name="substituteString">
                                <![CDATA[
					                <a href='/share/page/view-metadata?nodeRef={lecm-errands:controller-assoc/nodeRef}'>
					                    {lecm-errands:controller-assoc/lecm-orgstr:employee-short-name} {lecm-errands:controller-assoc/..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}
					                </a>
				                ]]>
                            </control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:changeControllerReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsRequestCancel">
        <forms>
            <form>
                <field-visibility>
	                <show id="bpm:workflowDescription" />
                    <show id="packageItems"/>
	                <show id="lecmErrandWf:requestCancelReason"/>
                </field-visibility>
                <appearance>
	                <field id="bpm:workflowDescription">
		                <control template="/ru/it/lecm/documents/controls/workflow/document-present-string-hidden.ftl">
			                <control-param name="leftPartTextCode">ru.it.errand.requestCancel.workflowDescription.message</control-param>
		                </control>
	                </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:requestCancelReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="task-type" condition="lecmErrandWf:requestCancelTask">
		<forms>
			<form>
				<field-visibility>
					<show id="lecmErrandWf:requestCancelTaskTitle" />
					<show id="lecmErrandWf:requestCancelTaskReason" />
					<show id="lecmErrandWf:requestCancelTaskResult" />
					<show id="lecmErrandWf:requestCancelTaskNewExecutor" />
				</field-visibility>
				<appearance>
					<field id="lecmErrandWf:requestCancelTaskTitle">
						<control template="/ru/it/lecm/base-share/components/controls/view-text-control.ftl">
							<control-param name="showLabel">false</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestCancelTaskReason" read-only="true">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
							<control-param name="rows">7</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestCancelTaskResult" mandatory="true">
						<control template="/ru/it/lecm/base-share/components/controls/activiti-transitions-radiobuttons.ftl" />
					</field>
					<field id="lecmErrandWf:requestCancelTaskNewExecutor">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestCancelTaskNewExecutorValidation" message-id="validation-hint.mandatory" event="change"/>
                        </constraint-handlers>
						<control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsInitiatorDecline">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:initiatorDeclineReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:initiatorDeclineReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$errandsInitiatorApprove">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems"/>
					<show id="lecmErrandWf:errandInitiatorApproveMessage" />
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmErrandWf:errandInitiatorApproveMessage">
						<control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
							<control-param name="msg">ru.it.errand.initiatorApprove.message</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsControllerDecline">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
	                <show id="lecmErrandWf:controllerDeclineReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:controllerDeclineReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$errandsControllerApprove">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems"/>
					<show id="lecmErrandWf:errandControllerApproveMessage" />
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmErrandWf:errandControllerApproveMessage">
						<control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
							<control-param name="msg">ru.it.errand.controllerApprove.message</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsCancel">
        <forms>
            <form>
	            <field-visibility>
		            <show id="packageItems"/>
		            <show id="lecmErrandWf:cancelReason"/>
	            </field-visibility>
	            <appearance>
		            <field id="packageItems">
			            <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
		            </field>
		            <field id="lecmErrandWf:cancelReason">
			            <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
				            <control-param name="rows">7</control-param>
			            </control>
		            </field>
	            </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$errandsExecute">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems"/>
					<show id="lecmErrandWf:errandExecuteMessage" />
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmErrandWf:errandExecuteMessage">
						<control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
							<control-param name="msg">ru.it.errand.execute.message</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsCoexecutorReport">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:coexecutorReportText" />
                    <show id="lecmErrandWf:coexecutorReportAttachment"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:coexecutorReportText">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl"/>
                    </field>
                    <field id="lecmErrandWf:coexecutorReportAttachment">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Отчёты соисполнителей</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="activiti$createErrands">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecmErrandWf:executorAssoc"/>   <!-- lecm-errands:executor-assoc -->
                    <show id="lecmErrandWf:isImportant"/>   <!-- lecm-errands:is-important -->
                    <show id="lecmErrandWf:title"/>   <!-- lecm-errands:title -->
                    <show id="lecmErrandWf:content"/>   <!-- lecm-errands:content -->
                    <show id="lecmErrandWf:limitationDate"/>   <!-- lecm-errands:limitation-date -->
                    <show id="lecmErrandWf:controllerAssoc"/>   <!-- lecm-errands:controller-assoc -->
                    <show id="lecmErrandWf:coexecutorsAssoc"/>   <!-- lecm-errands:coexecutors-assoc -->
                    <show id="lecmErrandWf:withoutInitiatorApproval"/>   <!-- lecm-errands:without-initiator-approval -->
                    <show id="lecmErrandWf:startDate"/>   <!-- lecm-errands:start-date -->
                    <show id="lecmErrandWf:justInTime"/>   <!-- lecm-errands:just-in-time -->

                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <field id="lecmErrandWf:executorAssoc">
                        <control>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-orgstr:employee-short-name}</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:isImportant">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:title">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:content">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                    <field id="lecmErrandWf:limitationDate" mandatory="true">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                    </field>

                    <field id="lecmErrandWf:controllerAssoc"/>
                    <field id="lecmErrandWf:coexecutorsAssoc">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:withoutInitiatorApproval">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultWithoutInitiatorApproval</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:startDate">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:justInTime">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>

                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>

        </forms>
    </config>

    <config evaluator="string-compare" condition="Workflow">
        <hidden-workflows>
            <workflow name="activiti$lecm-errands_document"/>
            <workflow name="activiti$errandsRequestDueDateChange"/>
            <workflow name="activiti$errandsRequestCancel"/>
            <workflow name="activiti$errandsChangeDueDate"/>
            <workflow name="activiti$errandsInitiatorApprove"/>
            <workflow name="activiti$errandsInitiatorDecline"/>
            <workflow name="activiti$errandsExecute"/>
            <workflow name="activiti$errandsControllerDecline"/>
            <workflow name="activiti$errandsControllerApprove"/>
            <workflow name="activiti$errandsCancel"/>
            <workflow name="activiti$errandsChangeExecutor"/>
            <workflow name="activiti$errandsChangeController"/>
            <workflow name="activiti$errandsCreateChildErrand"/>
            <workflow name="activiti$errandsRemoveDraft"/>
            <workflow name="activiti$errandsCoexecutorReport"/>
        </hidden-workflows>
    </config>

    <config evaluator="node-type" condition="lecm-errands:dashlet-settings">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-errands:dashlet-settings-arm"/>
                    <show id="lecm-errands:dashlet-settings-path"/>
                    <show id="lecm-errands:dashlet-settings-unexecuted"/>
                    <show id="lecm-errands:dashlet-settings-unexecuted-important"/>
                    <show id="lecm-errands:dashlet-settings-await-execution"/>
                    <show id="lecm-errands:dashlet-settings-await-execution-important"/>
                    <show id="lecm-errands:dashlet-settings-expired"/>
                    <show id="lecm-errands:dashlet-settings-expired-important"/>
                    <show id="lecm-errands:dashlet-settings-approaching-deadline"/>
                    <show id="lecm-errands:dashlet-settings-approaching-deadline-important"/>

                </field-visibility>
            </form>
        </forms>
    </config>

</alfresco-config>
