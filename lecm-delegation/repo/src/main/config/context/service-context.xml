<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<!-- Registration of Delegations models -->
	<bean id="${groupId}.${artifactId}.delegationBootstrap" parent="dictionaryModelBootstrap" depends-on="dictionaryBootstrap, ru.it.lecm.orgstructure.orgstructure-repo.orgStructureBootstrap">
		<property name="models">
			<list>
				<value>alfresco/module/${artifactId}/models/lecm-delegations-model.xml</value>
				<value>alfresco/module/${artifactId}/models/role-model.xml</value>
				<value>alfresco/module/${artifactId}/models/delegation-model.xml</value>
			</list>
		</property>
		<property name="labels">
			<list>
				<value>alfresco/module/${artifactId}/messages/delegation</value>
			</list>
		</property>
	</bean>

	<bean id="testSearch" class="ru.it.lecm.delegation.beans.TestSearchBean" depends-on="nodeService, NodeService">
		<property name="serviceRegistry" ref="ServiceRegistry" />
		<property name="repositoryHelper" ref="repositoryHelper"/>
		<property name="secureNodeService" ref="NodeService" />
		<property name="fastNodeService" ref="nodeService" />
	</bean>

	<!-- ${groupId}.${artifactId}.serviceDelegation -->
	<bean id="serviceDelegation" class="ru.it.lecm.delegation.beans.DelegationBean" depends-on="testSearch" init-method="bootstrap">
		<property name="serviceRegistry" ref="ServiceRegistry"/>
		<property name="repository" ref="repositoryHelper"/>
		<property name="transactionService" ref="transactionService"/>
		<property name="tester" ref="testSearch"/>
	</bean>

	<bean id="serviceDelegationWebScript" class="ru.it.lecm.delegation.beans.DelegationBeanWebScript" depends-on="serviceDelegation">
		<property name="proxy" ref="serviceDelegation" />
	</bean>

	<bean id="webscript.ru.it.lecm.delegation.DelegationRepoWebScript.post" class="ru.it.lecm.delegation.beans.DelegationRepoWebScript" parent="webscript">
		<property name="delegationService" ref="serviceDelegationWebScript"/>
	</bean>

	<bean id="delegationOptsPolicy" class="ru.it.lecm.delegation.policies.DelegationOptsPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent"/>
	</bean>

	<bean id="delegationJavascriptExtension" class="ru.it.lecm.delegation.extensions.DelegationJavascriptExtension" parent="baseJavaScriptExtension">
		<property name="extensionName" value="delegation"/>
		<property name="serviceRegistry" ref="ServiceRegistry"/>
		<property name="namespacePrefixResolver" ref="namespaceService"/>
		<property name="serviceDelegation" ref="serviceDelegation"/>
	</bean>

</beans>
