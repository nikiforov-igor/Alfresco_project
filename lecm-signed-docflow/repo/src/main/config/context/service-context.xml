<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:util="http://www.springframework.org/schema/util"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<import resource="classpath:gate-wcf-service-context.xml"/>
	<import resource="classpath:alfresco/module/${artifactId}/context/webscript-context.xml" />
	<import resource="classpath:alfresco/module/${artifactId}/context/policy-context.xml" />

	<bean id="unicloudService" class="ru.it.lecm.signed.docflow.UnicloudService" init-method="init">
		<property name="gateWcfService" ref="gateWcfService.https"/>
		<property name="orgstructureService" ref="serviceOrgstructure"/>
		<property name="nodeService" ref="nodeService"/>
		<property name="contentService" ref="contentService"/>
		<property name="transactionService" ref="transactionService"/>
		<property name="signedDocflowService" ref="signedDocflowService"/>
	</bean>

	<bean id="lecm.signed-docflow.model-bootstrap" parent="dictionaryModelBootstrap" depends-on="dictionaryBootstrap, ru.it.lecm.orgstructure.orgstructure-repo.orgStructureBootstrap">
		<property name="models">
			<list>
				<value>alfresco/module/${artifactId}/models/signed-docflow-model.xml</value>
			</list>
		</property>
		<property name="labels">
			<list>
				<value>alfresco/module/${artifactId}/messages/signed-docflow</value>
			</list>
		</property>
	</bean>

	<bean id="lecm.signed-docflow.business-journal-dictionary-bootstrap"
		  parent="lecmDictionaryBootstrap"
		  depends-on="ru.it.lecm.orgstructure.orgstructure-repo.orgBootstrap, ru.it.lecm.business-journal.business-journal-repo.businessJournalBootstrap,
						ru.it.lecm.business-journal.business-journal-repo.businessJournalDictionaryBootstrap, businessJournalLogEventsPolicy">
		<property name="createOrUpdateDictionaries">
			<list>
				<value>alfresco/module/${artifactId}/models/lecm-business-journal-eventCategory-items.xml</value>
				<value>alfresco/module/${artifactId}/models/lecm-business-journal-objectType-items.xml</value>
			</list>
		</property>
	</bean>

	<util:constant id="signedDocflowFolder" static-field="ru.it.lecm.signed.docflow.beans.SignedDocflowImpl.SIGNED_DOCFLOW_FOLDER"/>
	<bean id="signedDocflowService" class="ru.it.lecm.signed.docflow.beans.SignedDocflowImpl" parent="baseBean"
		  depends-on="lecm.signed-docflow.model-bootstrap" init-method="init">
		<property name="folders">
			<map>
				<entry key="#{signedDocflowFolder}" value="Сервис ЮЗД"/>
			</map>
		</property>
		<property name="nodeService" ref="nodeService"/>
		<property name="transactionService" ref="transactionService"/>
		<property name="orgstructureService" ref="serviceOrgstructure"/>
		<property name="unicloudService" ref="unicloudService"/>
		<property name="businessJournalService" ref="businessJournalService"/>
		<property name="authService" ref="authenticationService"/>
		<property name="documentAttachmentsService" ref="documentAttachmentsService"/>
		<property name="versionService" ref="versionService"/>
		<property name="contentService" ref="contentService"/>
	</bean>

	<bean id="sendContentToPartnerService" class="ru.it.lecm.signed.docflow.SendContentToPartnerService">
		<property name="documentAttachmentsService" ref="documentAttachmentsService"/>
		<property name="nodeService" ref="nodeService"/>
		<property name="unicloudService" ref="unicloudService"/>
		<property name="businessJournalService" ref="businessJournalService"/>
	</bean>

</beans>
