<?xml version="1.0" encoding="UTF-8"?>
<extension>
	<modules>
		<module>
			<id>Check Document Details Page Permissions</id>
			<evaluator type="default.extensibility.evaluator"/>
			<auto-deploy>true</auto-deploy>
			<components>
				<!-- Убираем блоки со страницы document-details если нет разрешений -->
				<component>
					<scope>template</scope>
					<region-id>web-preview</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="web-preview">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>comments</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="comments">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>document-actions</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="document-actions">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>document-links</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="document-links">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>document-metadata</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="document-metadata">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>document-workflows</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="document-workflows">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>document-versions</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="document-versions">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>document-versions</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="document-versions">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.viewVersionComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ContentAddVer</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>document-publishing</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="document-publishing">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<render>false</render>
								</evaluation>
							</evaluations>
						</sub-component>
					</sub-components>
				</component>

				<component>
					<scope>template</scope>
					<region-id>node-header</region-id>
					<source-id>document-details</source-id>
					<sub-components>
						<sub-component id="default">
							<evaluations>
								<evaluation id="node-header">
									<evaluators>
										<evaluator type="evaluator.ru.it.lecm.documents.hasReadAttachmentComponent">
											<params>
												<nodeRef>{nodeRef}</nodeRef>
												<permission>_lecmPerm_ReadAttachment</permission>
												<aspect>lecm-document-aspects:lecm-attachment</aspect>
											</params>
										</evaluator>
									</evaluators>
									<url>/lecm/message/noPermissionsToReadAttachment</url>
								</evaluation>
							</evaluations>

						</sub-component>
					</sub-components>
				</component>

			</components>
		</module>
	</modules>
</extension>