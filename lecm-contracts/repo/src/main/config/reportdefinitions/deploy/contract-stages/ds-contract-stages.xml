<?xml version="1.0" encoding="UTF-8"?>
<ds.config>
    <report.descriptor mnem="contract-stages">
        <l18>
            <item key="RU_RU"><![CDATA[Этапы договора]]></item>
        </l18>
        <provider
            javaClass="ru.it.lecm.reports.generators.GenericDSProviderBase" mnem="PROV_GENERIC_PROVIDER">
            <l18>
                <item key="RU_RU"><![CDATA[genericProvider]]></item>
            </l18>
        </provider>
        <templates>
            <template filename="contract-stages_tmpl.jrxml" type="JASPER" mnem="tmpl">
                <l18>
                    <item key="RU_RU"><![CDATA[contract-stages-template]]></item>
                </l18>
            </template>
        </templates>
        <datasource.descriptor>
            <l18>
                <item key="RU_RU"><![CDATA[c8597f9b-6e30-4556-9ac0-3ff100823258]]></item>
            </l18>
        </datasource.descriptor>
        <roles>CONTRACT_READER,CONTRACT_RECORDER,CONTRACT_EXECUTOR,CONTRACT_CURATOR,CONTRACT_SIGNER</roles>
    </report.descriptor>
    <query.descriptor>
        <offset>0</offset>
        <limit>-1</limit>
        <pgsize>-1</pgsize>
        <queryText><![CDATA[]]></queryText>
        <allVersions>true</allVersions>
        <preferedType>lecm-contract:document</preferedType>
        <isMultiRow>false</isMultiRow>
        <isCustom>false</isCustom>
        <flags/>
    </query.descriptor>
    <fields>
        <field alfrescoType="d:text" displayName="Этапы"
            javaValueClass="java.util.List" jrFldName="stages" queryFldName="{{subreport::stages}}">
            <l18>
                <item key="RU_RU"><![CDATA[Этапы]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Номер договора"
            jrFldName="col_ContractNumber" queryFldName="{lecm-contract:regNumSystem}">
            <l18>
                <item key="RU_RU"><![CDATA[Номер договора]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Дата договора"
            javaValueClass="java.util.Date"
            jrFldName="col_Contract_Date" queryFldName="{lecm-contract:dateRegContracts}">
            <l18>
                <item key="RU_RU"><![CDATA[Дата договора]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text"
            displayName="Контрагент(краткое именование)"
            jrFldName="col_Contragent_ShortName" queryFldName="{lecm-contract:partner-assoc/lecm-contractor:shortname}">
            <l18>
                <item key="RU_RU"><![CDATA[Контрагент(краткое именование)]]></item>
            </l18>
        </field>
    </fields>
    <subreports>
        <subreport destColumnName="stages" name="stages">
            <sublist.source><![CDATA[{lecm-contract-table-structure:stages-assoc/cm:contains/}]]></sublist.source>
            <sublist.type><![CDATA[lecm-contract-table-structure:stage]]></sublist.type>
            <sublist.sort><![CDATA[col_Number|ASC]]></sublist.sort>
            <sublist.item>
                <map>
                    <item key="col_StartDate_Plan"><![CDATA[lecm-contract-table-structure:start-date]]></item>
                    <item key="col_Title"><![CDATA[{lecm-contract-table-structure:name}]]></item>
                    <item key="col_EndDate_Plan"><![CDATA[lecm-contract-table-structure:end-date]]></item>
                    <item key="col_Number"><![CDATA[{lecm-document:indexTableRow}]]></item>
                    <item key="col_Status"><![CDATA[{lecm-contract-table-structure:stage-status}]]></item>
                    <item key="col_Sum"><![CDATA[{lecm-contract-table-structure:stage-amount} {lecm-contract-table-structure:stage-currency-assoc/lecm-currency:alphabetic-code}]]></item>
                    <item key="col_StartDate_Fact"><![CDATA[lecm-contract-table-structure:start-date-real]]></item>
                    <item key="col_EndDate_Fact"><![CDATA[lecm-contract-table-structure:end-date-real]]></item>
                </map>
            </sublist.item>
        </subreport>
    </subreports>
</ds.config>
