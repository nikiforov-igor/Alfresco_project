<?xml version="1.0" encoding="UTF-8"?>
<alfresco-config>
	<config>
		<forms>
			<default-controls>
				<type name="association:approvalReason" template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
					<control-param name="rows">7</control-param>
				</type>
			</default-controls>
		</forms>
	</config>
	<config evaluator="string-compare" condition="activiti$lecmApprovementWorkflow">
		<forms>
			<form>
				<field-visibility>
					<show id="message" force="true"/>
					<show id="packageItems"/>
					<show id="bpm:workflowDescription" />
				</field-visibility>
				<appearance>
					<field id="message">
						<control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
							<control-param name="msg">ru.it.approval.workflow.start.message</control-param>
						</control>
					</field>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="bpm:workflowDescription">
						<control template="/ru/it/lecm/documents/controls/workflow/document-present-string-hidden.ftl">
							<control-param name="leftPartTextCode">ru.it.approval.workflowDescription.message</control-param>
						</control>
					</field>
				</appearance>
			</form>
			<form id="selectRoute">
				<field-visibility>
					<show id="packageItems"/>
					<show id="lecmWorkflowRoutes:selectRouteAssoc" force="true"/>
					<show id="lecmWorkflowRoutes:hackSelectRouteAssocFake" force="true"/>
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmWorkflowRoutes:selectRouteAssoc">
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.Workflow.routeHasEmployeesValidator" event="keyup" message-id="approval.required.filled.route"/>
						</constraint-handlers>
						<control template="/ru/it/lecm/base-share/components/controls/association-complex-control.ftl">
							<control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_маршрутов</control-param>
							<control-param name="nameSubstituteString">{cm:title}</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="employeeAbsenceMarker">false</control-param>
							<control-param name="endpointType">lecmWorkflowRoutes:route</control-param>
							<control-param name="showAssocViewForm">true</control-param>
							<control-param name="plane">true</control-param>
							<control-param name="showSearch">true</control-param>
						</control>
					</field>
					<field id="lecmWorkflowRoutes:hackSelectRouteAssocFake">
						<control template="/ru/it/lecm/workflow/routes/controls/hack-routes-select-control.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>
	<config evaluator="task-type" condition="lecmApprove3:approveTask">
		<forms>
			<form>
				<field-visibility>
					<show id="lecmApprove3:presentString" force="true"/>
					<show id="lecmApprove3:documentPreview" force="true"/>
					<show id="lecmApprove3:decision"/>
					<show id="bpm:comment"/>
					<show id="lecmApprove3:commentAssoc"/>
					<show id="lecmApprove3:approveTaskValidatorFake" force="true"/>
					<!--<show id="bpm:reassignable"/>-->
					<show id="transitions" force="true" />
				</field-visibility>
				<appearance>
					<field id="lecmApprove3:presentString">
						<control template="/ru/it/lecm/workflow/controls/document-present-string.ftl"/>
					</field>
					<field id="lecmApprove3:documentPreview">
						<control template="/ru/it/lecm/documents/controls/document-preview-control.ftl">
							<control-param name="height">361px</control-param>
							<control-param name="viewerHeight">325px</control-param>
						</control>
					</field>
					<field id="lecmApprove3:decision" mandatory="true">
						<control template="/ru/it/lecm/base-share/components/controls/activiti-transitions-radiobuttons.ftl">
							<control-param name="options">APPROVED|Согласовать#alf#REJECTED|Отклонить#alf#APPROVED_WITH_REMARK|Согласовать с замечаниями</control-param>
						</control>
					</field>
					<field id="bpm:comment">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
							<control-param name="rows">4</control-param>
						</control>
					</field>
					<field id="lecmApprove3:commentAssoc" label-id="label.remark.document">
						<control template="/ru/it/lecm/base-share/components/controls/lecm-uploader-control.ftl">
							<control-param name="uploadDirectoryPath">{usertemp}</control-param>
						</control>
					</field>
					<field id="lecmApprove3:approveTaskValidatorFake">
						<control template="/ru/it/lecm/workflow/approval/controls/approval-task-result-validator.ftl"/>
					</field>
					<!--<field id="bpm:reassignable" set="right-set">
						<control template="/ru/it/lecm/base-share/components/controls/reassign-task-control.ftl"/>
					</field>-->
					<field id="transitions">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-value.ftl">
                            <control-param name="fieldValue">Next</control-param>
                        </control>
                    </field>
				</appearance>
			</form>
		</forms>
	</config>
	<config evaluator="task-type" condition="lecmApprove3:startTask">
		<forms>
			<form id="workflow-details">
				<field-visibility>
					<show id="packageItems"/>
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/workflow/controls/package-items-with-result-list-control.ftl">
							<control-param name="nameSubstituteString">{lecm-document:present-string}</control-param>
							<control-param name="resultListType">cm:cmobject</control-param>
						</control>
					</field>
				</appearance>
			</form>
			<form>
				<field-visibility>
					<hide id="packageItems"/>
					<hide id="lecm-workflow:assigneesListAssoc"/>
				</field-visibility>
			</form>
		</forms>
	</config>
</alfresco-config>
