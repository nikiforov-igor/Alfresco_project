<alfresco-config>

	<config evaluator="model-type" condition="lecm-orgstr:employee">
		<forms>
			<form id="secretary-nested-datagrid">
				<field-visibility>
					<show id="lecm-orgstr:employee-last-name"/>
					<show id="lecm-orgstr:employee-first-name"/>
					<show id="lecm-orgstr:employee-middle-name"/>
					<show id="lecm-orgstr:employee-main-unit" force="true"/>
					<show id="lecm-orgstr:employee-main-position" force="true"/>
					<show id="lecm-secretary-aspects:can-receive-tasks-from-chiefs" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-orgstr:employee-main-unit" substituteString="{..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}"/>
					<field id="lecm-orgstr:employee-main-position" substituteString="{..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}"/>
					<field id="lecm-secretary-aspects:can-receive-tasks-from-chiefs" label-id="label.secretary.canReceiveTasks" substituteString="{lecm-orgstr:employee-short-name}"/>
				</appearance>
			</form>
			<form id="chief-sec-datagrid">
				<field-visibility>
					<show id="lecm-orgstr:employee-last-name"/>
					<show id="lecm-orgstr:employee-first-name"/>
					<show id="lecm-orgstr:employee-middle-name"/>
					<show id="lecm-orgstr:employee-main-unit" force="true"/>
					<show id="lecm-orgstr:employee-main-position" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-orgstr:employee-main-unit" substituteString="{..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}"/>
					<field id="lecm-orgstr:employee-main-position" substituteString="{..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}"/>
				</appearance>
			</form>
			<form id="secretary-search-form">
				<field-visibility>
					<show id="assoc:lecm-secretary-aspects:secretary-assoc" force="true"/>
					<show id="lecm-secretary-aspects:chief-assoc" force="true"/>
				</field-visibility>
				<appearance>
					<field id="assoc:lecm-secretary-aspects:secretary-assoc" label-id="label.secretary.search">
						<control template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
							<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="endpointType">lecm-orgstr:employee</control-param>
							<control-param name="plane">true</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="employeeAbsenceMarker">true</control-param>
							<control-param name="useStrictFilterByOrg">true</control-param>
							<control-param name="additionalFilter">ISNOTNULL: \"lecm-orgstr:employee-person-login\" AND NOT @lecm-orgstr\\:employee-person-login: \"\"</control-param>
						</control>
					</field>
				</appearance>
			</form>
			<form id="deputy-search-form">
				<field-visibility>

				</field-visibility>
				<appearance>

				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="node-type" condition="lecm-orgstr:employee">
		<forms>
			<form id="employee-sec-edit">
				<field-visibility>
					<show id="lecm-orgstr:current-employee" force="true"/>
					<show id="lecm-secretary-aspects:sec-fake-assoc"/>
					<show id="lecm-secretary-aspects:secretary-assoc-ref"/>
					<show id="secretary-value-script"/>
				</field-visibility>
				<appearance>
					<field id="lecm-orgstr:current-employee" label-id="label.current.employee">
						<control template="/ru/it/lecm/base-share/components/controls/substitude-control.ftl">
							<control-param name="formatString">{lecm-orgstr:employee-short-name}</control-param>
						</control>
					</field>
					<field id="lecm-secretary-aspects:sec-fake-assoc" label-id="label.employee.secreatries">
						<control template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
							<control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="plane">true</control-param>
							<control-param name="endpointMany">true</control-param>
							<control-param name="endpointType">lecm-orgstr:employee</control-param>
							<control-param name="useDeferedReinit">true</control-param>
						</control>
					</field>
					<field id="lecm-secretary-aspects:secretary-assoc-ref">
						<control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
					</field>
					<field id="secretary-value-script">
						<control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
							<control-param name="scripts">scripts/lecm-secretary/current-secretaries.js</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

</alfresco-config>
