<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:util="http://www.springframework.org/schema/util"
	   xmlns:p="http://www.springframework.org/schema/p"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<util:list id="routes.models">
		<value>alfresco/module/${artifactId}/models/lecm-routes-macros-model.xml</value>
		<value>alfresco/module/${artifactId}/models/lecm-routes-model.xml</value>
	</util:list>
	<util:list id="routes.labels">
		<!--<value>alfresco/module/${artifactId}/messages/lecm-routes</value>-->
		<value>alfresco/module/${artifactId}/messages/routes-macros</value>
	</util:list>
	<bean id="routes.model.bootstrap" parent="dictionaryModelBootstrap"
		  depends-on="dictionaryBootstrap,
					  ru.it.lecm.orgstructure.orgstructure-repo.orgStructureBootstrap,
					  lecm.approval3.decision.model.bootstrap"
		  p:models-ref="routes.models"
		  p:labels-ref="routes.labels"/>

	<util:constant id="routesServiceFolderID" static-field="ru.it.lecm.workflow.routes.beans.RoutesServiceImpl.ROUTES_FOLDER_ID"/>
	<util:map id="routes.folders.map">
		<entry key="#{routesServiceFolderID}" value="Сервис маршрутов"/>
	</util:map>
	<bean id="routes.service" class="ru.it.lecm.workflow.routes.beans.RoutesServiceImpl"
		  parent="baseBean" depends-on="routes.model.bootstrap"
		  init-method="init"
		  p:folders-ref="routes.folders.map"
	/>

	<bean id="routes.delete.temp.schedule"
	  class="ru.it.lecm.workflow.routes.schedule.DeleteTempRoutesSchedule"
	  depends-on="routes.model.bootstrap"
	  p:transactionMode="ISOLATED_TRANSACTIONS"
	  p:compensatingActionMode="IGNORE"
	  p:jobName="routes-delete-temp"
	  p:jobGroup="routes"
	  p:triggerName="routes-delete-temp-trigger"
	  p:triggerGroup="routes-trigger"
	  p:cronExpression="0 0 4 * * ? *"
	  p:runAsUser="System"
	  p:scheduler-ref="schedulerFactory"
	  p:actionService-ref="ActionService"
	  p:transactionService-ref="TransactionService"
	  p:searchService-ref="searchService"
	  p:namespaceService-ref="namespaceService"
	  p:nodeService-ref="nodeService"
	  p:routesService-ref="routes.service"
	/>

</beans>
