<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>ru.it.lecm</groupId>
		<artifactId>server</artifactId>
		<version>1.1.0</version>
	</parent>

	<groupId>ru.it.lecm.server</groupId>
	<artifactId>server-share</artifactId>
	<name>Alfresco Share client</name>
	<packaging>war</packaging>
	<description>SHARE customization meant to be the main Alfresco UI, which enables collaboration and easy ReST based remotable customization.</description>

	<repositories>
		<repository>
			<id>alfresco-public</id>
			<url>https://artifacts.alfresco.com/nexus/content/groups/public</url>
		</repository>
		<repository>
			<id>alfresco-public-snapshots</id>
			<url>https://artifacts.alfresco.com/nexus/content/groups/public-snapshots</url>
		</repository>
	</repositories>
	<pluginRepositories>
		<pluginRepository>
			<id>alfresco-public</id>
			<url>https://artifacts.alfresco.com/nexus/content/groups/public</url>
		</pluginRepository>
		<pluginRepository>
			<id>alfresco-public-snapshots</id>
			<url>https://artifacts.alfresco.com/nexus/content/groups/public-snapshots</url>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</pluginRepository>
	</pluginRepositories>

	<properties>
		<!--<env>local</env>-->
		<!--<alfresco.edition>community</alfresco.edition>-->
		<webapp.name>share</webapp.name>
		<share.log.level>info</share.log.level>
		<share.servlet.port>8080</share.servlet.port>
		<surf.wiring.mode>development</surf.wiring.mode><!-- "production" is the other allowed value -->
	</properties>

	<!-- Alfresco dependencies -->
	<dependencies>
		<!--
			Alfresco Dependencies. Use this dependency to switch SHARE version
		-->
		<dependency>
			<groupId>org.alfresco</groupId>
			<artifactId>share</artifactId>
			<version>${alfresco.version}</version>
			<type>war</type>
		</dependency>

		<dependency>
			<groupId>org.slf4j</groupId>
			<artifactId>slf4j-log4j12</artifactId>
			<scope>compile</scope>
			<version>${slf4j.version}</version>
		</dependency>

		<dependency>
			<groupId>ru.it.lecm.base</groupId>
			<artifactId>base-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.orgstructure</groupId>
			<artifactId>orgstructure-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<!-- <groupId>ru.it.lecm.forms.jasperforms</groupId> -->
			<groupId>ru.it.lecm.reports</groupId>
			<!-- <artifactId>jasperforms-share</artifactId> -->
			<artifactId>lecm-reports-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.dictionary</groupId>
			<artifactId>dictionary-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.contracts</groupId>
			<artifactId>contracts-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.statemachine</groupId>
			<artifactId>statemachine-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.statemachine.editor</groupId>
			<artifactId>statemachine-editor-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.theme</groupId>
			<artifactId>lecm-theme-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.delegation</groupId>
			<artifactId>lecm-delegation-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.subscriptions</groupId>
			<artifactId>subscriptions-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.notifications</groupId>
			<artifactId>notifications-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.notifications.dashlet</groupId>
			<artifactId>notifications-dashlet-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.notifications.channel.active</groupId>
			<artifactId>notifications-active-channel-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.business-journal</groupId>
			<artifactId>business-journal-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.calendar</groupId>
			<artifactId>lecm-calendar-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.user-profile</groupId>
			<artifactId>lecm-user-profile-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.documents</groupId>
			<artifactId>documents-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.regnumbers</groupId>
			<artifactId>lecm-regnumbers-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.contractors</groupId>
			<artifactId>lecm-contractors-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.reports-editor</groupId>
			<artifactId>reports-editor-share</artifactId>
			<version>${platform.version}</version>
			<scope>runtime</scope>
			<type>amp</type>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.errands</groupId>
			<artifactId>errands-share</artifactId>
			<version>${platform.version}</version>
			<scope>runtime</scope>
			<type>amp</type>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.signed-docflow</groupId>
			<artifactId>signed-docflow-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.permission-exp</groupId>
			<artifactId>permission-exp-share</artifactId>
			<version>${platform.version}</version>
			<scope>runtime</scope>
			<type>amp</type>
		</dependency>
        <dependency>
            <groupId>ru.it.lecm.eds-documents</groupId>
            <artifactId>eds-documents-share</artifactId>
            <version>${platform.version}</version>
            <scope>runtime</scope>
            <type>amp</type>
        </dependency>
		<dependency>
			<groupId>ru.it.lecm.incoming</groupId>
			<artifactId>incoming-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.outgoing</groupId>
			<artifactId>outgoing-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.model-editor</groupId>
			<artifactId>model-editor-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.arm</groupId>
			<artifactId>arm-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.workflow.reservation</groupId>
			<artifactId>reservation-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.workflow</groupId>
			<artifactId>workflow-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.workflow.signing</groupId>
			<artifactId>signing-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.workflow.review</groupId>
			<artifactId>review-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>ru.it.lecm.workflow.approval</groupId>
			<artifactId>approval-share</artifactId>
			<version>${platform.version}</version>
			<type>amp</type>
			<scope>runtime</scope>
		</dependency>
        <dependency>
            <groupId>ru.it.lecm.internal</groupId>
            <artifactId>internal-share</artifactId>
            <version>${platform.version}</version>
            <scope>runtime</scope>
            <type>amp</type>
        </dependency>
        <dependency>
            <groupId>ru.it.lecm.group-actions</groupId>
            <artifactId>group-actions-share</artifactId>
            <version>${platform.version}</version>
            <scope>runtime</scope>
            <type>amp</type>
        </dependency>
        <dependency>
            <groupId>ru.it.lecm.ord</groupId>
            <artifactId>ord-share</artifactId>
            <version>${platform.version}</version>
            <scope>runtime</scope>
            <type>amp</type>
        </dependency>
        <dependency>
            <groupId>ru.it.lecm.nd</groupId>
            <artifactId>nd-share</artifactId>
            <version>${platform.version}</version>
            <scope>runtime</scope>
            <type>amp</type>
        </dependency>
        <!--<dependency>
            <groupId>ru.it.lecm.licensing</groupId>
            <artifactId>licensing-share</artifactId>
            <version>${platform.version}</version>
            <scope>runtime</scope>
            <type>amp</type>
        </dependency-->
	</dependencies>

	<build>
		<finalName>${webapp.name}</finalName>
		<!-- Runtime properties file which is used to configure your Share instance. It's multi-environment aware (-Denv=yourEnv) -->
		<!--<filters>-->
		<!--<filter>${project.basedir}/src/main/properties/${env}/application.properties</filter>-->
		<!--</filters>-->

		<!--
			Default profile to build as an Alfresco extension - resources are
			copied into classpath
		-->
		<resources>
			<resource>
				<directory>src/main/resources</directory>
				<filtering>true</filtering>
			</resource>
			<!--
				| Include application properties file in classpath: this allows
				Spring contexts to have customization properties available at |
				classpath:alfresco/extension/application.properties
			-->
			<!--<resource>-->
			<!--<directory>src/main/properties/${env}</directory>-->
			<!--<includes>-->
			<!--<include>application.properties</include>-->
			<!--</includes>-->
			<!--&lt;!&ndash;-->
			<!--This gets loaded to be the filter for spring runtime placeholding,-->
			<!--so no need for build time filtering-->
			<!--&ndash;&gt;-->
			<!--<targetPath>alfresco/web-extension</targetPath>-->
			<!--<filtering>true</filtering>-->
			<!--</resource>-->
		</resources>
		<plugins>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-dependency-plugin</artifactId>
				<version>2.3</version>
				<executions>
					<execution>
						<id>unpack-amps</id>
						<phase>process-resources</phase>
						<goals>
							<goal>unpack-dependencies</goal>
						</goals>
						<configuration>
							<includeTypes>amp</includeTypes>
							<outputDirectory>${project.build.directory}/${webapp.name}</outputDirectory>
							<excludes>META*</excludes>
						</configuration>
					</execution>
					<execution>
						<id>copy-share</id>
						<phase>package</phase>
						<goals>
							<goal>copy-dependencies</goal>
						</goals>
						<configuration>
							<includeTypes>amp</includeTypes>
							<outputDirectory>${project.build.directory}/../../target/amps/share</outputDirectory>
							<overWriteReleases>true</overWriteReleases>
							<overWriteIfNewer>true</overWriteIfNewer>
							<overWriteSnapshots>true</overWriteSnapshots>
						</configuration>
					</execution>
					<execution>
						<id>copy-share-webapp</id>
						<phase>package</phase>
						<goals>
							<goal>copy</goal>
						</goals>
						<configuration>
							<artifactItems>
								<artifactItem>
									<groupId>${project.groupId}</groupId>
									<artifactId>${project.artifactId}</artifactId>
									<version>${project.version}</version>
									<type>${project.packaging}</type>
									<destFileName>share.war</destFileName>
								</artifactItem>
							</artifactItems>
							<outputDirectory>${project.build.directory}/../../target/war</outputDirectory>
							<overWriteReleases>true</overWriteReleases>
							<overWriteIfNewer>true</overWriteIfNewer>
							<overWriteSnapshots>true</overWriteSnapshots>
						</configuration>
					</execution>
				</executions>
				<dependencies>
					<!--
						This is required to be re-defined explicitly at plugin level as
						otherwise the 'amp' extension unArchiver won't be available to the
						maven-dependency-plugin
					-->
					<dependency>
						<groupId>org.alfresco.maven.plugin</groupId>
						<artifactId>maven-amp-plugin</artifactId>
						<version>3.0.4</version>
					</dependency>
				</dependencies>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-war-plugin</artifactId>
				<version>2.2</version>
				<configuration>
					<archiveClasses>false</archiveClasses>
					<!--<filters>-->
					<!--<filter>${project.basedir}/src/main/properties/${env}/application.properties</filter>-->
					<!--</filters>-->
					<webResources></webResources>
				</configuration>
			</plugin>
			<!-- Needed for cross OS compatibility in acp/zip encoding -->
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-resources-plugin</artifactId>
				<version>2.5</version>
				<configuration>
					<encoding>UTF-8</encoding>
					<!-- By default as per http://code.google.com/p/maven-alfresco-archetypes/issues/detail?id=7 FTL are not filtered to avoid corruption.
					| This behavior can be relaxed (in case filtering is needed in the FTLs) by selecting which files are filtered and which not as described
					| here http://code.google.com/p/maven-alfresco-archetypes/issues/detail?id=7#c3
					-->
					<nonFilteredFileExtensions>
						<nonFilteredFileExtension>ftl</nonFilteredFileExtension>
					</nonFilteredFileExtensions>
				</configuration>
			</plugin>
		</plugins>
	</build>

	<!-- Custom behaviors -->

	<profiles>
		<profile>
			<id>lecmIM</id>
			<dependencies>
				<dependency>
					<groupId>ru.it.lecm.lecm-im</groupId>
					<artifactId>lecm-im-share</artifactId>
					<version>${platform.version}</version>
					<type>amp</type>
					<scope>runtime</scope>
				</dependency>
			</dependencies>
		</profile>
		<profile>
			<id>non-production-modules</id>
			<dependencies>
				<dependency>
					<groupId>ru.it.lecm.br5.semantic</groupId>
					<artifactId>semantic-assist-share</artifactId>
					<version>${platform.version}</version>
					<scope>runtime</scope>
					<type>amp</type>
				</dependency>
				<dependency>
					<groupId>ru.it.lecm.iReferent-integration</groupId>
					<artifactId>iReferent-integration-share</artifactId>
					<version>${platform.version}</version>
					<scope>runtime</scope>
					<type>amp</type>
				</dependency>
				<dependency>
					<groupId>ru.it.lecm.experts</groupId>
					<artifactId>experts-share</artifactId>
					<version>${platform.version}</version>
					<type>amp</type>
					<scope>runtime</scope>
				</dependency>
				<dependency>
					<groupId>ru.it.lecm.contracts-fake</groupId>
					<artifactId>contracts-fake-share</artifactId>
					<version>${platform.version}</version>
					<type>amp</type>
					<scope>runtime</scope>
				</dependency>
				<dependency>
					<groupId>ru.it.lecm.scaner</groupId>
					<artifactId>scaner-share</artifactId>
					<version>${platform.version}</version>
					<type>amp</type>
					<scope>runtime</scope>
				</dependency>
			</dependencies>
		</profile>
	</profiles>

</project>
