<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:util="http://www.springframework.org/schema/util"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<!-- Registration of Delegations models -->
	<bean id="${groupId}.${artifactId}.delegationBootstrap"
		  parent="dictionaryModelBootstrap"
		  depends-on="dictionaryBootstrap, ru.it.lecm.orgstructure.orgstructure-repo.orgStructureBootstrap">
		<property name="models">
			<list>
				<value>alfresco/module/${artifactId}/models/lecm-delegation-model.xml</value>
			</list>
		</property>
		<property name="labels">
			<list>
				<value>alfresco/module/${artifactId}/messages/delegation</value>
			</list>
		</property>
	</bean>

    <bean id="${groupId}.${artifactId}.businessJournalDictionaryBootstrap"
		  parent="lecmDictionaryBootstrap"
		  depends-on="ru.it.lecm.orgstructure.orgstructure-repo.orgBootstrap, ru.it.lecm.business-journal.business-journal-repo.businessJournalBootstrap,
		              ru.it.lecm.business-journal.business-journal-repo.businessJournalDictionaryBootstrap, businessJournalLogEventsPolicy,
		              ru.it.lecm.notifications.notifications-repo.notificationsTemplatesBootstrap">
        <property name="dictionaries">
            <list>
                <value>alfresco/module/${artifactId}/models/lecm-business-journal-eventCategory-items.xml</value>
				<value>alfresco/module/${artifactId}/models/lecm-delegation-nt-items.xml</value>
            </list>
        </property>
    </bean>

	<bean id="delegation.arm.myProfile.LogicEcmBootstrap" parent="lecmDictionaryBootstrap"
	      depends-on="userProfile.arm.LogicEcmBootstrap">
		<property name="rootPath" value="/Business platform/LECM/Сервис АРМ"/>
		<property name="dictionaries">
			<list>
				<value>alfresco/module/${artifactId}/arm/default-arm-my-profile-items.xml</value>
			</list>
		</property>
	</bean>

	<util:constant id="delegationFolder" static-field="ru.it.lecm.delegation.beans.DelegationBean.DELEGATION_FOLDER"/>
	<util:constant id="tasksDelegationFolder" static-field="ru.it.lecm.delegation.beans.DelegationBean.TASKS_DELEGATION_FOLDER"/>
	<bean id="delegationService" class="ru.it.lecm.delegation.beans.DelegationBean"
		  parent="baseBean"
		  depends-on="${groupId}.${artifactId}.delegationBootstrap"
		  init-method="init">
		<property name="folders">
			<map>
				<entry key="#{delegationFolder}" value="сервис Делегирование полномочий"/>
				<entry key="#{tasksDelegationFolder}" value="сервис Делегирование полномочий/Делегирование обязанностей"/>
			</map>
		</property>
		<property name="personService" ref="personService"/>
		<property name="businessJournalService" ref="businessJournalService"/>
		<property name="orgstructureService" ref="serviceOrgstructure"/>
		<property name="sgNotifierService" ref="orgstructureSGNotifierBean"/>
		<property name="dictionaryService" ref="serviceDictionary"/>
		<property name="workflowService" ref="workflowServiceImpl"/>
		<property name="absenceService" ref="AbsenceService"/>
		<property name="notificationsService" ref="notificationsService"/>
		<property name="documentMembersService" ref="documentMembersService"/>
		<property name="lecmPermissionService" ref="lecmPermissionServiceBean"/>
		<property name="dictionaryServiceAlfresco" ref="dictionaryService"/>
		<property name="secretarySecurityService" ref="secretarySecurityService"/>
	</bean>

    <!-- Настройки прав доступа на каталоги в рамках сервиса -->
    <bean id="${groupId}.${artifactId}.DelegationService" parent="ServiceFolderPermissionHelper"
          depends-on="ru.it.lecm.orgstructure.orgstructure-repo.orgBootstrap">
        <property name="serviceBean" ref="delegationService"/>
        <property name="permissionsList">
            <list>
                <value>alfresco/module/${artifactId}/permissions/directories-permissions.xml</value>
            </list>
        </property>
    </bean>

    <bean id="delegationOptsPolicy" class="ru.it.lecm.delegation.policies.DelegationOptsPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent"/>
		<property name="delegationService" ref="delegationService"/>
        <property name="nodeService" ref="nodeService"/>
	</bean>

	<bean id="procuracyPolicy" class="ru.it.lecm.delegation.policies.ProcuracyPolicy" init-method="init">
		<property name="policyComponent" ref="policyComponent"/>
		<property name="nodeService" ref="nodeService"/>
	</bean>

	<bean id="delegationJavascriptExtension" class="ru.it.lecm.delegation.extensions.DelegationJavascriptExtension" parent="baseScript">
		<property name="extensionName" value="delegation"/>
		<property name="delegationService" ref="delegationService"/>
	</bean>

	<bean id="delegationAssociationPolicy" class="ru.it.lecm.delegation.policies.DelegationAssociationPolicy" init-method="init" parent="logicEcmAssociationPolicy"/>

    <bean id="updateProcuracyPolicy" class="ru.it.lecm.delegation.policies.UpdateProcuracyPolicy" init-method="init">
        <property name="policyComponent" ref="policyComponent"/>
        <property name="propertiesService" ref="propertiesService"/>
    </bean>

    <bean id="delegation.arm.LogicEcmBootstrap" parent="lecmDictionaryBootstrap"
          depends-on="arm.settings.LogicEcmBootstrap">
        <property name="rootPath" value="/Business platform/LECM/Сервис АРМ"/>
        <property name="dictionaries">
            <list>
                <value>alfresco/module/${artifactId}/arm/delegation-arm.xml</value>
            </list>
        </property>
    </bean>
</beans>
