<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:util="http://www.springframework.org/schema/util"
	   xmlns:p="http://www.springframework.org/schema/p"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<util:list id="routes.models">
		<value>alfresco/module/${artifactId}/models/lecm-routes-macros-model.xml</value>
		<value>alfresco/module/${artifactId}/models/lecm-routes-model.xml</value>
	</util:list>
	<util:list id="routes.labels">
		<value>alfresco/module/${artifactId}/messages/lecm-routes</value>
		<value>alfresco/module/${artifactId}/messages/lecm-routes-macros</value>
	</util:list>
	<bean id="routes.model.bootstrap" parent="dictionaryModelBootstrap"
		  depends-on="dictionaryBootstrap,
					  ru.it.lecm.orgstructure.orgstructure-repo.orgStructureBootstrap,
					  ru.it.lecm.contractors.lecm-contractors-repo.contractors-model-bootstrap,
					  lecm.approval3.helper.model.bootstrap"
		  p:models-ref="routes.models"
		  p:labels-ref="routes.labels"/>

	<util:constant id="routesServiceFolderID" static-field="ru.it.lecm.workflow.routes.beans.RoutesServiceImpl.ROUTES_FOLDER_ID"/>
	<util:map id="routes.folders.map">
		<entry key="#{routesServiceFolderID}" value="Сервис маршрутов"/>
	</util:map>
	<bean id="routesService" class="ru.it.lecm.workflow.routes.beans.RoutesServiceImpl"
		  parent="baseBean" depends-on="routes.model.bootstrap"
		  init-method="init"
		  p:folders-ref="routes.folders.map"
		  p:approvalService-ref="approvalWorkflowService"
		  p:orgstructureService-ref="serviceOrgstructure"
		  p:searchService-ref="searchService"
		  p:copyService-ref="copyService"
		  p:documentService-ref="documentService"
		  p:scriptService-ref="scriptService"
	/>

	<bean id="routes.delete.temp.schedule"
	  class="ru.it.lecm.workflow.routes.schedule.DeleteTempRoutesSchedule" parent="baseTransactionalSchedule"
	  depends-on="routes.model.bootstrap"
	  p:jobName="routes-delete-temp"
	  p:jobGroup="routes"
	  p:triggerName="routes-delete-temp-trigger"
	  p:triggerGroup="routes-trigger"
	  p:actionName="deleteAction"
	  p:cronExpression="0 0 4 * * ? *"
	/>

	<bean id="routesOnCreateAssocPolicy" class="ru.it.lecm.workflow.routes.policy.RoutesOnCreateAssocPolicy"
		  init-method="init" parent="logicEcmAssociationPolicy"/>
</beans>
