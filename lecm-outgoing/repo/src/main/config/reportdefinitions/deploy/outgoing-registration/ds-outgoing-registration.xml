<?xml version="1.0" encoding="UTF-8"?>
<ds.config>
    <report.descriptor mnem="outgoing-registration">
        <l18>
            <item key="RU_RU"><![CDATA[Журнал регистрации исходящих документов]]></item>
        </l18>
        <type mnem="JASPER">
            <l18>
                <item key="RU_RU"><![CDATA[Jasper]]></item>
            </l18>
        </type>
        <provider javaClass="ru.it.lecm.reports.generators.GenericDSProviderBase" mnem="PROV_GENERIC_PROVIDER">
            <l18>
                <item key="RU_RU"><![CDATA[genericProvider]]></item>
            </l18>
        </provider>
        <templates>
            <template type="JASPER" filename="outgoing-registration.jrxml" mnem="outgoing-registration">
                <l18>
                    <item key="RU_RU"><![CDATA[outgoing-registration-template]]></item>
                </l18>
            </template>
        </templates>
        <datasource.descriptor>
            <l18>
                <item key="RU_RU"><![CDATA[f85f681e-a468-4b07-9e17-02b6eb89089a]]></item>
            </l18>
        </datasource.descriptor>
    </report.descriptor>
    <query.descriptor>
        <queryText><![CDATA[TYPE:"lecm-outgoing:document" AND  @lecm\-document\-aspects\:reg\-data\-is\-registered:true]]></queryText>
		<querySort><![CDATA[doc-created-date|ASC]]></querySort>
        <allVersions>true</allVersions>
        <preferedType>lecm-outgoing:document</preferedType>
        <isMultiRow>true</isMultiRow>
        <isCustom>false</isCustom>
    </query.descriptor>
    <fields>
        <field jrFldName="dateReg" order="0" queryFldName="{lecm-document:doc-date}" displayName="Дата регистрации"
               javaValueClass="java.util.Date" alfrescoType="d:date">
            <parameter mnem="PARAM_TYPE_RANGE" paramType="PARAM_TYPE_RANGE">
                <l18>
                    <item key="RU_RU" value="Диапазон"/>
                </l18>
                <label1>
                    <item key="RU_RU" value="С"/>
                </label1>
                <label2>
                    <item key="RU_RU" value="По"/>
                </label2>
            </parameter>
        </field>
        <field alfrescoType="d:text" displayName="Заголовок"
            jrFldName="doc-title" queryFldName="{lecm-document:title}">
            <l18>
                <item key="RU_RU"><![CDATA[Заголовок]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Адресат"
            jrFldName="recipient" queryFldName="{lecm-outgoing:recipient-assoc/lecm-representative:surname} {lecm-outgoing:recipient-assoc/lecm-representative:firstname} {lecm-outgoing:recipient-assoc/lecm-representative:middlename}">
            <l18>
                <item key="RU_RU"><![CDATA[Адресат]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Подписанты"
            javaValueClass="java.util.List"
            jrFldName="outgoing-signatory" queryFldName="{{subreport::outgoing-signatory}}">
            <l18>
                <item key="RU_RU"><![CDATA[Подписанты]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Статус"
            jrFldName="doc-status" queryFldName="{lecm-statemachine:status}">
            <l18>
                <item key="RU_RU"><![CDATA[Статус]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Автор"
            jrFldName="doc-creator" queryFldName="{lecm-document:creator}">
            <l18>
                <item key="RU_RU"><![CDATA[Автор]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Вид документа"
            jrFldName="doc-type" queryFldName="{lecm-document:doc-type}">
            <l18>
                <item key="RU_RU"><![CDATA[Вид документа]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Дата документа"
            jrFldName="doc-created-date" queryFldName="{cm:created?dd.MM.yyyy}">
            <l18>
                <item key="RU_RU"><![CDATA[Дата документа]]></item>
            </l18>
        </field>
        <field alfrescoType="d:text" displayName="Рег. номер"
            jrFldName="doc-regnumber" queryFldName="{lecm-document-aspects:reg-data-number}">
            <l18>
                <item key="RU_RU"><![CDATA[Рег. номер]]></item>
            </l18>
        </field>
    </fields>
    <subreports>
        <subreport destColumnName="outgoing-signatory" name="outgoing-signatory">
            <sublist.source><![CDATA[{cm:contains(cm:name=Подписание)/cm:contains/cm:contains/}]]></sublist.source>
            <sublist.item>
                <map>
                    <item key="signatory"><![CDATA[{lecm-workflow-result:workflow-result-item-employee-assoc/lecm-orgstr:employee-short-name}]]></item>
                </map>
            </sublist.item>
        </subreport>
    </subreports>
</ds.config>
