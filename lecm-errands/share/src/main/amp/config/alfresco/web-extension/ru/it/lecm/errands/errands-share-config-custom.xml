<alfresco-config>
    <config>
        <forms>
            <dependencies>
                <js src="/scripts/lecm-errands/constraints/errands-request-cancel-new-executor-validator.js"/>
                <js src="/scripts/lecm-errands/constraints/errands-request-change-due-date-validator.js"/>
                <!--<js src="/scripts/lecm-errands/constraints/errands-limitation-date-validator.js"/>-->
                <js src="/scripts/lecm-errands/constraints/errands-check-coosing-executor.js"/>
                <js src="/scripts/lecm-errands/constraints/errands-constraints.js"/>
            </dependencies>

           <default-controls>
                <type name="association:lecm-errands-dic:errand-titles" template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                    <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                    <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="notSelectedOptionShow">true</control-param>
                    <control-param name="notSelectedOptionLabel"> </control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                </type>
               <type name="association:lecm-errands-dic:errand-type" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
                   <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Типы_x0020_поручений</control-param>
                   <control-param name="plane">true</control-param>
               </type>
            </default-controls>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-errands:document">
        <forms>
            <form>
                <view-form template="/ru/it/lecm/base-share/components/base-form-tabs.ftl"/>
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Статус -->
                    <show id="lecm-statemachine:status" force="true"/>
                    <!-- Документ-основание -->
                    <show id="lecm-errands:base-assoc"/>
                    <!-- Основание -->
                    <show id="lecm-errands:additional-document-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Создатель -->
                    <show id="lecm-document:author-assoc"/>
                    <!--  Тип поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Текст поручения -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-text"/>
                    <!-- Закрывает вышестоящее поручение -->
                    <show id="lecm-errands:auto-close"/>
                    <!-- Направлять периодически  -->
                    <show id="lecm-errands:periodically"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <!-- Отчет об исполнении -->
                    <!-- Статус отчета -->
                    <show id="lecm-errands:execution-report-status"/>
                    <!-- Причина отмены -->
                    <show id="lecm-errands:execution-report-decline-reason"/>
                    <!-- Текст отчета -->
                    <show id="lecm-errands:execution-report"/>
                    <!-- Связи -->
                    <show id="lecm-errands:execution-connected-document-assoc"/>
                    <!-- Вложения -->
                    <show id="lecm-errands:execution-report-attachment-assoc"/>
                    <!-- Предидущие отчеты -->
                    <show id="lecm-errands-ts:execution-reports-assoc"/>
                    <!-- Разделительная линия -->
                    <show id="lecm-base-dummy-aspects:script4" force="true"/>
                    <show id="lecm-base-dummy-aspects:script5" force="true"/>
                    <!-- Отчеты соисполнителей -->
                    <show id="lecm-errands-ts:coexecutor-reports-assoc"/>
                    <show id="lecm-base-dummy-aspects:script6" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="common" label-id="label.errands.forms.tab.common"/>
                    <set id="reports" label-id="label.errands.forms.tab.reports"/>
                    <set id="execution" label-id="label.errands.forms.tab.execution"/>
                    <set id="statuses" parent="common"/>
                    <set id="commonField" parent="common"/>
                    <set id="execution-report" parent="reports" appearance="title" template="/ru/it/lecm/errands/controls/errands-execution-report-set.ftl" label-id="title.errands.execution-reports"/>
                    <set id="lineReports" parent="reports"/>
                    <set id="coexecutors-reports" parent="reports" appearance="title" label-id="title.errands.coexecutors-reports"/>

                    <field id="lecm-errands:is-important" set="statuses">
                        <control template="/ru/it/lecm/base-share/components/controls/important.ftl" />
                    </field>
                    <field id="lecm-statemachine:status" set="statuses">
                        <control template="/ru/it/lecm/base-share/components/controls/status.ftl" />
                    </field>
                    <field id="lecm-errands:base-assoc" set="commonField">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:additional-document-assoc" set="commonField">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="commonField">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Errands.checkChoosingInitiatorValidation" event="change"/>
                        </constraint-handlers>
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:author-assoc" set="commonField" label-id="label.document.creator"/>
                    <field id="lecm-errands:type-assoc" set="commonField"/>
                    <field id="lecm-errands:title" set="commonField">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" set="commonField">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" set="commonField">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" set="commonField">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-text" set="commonField"/>
                    <field id="lecm-errands:auto-close" set="commonField">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:periodically" set="commonField" read-only="true">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:controller-assoc" set="commonField">
                        <control>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required" set="commonField">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-recipient-type" set="commonField">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-document:subject-assoc" set="commonField"/>
                    <field id="lecm-base-dummy-aspects:script2" set="commonField">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-view-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsTabsFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-report-status" set="execution-report"/>
                    <field id="lecm-errands:execution-report-decline-reason" set="execution-report"/>
                    <field id="lecm-errands:execution-report" set="execution-report">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-connected-document-assoc" set="execution-report">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-report-attachment-assoc" set="execution-report">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="viewUrl">document-attachment?nodeRef={nodeRef}</control-param> '
                        </control>
                    </field>
                    <field id="lecm-errands-ts:execution-reports-assoc" set="execution-report">
                        <control template="/ru/it/lecm/errands/controls/execution-reports-table-control.ftl">
                            <control-param name="isTableSortable">true</control-param>
                            <control-param name="sort">lecm-errands-ts:execution-report-create-date|false</control-param>
                            <control-param name="expandDataSource">components/form?formId=table-structure-expand</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="reports">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reports-tab-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsReportsTabViewFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script5" set="lineReports">
                        <control template="/ru/it/lecm/base-share/components/controls/line.ftl"/>
                    </field>
                    <field id="lecm-errands-ts:coexecutor-reports-assoc" set="coexecutors-reports">
                        <control template="/ru/it/lecm/errands/controls/coexecutors-reports-table-control.ftl">
                            <control-param name="datagridFormId">coexecutors-reports-datagrid</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script6" set="execution">
                        <control template="/ru/it/lecm/eds/controls/execution-tree-control.ftl"/>
                    </field>
                </appearance>
            </form>

            <form id="edit">
                <edit-form template="/ru/it/lecm/base-share/components/base-form-tabs.ftl" />
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Статус -->
                    <show id="lecm-statemachine:status" force="true"/>
                    <!-- Документ-основание -->
                    <show id="lecm-errands:base-assoc"/>
                    <!-- Основание -->
                    <show id="lecm-errands:additional-document-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Создатель -->
                    <show id="lecm-document:author-assoc"/>
                    <!--  Тип поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Текст поручения -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date" />
                    <!-- Закрывает вышестоящее поручение -->
                    <show id="lecm-errands:auto-close"/>
                    <!-- Направлять периодически  -->
                    <show id="lecm-errands:periodically"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Отчет об исполнении -->
                    <!-- Статус отчета -->
                    <show id="lecm-errands:execution-report-status"/>
                    <!-- Причина отклонения -->
                    <show id="lecm-errands:execution-report-decline-reason"/>
                    <!-- Текст отчета -->
                    <show id="lecm-errands:execution-report"/>
                    <!-- Связи -->
                    <show id="lecm-errands:execution-connected-document-assoc"/>
                    <!-- Вложения -->
                    <show id="lecm-errands:execution-report-attachment-assoc"/>
                    <!-- Предидущие отчеты -->
                    <show id="lecm-errands-ts:execution-reports-assoc"/>
                    <!-- Разделительная линия -->
                    <show id="lecm-base-dummy-aspects:script8" force="true"/>
                    <!-- Отчеты соисполнителей -->
                    <show id="lecm-errands-ts:coexecutor-reports-assoc"/>

                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-base-dummy-aspects:script3" force="true"/>
                    <show id="lecm-base-dummy-aspects:script4" force="true"/>
                    <show id="lecm-base-dummy-aspects:script5" force="true"/>
                    <show id="lecm-base-dummy-aspects:script6" force="true"/>
                    <show id="lecm-base-dummy-aspects:script7" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="common" label-id="label.errands.forms.tab.common"/>
                    <set id="reports" label-id="label.errands.forms.tab.reports"/>
                    <set id="execution" label-id="label.errands.forms.tab.execution"/>
                    <set id="statuses" parent="common"/>
                    <set id="beforeDateSet" parent="common"/>
                    <set id="limitation-date" parent="common" label-id="label.limitation-date" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>/>
                    <set id="afterDateSet" parent="common"/>
                    <set id="execution-reports" parent="reports" appearance="title" template="/ru/it/lecm/errands/controls/errands-execution-report-set.ftl" label-id="title.errands.execution-reports"/>
                    <set id="lineReports" parent="reports"/>
                    <set id="coexecutors-reports" parent="reports" appearance="title" label-id="title.errands.coexecutors-reports"/>

                    <field id="lecm-errands:is-important" set="statuses">
                        <control template="/ru/it/lecm/base-share/components/controls/important.ftl" />
                    </field>
                    <field id="lecm-statemachine:status" set="statuses">
                        <control template="/ru/it/lecm/base-share/components/controls/status.ftl" />
                    </field>
                    <field id="lecm-errands:base-assoc" set="beforeDateSet"/>
                    <field id="lecm-errands:additional-document-assoc" set="beforeDateSet"/>
                    <field id="lecm-errands:initiator-assoc" set="beforeDateSet">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Errands.checkChoosingInitiatorValidation" event="change"/>
                        </constraint-handlers>
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:author-assoc" set="beforeDateSet" label-id="label.document.creator"/>
                    <field id="lecm-errands:type-assoc" set="beforeDateSet"/>
                    <field id="lecm-errands:title" set="beforeDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" set="beforeDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" set="beforeDateSet">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" set="beforeDateSet">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:auto-close" set="afterDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:periodically" set="afterDateSet" read-only="true">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:controller-assoc" set="afterDateSet">
                        <control>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required" set="afterDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-recipient-type" set="afterDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-document:subject-assoc" set="afterDateSet"/>
                    <field id="lecm-errands:execution-report-status" set="execution-reports"/>
                    <field id="lecm-errands:execution-report-decline-reason" set="execution-reports"/>
                    <field id="lecm-errands:execution-report" set="execution-reports">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-connected-document-assoc" set="execution-reports">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-report-attachment-assoc" set="execution-reports">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="viewUrl">document-attachment?nodeRef={nodeRef}</control-param> '
                        </control>
                    </field>
                    <field id="lecm-errands-ts:execution-reports-assoc" set="execution-reports">
                        <control template="/ru/it/lecm/errands/controls/execution-reports-table-control.ftl">
                            <control-param name="isTableSortable">true</control-param>
                            <control-param name="sort">lecm-errands-ts:execution-report-create-date|false</control-param>
                            <control-param name="expandDataSource">components/form?formId=table-structure-expand</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script8" set="lineReports">
                        <control template="/ru/it/lecm/base-share/components/controls/line.ftl"/>
                    </field>
                    <field id="lecm-errands-ts:coexecutor-reports-assoc" set="coexecutors-reports">
                        <control template="/ru/it/lecm/errands/controls/coexecutors-reports-table-control.ftl">
                            <control-param name="datagridFormId">coexecutors-reports-datagrid</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="afterDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script3" set="afterDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="afterDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script5" set="afterDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-view-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsTabsFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script6" set="reports">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reports-tab-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsReportsTabEditFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script7" set="execution">
                        <control template="/ru/it/lecm/eds/controls/execution-tree-control.ftl"/>
                    </field>
                </appearance>
            </form>

            <!-- Форма просмотра на главной странице-->
            <form id="main-page-dashlets">
                <field-visibility>
                    <show id="viewMetadata"/>
                </field-visibility>
                <appearance>
                    <field id="viewMetadata">
                        <control template="/ru/it/lecm/documents/controls/document-view-metadata-control.ftl"/>
                    </field>
                </appearance>
            </form>

            <form id="document-dashlet">
                <field-visibility>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                </field-visibility>
            </form>
            <form id="document">
                <field-visibility>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:initiator-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="nameSubstituteString">{lecm-orgstr:employee-short-name}</control-param>
                            <control-param name="itemType">lecm-orgstr:employee</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
	                        <control-param name="useStrictFilterByOrg">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="transfer-right">
                <field-visibility>
                    <show id="lecm-document:employee-ref"/>
                    <show id="lecm-document:istransmit" />
                    <show id="lecm-document:deprive-right" />
                </field-visibility>
                <appearance>
                    <field id="lecm-document:employee-ref" label-id="contract.creator-ref" mandatory="true">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="itemType">lecm-orgstr:employee</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
	                        <control-param name="useStrictFilterByOrg">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:istransmit" label-id="contract.istransmit" />
                    <field id="lecm-document:deprive-right" label-id="contract.deprive.right" />
                </appearance>
            </form>
            <form id="errands-dnd">
                <field-visibility>
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-document-aspects:attachments-temp-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                            <control-param name="showAttsLabel">false</control-param>
                            <control-param name="showAttsList">false</control-param>
                            <control-param name="autoSubmit">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="resolution-execution-datagrid-expand">
                <field-visibility>
                    <show id="lecm-base-dummy-aspects:script2"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-base-dummy-aspects:script2">
                        <control template="/ru/it/lecm/eds/controls/execution-tree-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-errands:document">
        <forms>
            <form>
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="limitation-date-script" force="true"/>
                    <show id="lecm-errands:limitation-date-radio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date" />
                    <!-- Периодичность -->
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:periodically-radio"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:period-end"/>
                    <show id="lecm-errands:period-during"/>
                    <show id="lecm-errands:period-during-type"/>
                    <show id="lecm-errands:reiteration-count"/>
                    <show id="reiteration-count-label" force="true"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>

                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!--  Вложения -->
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                    <!-- Для проверки на черновик -->
                    <show id="lecm-errands:is-short"/>
                    <!-- Ссылки  -->
                    <show id="lecm-errands:links-assoc"/>

                    <show id="lecm-document-aspects:template-name" force="true"/>
                    <show id="lecm-document-aspects:template-ref" force="true"/>

                    <show id="change-errand-type-script" force="true"/>
                    <show id="report-required-handler-script" force="true"/>
                    <show id="errands-create-form-script" force="true"/>

                    <!-- Buttons -->
                    <show id="save-draft-button" force="true"/>
                    <show id="expand-button" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="exist-business-role" template="/ru/it/lecm/errands/controls/errands-choosing-set.ftl" />
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="block2-1" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="block3"  template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="errand-validity" parent="block3" template="/ru/it/lecm/errands/controls/errands-validity-set.ftl"/>
                    <set id="validity-dates" parent="errand-validity" template="/ru/it/lecm/base-share/components/controls/daterange.ftl"/>
                    <set id="during" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="repeat" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="block2-2" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="static"/>

                    <field id="lecm-errands:type-assoc" mandatory="true" >
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                            <control-param name="additionalFilter">@lecm\-errands\-dic\:errand\-type\-manual\-selection:true</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" >
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" >
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" >
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" >
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="exist-business-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:periodically" set="block2-1" read-only="true">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">periodicallyErrandChange</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:reiteration-rule" set="block3">
                        <control template="/ru/it/lecm/errands/controls/errands-reiteration-control.ftl">
                            <control-param name="defaultType">DAILY</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:periodically-radio" set="errand-validity" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATERANGE</control-param>
                        </control>
                        <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodicallyValidation" event="change" />
                    </field>

                    <field id="lecm-errands:period-start" label="" set="validity-dates"/>
                    <field id="lecm-errands:period-end" label="" set="validity-dates"/>
                    <field id="lecm-errands:period-during" label-id="label.errand.during" set="during"/>
                    <field id="lecm-errands:period-during-type" set="during">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:reiteration-count" label-id="label.errand.endAfter" set="repeat"/>
                    <field id="reiteration-count-label" set="repeat">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.reiterationCount</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="errand-validity">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.period-endless</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:controller-assoc" set="block2-2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-required" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-recipient-type" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:is-important" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>

                    <field id="lecm-document:subject-assoc" set="block2-2">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                        </control>
                    </field>

                    <field id="lecm-document-aspects:attachments-temp-assoc" set="static">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:is-short" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-errands:links-assoc" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-name" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-ref" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>

                    <field id="save-draft-button" label-id="label.save-draft">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">saveDraftButtonClick</control-param>
                        </control>
                    </field>
                    <field id="expand-button" label-id="label.show-details">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">expandButtonClick</control-param>
                        </control>
                    </field>

                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                    <field id="report-required-handler-script" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="errands-create-form-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/components/lecm-errands-create-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsCreateFormScriptLoaded</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="document-template-fields">
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>

                </field-visibility>
                <appearance>
                    <field id="lecm-errands:type-assoc" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                            <control-param name="additionalFilter">@lecm\-errands\-dic\:errand\-type\-manual\-selection:true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title">
                        <control
                                template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">
                                /app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений
                            </control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"></control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:initiator-assoc">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator
                            </control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date">
                        <constraint-handlers>
                            <constraint type="MANDATORY"
                                        validation-handler="LogicECM.module.Errands.limitationDateValidation"
                                        event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:controller-assoc">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required"/>
                    <field id="lecm-errands:is-important">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-document:subject-assoc">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-errands:is-important"/>
                    <show id="lecm-errands:baseDocString"/>
                    <show id="lecm-errands:number"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:is-expired"/>
                    <show id="lecm-errands:initiator-assoc"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-statemachine:status" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:is-important" label=""/>
                    <field id="lecm-errands:baseDocString" label="" substituteString="{lecm-errands:additional-document-assoc/lecm-document:present-string}"/>
                    <field id="lecm-errands:initiator-assoc"/>
                    <field id="lecm-errands:executor-assoc"/>
                    <field id="lecm-errands:execution-date"/>
                    <field id="lecm-errands:title"/>
                    <field id="lecm-statemachine:status" force="true"/>
                    <field id="lecm-errands:number" label-id="errands.number"/>
                </appearance>
            </form>
            <form id="search">
                <field-visibility>
                    <show id="lecm-errands:number"/>
                    <show id="lecm-errands:base-doc-number"/>
                    <!--Дата выдачи-->
                    <show id="lecm-errands:wait-for-execution-date"/>
                    <show id="lecm-errands:initiator-assoc"/>
                    <show id="lecm-document:author-assoc"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:controller-assoc"/>
                    <show id="lecm-errands:type-assoc"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:limitation-date"/>
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-errands:is-important"/>
                    <show id="lecm-errands:is-expired"/>
                    <show id="lecm-errands:report-required"/>
                    <show id="lecm-document:subject-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:number">
                        <control>
                            <control-param name="hideValue"/>
                        </control>
                    </field>
                    <field id="lecm-errands:wait-for-execution-date">
                        <control template="/ru/it/lecm/base-share/components/controls/daterange-control.ftl"/>
                    </field>
                    <field id="lecm-errands:initiator-assoc" mandatory="false">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-document:author-assoc" label-id="label.document.creator" mandatory="false">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:executor-assoc" mandatory="false">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:controller-assoc">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:type-assoc">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/daterange-control.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" label-id="label.errand.limitless">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">LIMITLESS|Без срока,*|Все</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-important">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-expired">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:subject-assoc">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="workflow-form">
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="limitation-date-script" force="true"/>
                    <show id="lecm-errands:limitation-date-radio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date" />
                    <!-- Периодичность -->
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:periodically-radio"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:period-end"/>
                    <show id="lecm-errands:period-during"/>
                    <show id="lecm-errands:period-during-type"/>
                    <show id="lecm-errands:reiteration-count"/>
                    <show id="reiteration-count-label" force="true"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <!-- Закрывать вышестоящее поручение -->
                    <show id="lecm-errands:auto-close"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!--  Вложения -->
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                    <!-- Для проверки на черновик -->
                    <show id="lecm-errands:is-short"/>
                    <!-- Ссылки  -->
                    <show id="lecm-errands:links-assoc"/>

                    <show id="lecm-document-aspects:template-name" force="true"/>
                    <show id="lecm-document-aspects:template-ref" force="true"/>

                    <show id="change-errand-type-script" force="true"/>
                    <show id="report-required-handler-script" force="true"/>
                    <show id="errands-workflow-form-script" force="true"/>

                    <!-- Buttons -->
                    <show id="save-draft-button" force="true"/>
                    <show id="expand-button" force="true"/>

                    <!-- Ссылка на документ основание  -->
                    <show id="lecm-errands:additional-document-assoc"/>
                </field-visibility>
                <appearance>
                    <set id="exist-business-role" template="/ru/it/lecm/errands/controls/errands-choosing-set.ftl" />
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="block2-1" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="block3"  template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="errand-validity" parent="block3" template="/ru/it/lecm/errands/controls/errands-validity-set.ftl"/>
                    <set id="validity-dates" parent="errand-validity" template="/ru/it/lecm/base-share/components/controls/daterange.ftl"/>
                    <set id="during" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="repeat" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="block2-2" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="static"/>

                    <field id="lecm-errands:type-assoc" mandatory="true" >
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                            <control-param name="additionalFilter">@lecm\-errands\-dic\:errand\-type\-manual\-selection:true</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" >
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" >
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" >
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" >
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="exist-business-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date">
                        <control>
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:periodically" set="block2-1" read-only="true">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">periodicallyErrandChange</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:reiteration-rule" set="block3">
                        <control template="/ru/it/lecm/errands/controls/errands-reiteration-control.ftl">
                            <control-param name="defaultType">DAILY</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:periodically-radio" set="errand-validity" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATERANGE</control-param>
                        </control>
                        <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodicallyValidation" event="change" />
                    </field>

                    <field id="lecm-errands:period-start" label="" set="validity-dates"/>
                    <field id="lecm-errands:period-end" label="" set="validity-dates"/>
                    <field id="lecm-errands:period-during" label-id="label.errand.during" set="during"/>
                    <field id="lecm-errands:period-during-type" set="during">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:reiteration-count" label-id="label.errand.endAfter" set="repeat"/>
                    <field id="reiteration-count-label" set="repeat">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.reiterationCount</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="errand-validity">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.period-endless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:auto-close" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:controller-assoc" set="block2-2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-required" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-recipient-type" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:is-important" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>

                    <field id="lecm-document:subject-assoc" set="block2-2">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                            <control-param name="selectedItemsFormArgs">parentDocSubjectAssoc</control-param>
                        </control>
                    </field>

                    <field id="lecm-document-aspects:attachments-temp-assoc" set="static">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:additional-document-assoc">
                        <control template="/ru/it/lecm/errands/controls/additional-document-assoc.ftl">
                            <control-param name="parentDocArg">parentDoc</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-short" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-errands:links-assoc" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-name" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-ref" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>

                    <field id="save-draft-button" label-id="label.save-draft">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">saveDraftButtonClick</control-param>
                        </control>
                    </field>
                    <field id="expand-button" label-id="label.show-details">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">expandButtonClick</control-param>
                        </control>
                    </field>

                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                    <field id="report-required-handler-script" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="errands-workflow-form-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/components/lecm-errands-create-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsCreateFormScriptLoaded</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="primary-routing">
                <create-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>
                <edit-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>

                <field-visibility>
                    <!-- Получатель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!--  Типы поручений -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days"/>
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date"/>
                </field-visibility>
                <appearance>
                    <set id="left"/>
                    <set id="right"/>
                    <set id="limitation-date" parent="right" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>

                    <field id="lecm-errands:executor-assoc" set="left" label-id="label.primaryRouting.recipient">
                        <control>
                            <control-param name="changeItemsFireAction">primaryRoutingRecipientChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:type-assoc" set="left" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                            <control-param name="additionalFilter">@lecm\-errands\-dic\:errand\-type\-manual\-selection:true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="left">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="maxLimitArg">parentDocLimitationDate</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>
            <form id="incoming-default-primary-routing">
                <create-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>
                <edit-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>

                <field-visibility>
                    <!-- Получатель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!--  Типы поручений -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days"/>
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date"/>
                </field-visibility>
                <appearance>
                    <set id="left"/>
                    <set id="right"/>
                    <set id="limitation-date" parent="right" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>

                    <field id="lecm-errands:executor-assoc" set="left" label-id="label.primaryRouting.recipient">
                        <control>
                            <control-param name="changeItemsFireAction">primaryRoutingRecipientChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:type-assoc" set="left" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                            <control-param name="additionalFilter">@lecm\-errands\-dic\:errand\-type\-manual\-selection:true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="left">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="maxLimitArg">parentDocLimitationDate</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>
            <form id="from-resolution">
                <field-visibility>
                    <!--  Типы поручений -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days"/>
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                </field-visibility>
                <appearance>
                    <set id="parent" template="/ru/it/lecm/eds/controls/2-column-parent-set.ftl"/>
                    <set id="left" parent="parent"/>
                    <set id="right" parent="parent"/>
                    <set id="limitation-date" parent="right" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="right-end" parent="right"/>

                    <field id="lecm-errands:type-assoc" set="left" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">resolutionErrandTypeChanged</control-param>
                            <control-param name="additionalFilter">@lecm\-errands\-dic\:errand\-type\-manual\-selection:true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="left">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" set="left"/>
                    <field id="lecm-errands:coexecutors-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:controller-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Resolutions.ErrandsExecutionDateValidation" message-id="message.errandExecutionDate.laterResolution" event="keyup"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="maxLimitArg">parentDocLimitationDate</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Resolutions.ErrandsExecutionDateValidation" message-id="message.errandExecutionDate.laterResolution" event="keyup"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:report-required" set="right-end">
                        <control>
                            <control-param name="hideFieldsIfNotSelect">lecm-errands:report-recipient-type</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-recipient-type" set="right-end">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                </appearance>
            </form>
            <form id="resolution-execution-datagrid">
                <field-visibility>
                    <show id="lecm-errands:child-index-counter"/>
                    <show id="lecm-errands:type-assoc"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:limitation-date-text"/>
                    <show id="lecm-errands:report-required"/>
                    <show id="lecm-statemachine:status" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:limitation-date-text" label-id="label.execution.date"/>
                </appearance>
            </form>
            <form id="statemachine-editable-fields">
                <field-visibility>
                    <!--  Тип поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Текст поручения -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-errands:limitation-date"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <!-- Закрывает вышестоящее поручение -->
                    <show id="lecm-errands:auto-close"/>
                    <!-- Направлять периодически  -->
                    <show id="lecm-errands:periodically"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                </field-visibility>
            </form>
            <form id="searchQueryGrid">
                <field-visibility>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-statemachine:status" force="true"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:controller-assoc"/>
                    <show id="lecm-errands:initiator-assoc"/>
                </field-visibility>
            </form>
            <form id="search-editor-fields">
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Статус -->
                    <show id="lecm-statemachine:status" force="true"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:number"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Срок завершения поручения -->
                    <show id="lecm-errands:end-date"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Дата начала -->
                    <show id="lecm-errands:start-date"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Дата исполнения -->
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-document:author-assoc"/>
                    <show id="lecm-errands:execution-report"/>

                    <show id="cm:created"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-errands-ts:coexecutor-report">
        <forms>
            <form id="coexecutors-reports-datagrid">
                <field-visibility>
                    <show id="lecm-errands-ts:coexecutor-assoc"/>
                    <show id="lecm-errands-ts:coexecutor-report-status"/>
                    <show id="lecm-errands-ts:coexecutor-report-route-date"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-errands-ts:execution-report">
        <forms>
            <form id="executionReportForm">
                <field-visibility>
                    <show id="lecm-errands-ts:execution-close-child"/>
                    <show id="lecm-errands-ts:execution-report-text"/>
                    <show id="lecm-errands-ts:execution-report-attachment-assoc"/>
                    <show id="lecm-errands-ts:execution-report-connected-document-assoc"/>
                    <show id="executeErrandButon" force="true"/>
                    <show id="lecm-errands-ts:execution-report-is-execute"/>
                    <show id="editExecutionReportScript" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands-ts:execution-close-child">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands-ts:execution-report-text">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl"/>
                    </field>
                    <field id="lecm-errands-ts:execution-report-attachment-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Исполнение</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands-ts:execution-report-connected-document-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control-with-dialog.ftl">
                            <control-param name="multipleSelectMode">true</control-param>
                            <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:Documents</control-param>
                            <control-param name="nameSubstituteString">{lecm-document:ext-present-string}&lt;/br&gt;{lecm-document:list-present-string}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="itemType">lecm-document:base</control-param>
                            <control-param name="selectedItemsFormArgs">executionConnectedDocs</control-param>
                        </control>
                    </field>
                    <field id="executeErrandButon" label-id="button.errand.execute">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">executeErrandButtonClick</control-param>
                        </control>
                    </field>
                    <field id="editExecutionReportScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-execute-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">editExecutionReportScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands-ts:execution-report-is-execute">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                </appearance>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-errands-ts:execution-report-create-date"/>
                    <show id="lecm-errands-ts:execution-report-decline-date"/>
                    <show id="lecm-errands-ts:execution-report-decline-reason"/>
                </field-visibility>
            </form>
        </forms>
    </config>
    <config evaluator="node-type" condition="lecm-errands-ts:execution-report">
        <forms>
            <form id="table-structure-expand">
                <field-visibility>
                    <show id="lecm-errands-ts:execution-report-text"/>
                    <show id="lecm-errands-ts:execution-report-attachment-assoc"/>
                    <show id="lecm-errands-ts:execution-report-connected-document-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands-ts:execution-report-text"/>
                    <field id="lecm-errands-ts:execution-report-attachment-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="viewUrl">document-attachment?nodeRef={nodeRef}</control-param> '
                        </control>
                    </field>
                    <field id="lecm-errands-ts:execution-report-connected-document-assoc">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-errands-ts:execution-reports-table">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-errands-ts:coexecutor-report">
        <forms>
            <form id="table-structure-expand">
                <field-visibility>
                    <show id="lecm-errands-ts:coexecutor-report-text"/>
                    <show id="lecm-errands-ts:coexecutor-report-attachment-assoc"/>
                    <show id="lecm-errands-ts:coexecutor-report-connected-document-assoc"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="fieldsAndButtons" template="/ru/it/lecm/base-share/components/2-columns-set-with-nested.ftl"/>
                    <set id="fields" parent="fieldsAndButtons"/>
                    <set id="buttons" parent="fieldsAndButtons"/>
                    <field id="lecm-errands-ts:coexecutor-report-text" set="fields"/>
                    <field id="lecm-errands-ts:coexecutor-report-attachment-assoc" set="fields">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="viewUrl">document-attachment?nodeRef={nodeRef}</control-param> '
                        </control>
                    </field>
                    <field id="lecm-errands-ts:coexecutor-report-connected-document-assoc" set="fields">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script"  set="buttons">
                        <control template="/ru/it/lecm/errands/controls/coexecutor-expand-actions-control.ftl"/>
                    </field>
                </appearance>
            </form>
            <form id="decline-coexecutor-report">
                <field-visibility>
                    <show id="lecm-errands-ts:coexecutor-report-decline-reason"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands-ts:coexecutor-report-decline-reason" mandatory="true">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">5</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form>
                <field-visibility>
                    <show id="lecm-errands-ts:coexecutor-report-text"/>
                    <show id="lecm-errands-ts:coexecutor-report-attachment-assoc"/>
                    <show id="lecm-errands-ts:coexecutor-report-connected-document-assoc"/>
                    <show id="route-report-button" force="true"/>
                    <show id="lecm-errands-ts:coexecutor-report-is-route"/>
                    <show id="coexecutor-report-form-script" force="true"/>

                </field-visibility>
                <appearance>
                    <field id="lecm-errands-ts:coexecutor-report-attachment-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Исполнение</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands-ts:coexecutor-report-connected-document-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control-with-dialog.ftl">
                            <control-param name="multipleSelectMode">true</control-param>
                            <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:Documents</control-param>
                            <control-param name="nameSubstituteString">{lecm-document:ext-present-string}&lt;/br&gt;{lecm-document:list-present-string}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="itemType">lecm-document:base</control-param>
                        </control>
                    </field>
                    <field id="route-report-button" label-id="button.route-report">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                                <control-param name="clickFireAction">routeReportButtonClick</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands-ts:coexecutor-report-is-route">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="coexecutor-report-form-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-coexecutor-report-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsEFCoexecutorReportScriptLoaded</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-errands-ts:coexecutor-reports-table">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

	<config evaluator="node-type" condition="lecm-errands-dic:errand-titles">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands-dic:errand-title-code" read-only="true"/>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-errands-dic:errand-titles">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands-dic:errand-title-code">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
							<constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup"/>
						</constraint-handlers>
					</field>
				</appearance>
			</form>
			<form id="search">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
				<appearance>
                    <field id="cm:name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup"/>
                        </constraint-handlers>
                    </field>
					<field id="lecm-errands-dic:errand-title-code" mandatory="false">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup"/>
						</constraint-handlers>
					</field>
				</appearance>
			</form>
			<form id="datagrid">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-errands-dic:errand-title-code" force="true"/>
				</field-visibility>
			</form>
		</forms>
	</config>
    <config evaluator="node-type" condition="lecm-errands-dic:errand-cancel-reason">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-errands-dic:errand-cancel-reason-name" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>
    <config evaluator="model-type" condition="lecm-errands-dic:errand-cancel-reason">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-errands-dic:errand-cancel-reason-name" force="true"/>
                </field-visibility>
            </form>
            <form id="search">
                <field-visibility>
                    <show id="lecm-errands-dic:errand-cancel-reason-name" force="true"/>
                </field-visibility>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-errands-dic:errand-cancel-reason-name" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>
    <config evaluator="node-type" condition="lecm-errands-dic:errand-type">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="lecm-errands-dic:errand-type-default-title"/>
                    <show id="lecm-errands-dic:errand-type-manual-selection"/>
                    <show id="lecm-errands-dic:errand-type-report-required"/>
                    <show id="lecm-errands-dic:errand-type-limitless"/>
                    <show id="lecm-errands-dic:errand-type-launch-review"/>
                </field-visibility>
                <appearance>
                    <field id="cm:name" label-id="label.errands.type.name"/>
                    <field id="lecm-errands-dic:errand-type-default-title">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-errands-dic:errand-type">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="lecm-errands-dic:errand-type-default-title"/>
                    <show id="lecm-errands-dic:errand-type-manual-selection"/>
                    <show id="lecm-errands-dic:errand-type-report-required"/>
                    <show id="lecm-errands-dic:errand-type-limitless"/>
                    <show id="lecm-errands-dic:errand-type-launch-review"/>
                </field-visibility>
                <appearance>
                    <field id="cm:name" label-id="label.errands.type.name"/>
                    <field id="lecm-errands-dic:errand-type-default-title">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="search">
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="lecm-errands-dic:errand-type-default-title"/>
                </field-visibility>
                <appearance>
                    <field id="cm:name" label-id="label.errands.type.name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands-dic:errand-type-default-title" mandatory="false">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup"/>
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="lecm-errands-dic:errand-type-default-title"/>
                </field-visibility>
                <appearance>
                    <field id="cm:name" label-id="label.errands.type.name"/>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="node-type" condition="lecm-errands:settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:settings-mode-choosing-executors"/>
					<show id="lecm-errands:settings-transfer-rights"/>
                    <show id="lecm-errands:settings-hide-additional-attrs"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands:settings-mode-choosing-executors">
						<control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-errands:settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:settings-mode-choosing-executors"/>
					<show id="lecm-errands:settings-transfer-rights"/>
				</field-visibility>
				<appearance>
					<field id="lecm-errands:settings-mode-choosing-executors">
						<control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="node-type" condition="lecm-errands:user-settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:user-settings-default-initiator-assoc"/>
					<show id="lecm-errands:user-settings-default-subject-assoc"/>
				</field-visibility>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-errands:user-settings">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-errands:user-settings-default-initiator-assoc"/>
					<show id="lecm-errands:user-settings-default-subject-assoc"/>
				</field-visibility>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsRemoveDraft">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsCreateChildErrand">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-links:link">
        <forms>
            <form>
                <field-visibility>
                    <!-- Название ссылки -->
                    <show id="cm:name"/>
                    <!-- Описание -->
                    <show id="cm:description"/>
                    <!-- Ссылка -->
                    <show id="lecm-links:url"/>
                </field-visibility>
            </form>
        </forms>
    </config>


    <config evaluator="string-compare" condition="activiti$errandsRequestDueDateChange">
        <forms>
            <form>
                <field-visibility>
                    <show id="bpm:workflowDescription"/>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:requestDueDateChangeNewDate"/>
                    <show id="lecmErrandWf:requestDueDateChangeReason"/>
                </field-visibility>
                <appearance>
	                <field id="bpm:workflowDescription">
		                <control template="/ru/it/lecm/documents/controls/workflow/document-present-string-hidden.ftl">
			                <control-param name="leftPartTextCode">ru.it.errand.requestDueDateChange.workflowDescription.message</control-param>
		                </control>
	                </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
					<field id="lecmErrandWf:requestDueDateChangeNewDate">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
					</field>
	                <field id="lecmErrandWf:requestDueDateChangeReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsRequestDueDateChange_1">
        <forms>
            <form>
                <field-visibility>
                    <show id="bpm:workflowDescription"/>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:requestDueDateChange_1CurrentDueDate"/>
                    <show id="lecmErrandWf:requestDueDateChange_1NewDateRadio"/>
                    <show id="lecmErrandWf:requestDueDateChange_1NewDate"/>
                    <show id="lecmErrandWf:requestDueDateChange_1ChildDueDate"/>
                    <show id="lecmErrandWf:requestDueDateChange_1Reason"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="requestChangeDueDateFormScript" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/wf-due-date-set.ftl"/>
                    <set id="block2"/>
	                <field id="bpm:workflowDescription">
		                <control template="/ru/it/lecm/documents/controls/workflow/document-present-string-hidden.ftl">
			                <control-param name="leftPartTextCode">ru.it.errand.requestDueDateChange.workflowDescription.message</control-param>
		                </control>
	                </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChange_1CurrentDueDate" label-id="label.current-due-date" read-only="true">
                        <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
                            <control-param name="substituteString">
                                <![CDATA[
					               {lecm-errands:limitation-date-text}
				                ]]>
                            </control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChange_1NewDateRadio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATE</control-param>
                            <control-param name="fireChangeEventName">changeDueDateRadioEvent</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChange_1NewDate" set="limitation-date">
                        <control>
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Errands.WFChangeDueDateValidation" event="change" message-id="Alfresco.forms.validation.mandatory.message"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChange_1ChildDueDate" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:requestDueDateChange_1Reason" set="block2">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">6</control-param>
		                </control>
	                </field>
                    <field id="requestChangeDueDateFormScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-change-due-date-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsWFChangeDueDateScriptLoaded</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="task-type" condition="lecmErrandWf:requestDueDateChangeTask">
		<forms>
			<form>
				<field-visibility>
					<show id="lecmErrandWf:requestDueDateChangeTaskNewDate"/>
					<show id="lecmErrandWf:requestDueDateChangeTaskDateReason"/>
					<show id="lecmErrandWf:requestDueDateChangeTaskComment"/>
					<show id="lecmErrandWf:requestDueDateChangeTaskResult"/>
				</field-visibility>
				<appearance>
					<field id="lecmErrandWf:requestDueDateChangeTaskNewDate" mandatory="true" read-only="true">
						<control template="/ru/it/lecm/base-share/components/controls/date.ftl">
							<control-param name="minLimitCurrentDate">true</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestChangeDueDateTaskNewDateValidation" event="change"/>
						</constraint-handlers>
					</field>
					<field id="lecmErrandWf:requestDueDateChangeTaskDateReason" read-only="true">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
							<control-param name="rows">7</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestDueDateChangeTaskComment">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
							<control-param name="rows">7</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestDueDateChangeTaskResult" mandatory="true">
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestChangeDueDateTaskNewDateValidation" event="change"/>
						</constraint-handlers>
						<control template="/ru/it/lecm/base-share/components/controls/activiti-transitions-radiobuttons.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="task-type" condition="lecmErrandWf:requestDueDateChangeTask_1">
        <forms>
            <form>
                <field-visibility>
                    <show  id="packageItems"/>
                    <show id="lecmErrandWf:requestDueDateChangeTask_1CurrentDueDate"/>
                    <show id="lecmErrandWf:requestDueDateChangeTask_1NewDueDateRadio"/>
                    <show id="lecmErrandWf:requestDueDateChangeTask_1NewDate"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecmErrandWf:requestDueDateChangeTask_1DateReason"/>
                    <show id="lecmErrandWf:requestDueDateChangeTask_1Result"/>
                    <show id="lecmErrandWf:requestDueDateChangeTask_1RejectReason"/>
                    <show id="requestDueDateChangeTaskFormScript" force="true"/>
				</field-visibility>
				<appearance>
					<set id="limitation-date"  template="/ru/it/lecm/errands/controls/wf-due-date-set.ftl"/>
                    <set id="block2"/>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChangeTask_1CurrentDueDate" label-id="label.current-due-date" read-only="true">
                        <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
                            <control-param name="substituteString">
                                <![CDATA[
					               {lecm-errands:limitation-date-text}
				                ]]>
                            </control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChangeTask_1NewDueDateRadio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATE</control-param>
                            <control-param name="fireChangeEventName">changeDueDateRadioEvent</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChangeTask_1NewDate" mandatory="true" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestChangeDueDateTask_1NewDateValidation" event="change" message-id="Alfresco.forms.validation.mandatory.message"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChangeTask_1DateReason" read-only="true" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">5</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChangeTask_1Result" mandatory="true" set="block2">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestChangeDueDateTask_1NewDateValidation" event="change"/>
                        </constraint-handlers>
                        <control template="/ru/it/lecm/base-share/components/controls/activiti-transitions-radiobuttons.ftl"/>
                    </field>
                    <field id="lecmErrandWf:requestDueDateChangeTask_1RejectReason" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">5</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestDueDateChangeTaskRejectReasonValidation" event="change" message-id="message.reject.reason.mandatory"/>
                        </constraint-handlers>
                    </field>
                    <field id="requestDueDateChangeTaskFormScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-change-due-date-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">requestDueDateChangeTaskFormScriptLoaded</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsChangeDueDate">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:changeDueDateCurrentDueDate"/>
                    <show id="lecmErrandWf:changeDueDateNewDueDateRadio"/>
                    <show id="lecmErrandWf:changeDueDateNewDueDate"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecmErrandWf:changeDueDateChangeChildDueDate"/>
                    <show id="lecmErrandWf:changeDueDateReason"/>
                    <show id="changeDueDateFormScript" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/wf-due-date-set.ftl"/>
                    <set id="block2"/>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:changeDueDateCurrentDueDate" label-id="label.current-due-date" read-only="true">
                        <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
                            <control-param name="substituteString">
                                <![CDATA[
					               {lecm-errands:limitation-date-text}
				                ]]>
                            </control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:changeDueDateNewDueDateRadio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATE</control-param>
                            <control-param name="fireChangeEventName">changeDueDateRadioEvent</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:changeDueDateNewDueDate" set="limitation-date">
                        <control>
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Errands.WFChangeDueDateValidation" event="change" message-id="Alfresco.forms.validation.mandatory.message"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:changeDueDateChangeChildDueDate" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:changeDueDateReason" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">6</control-param>
                        </control>
                    </field>
                    <field id="changeDueDateFormScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-change-due-date-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsWFChangeDueDateScriptLoaded</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsChangeExecutor">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
	                <show id="lecmErrandWf:changeExecutorCurrentExecutor"/>
	                <show id="lecmErrandWf:changeExecutorNewExecutor"/>
	                <show id="lecmErrandWf:changeExecutorReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:changeExecutorCurrentExecutor" label-id="field.changeExecutorCurrentExecutor.title">
		                <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
			                <control-param name="substituteString">
				                <![CDATA[
					                <a href='/{~SHARE_CONTEXT}/page/view-metadata?nodeRef={lecm-errands:executor-assoc/nodeRef}'>
					                    {lecm-errands:executor-assoc/lecm-orgstr:employee-short-name} {lecm-errands:executor-assoc/..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}
					                </a>
				                ]]>
			                </control-param>
		                </control>
	                </field>
                    <field id="lecmErrandWf:changeExecutorNewExecutor">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                        </control>
                    </field>
	                <field id="lecmErrandWf:changeExecutorReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>
    <config evaluator="string-compare" condition="activiti$errandsChangeExecutor_1">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:changeExecutor_1CurrentExecutor"/>
                    <show id="lecmErrandWf:changeExecutor_1NewExecutor"/>
                    <show id="lecmErrandWf:changeExecutor_1Reason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:changeExecutor_1CurrentExecutor" label-id="field.changeExecutorCurrentExecutor.title">
                        <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
                            <control-param name="substituteString">
                                <![CDATA[
					                <a href='/share/page/view-metadata?nodeRef={lecm-errands:executor-assoc/nodeRef}'>
					                    {lecm-errands:executor-assoc/lecm-orgstr:employee-short-name} {lecm-errands:executor-assoc/..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}
					                </a>
				                ]]>
                            </control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:changeExecutor_1NewExecutor">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:changeExecutor_1Reason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsChangeCoexecutors">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:changeCoexecutorsNewCoexecutors"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:changeCoexecutorsNewCoexecutors">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="selectedItemsFormArgs">currentCoexecutorsAssoc</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsChangeController">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:changeControllerCurrentController"/>
                    <show id="lecmErrandWf:changeControllerNewController"/>
                    <show id="lecmErrandWf:changeControllerReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:changeControllerCurrentController" label-id="field.changeControllerCurrentController.title">
                        <control template="/ru/it/lecm/documents/controls/workflow/format-packageItems-document.ftl">
                            <control-param name="substituteString">
                                <![CDATA[
					                <a href='/{~SHARE_CONTEXT}/page/view-metadata?nodeRef={lecm-errands:controller-assoc/nodeRef}'>
					                    {lecm-errands:controller-assoc/lecm-orgstr:employee-short-name} {lecm-errands:controller-assoc/..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}
					                </a>
				                ]]>
                            </control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:changeControllerReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsRequestCancel">
        <forms>
            <form>
                <field-visibility>
	                <show id="bpm:workflowDescription"/>
                    <show id="packageItems"/>
	                <show id="lecmErrandWf:requestCancelReason"/>
                </field-visibility>
                <appearance>
	                <field id="bpm:workflowDescription">
		                <control template="/ru/it/lecm/documents/controls/workflow/document-present-string-hidden.ftl">
			                <control-param name="leftPartTextCode">ru.it.errand.requestCancel.workflowDescription.message</control-param>
		                </control>
	                </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:requestCancelReason">
                        <control  template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Причины_x0020_отмены_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-cancel-reason</control-param>
                            <control-param name="nameSubstituteString">{lecm-errands-dic:errand-cancel-reason-name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsRequestCancel_1">
        <forms>
            <form>
                <field-visibility>
                    <show id="bpm:workflowDescription"/>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:requestCancelReason"/>
                </field-visibility>
                <appearance>
                    <field id="bpm:workflowDescription">
                        <control template="/ru/it/lecm/documents/controls/workflow/document-present-string-hidden.ftl">
                            <control-param name="leftPartTextCode">ru.it.errand.requestCancel.workflowDescription.message</control-param>
                        </control>
                    </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:requestCancelReason">
                        <control  template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Причины_x0020_отмены_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-cancel-reason</control-param>
                            <control-param name="nameSubstituteString">{lecm-errands-dic:errand-cancel-reason-name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="task-type" condition="lecmErrandWf:requestCancelTask">
		<forms>
			<form>
				<field-visibility>
					<show id="lecmErrandWf:requestCancelTaskTitle"/>
					<show id="lecmErrandWf:requestCancelTaskReason"/>
					<show id="lecmErrandWf:requestCancelTaskResult"/>
					<show id="lecmErrandWf:requestCancelTaskNewExecutor"/>
				</field-visibility>
				<appearance>
					<field id="lecmErrandWf:requestCancelTaskTitle">
						<control template="/ru/it/lecm/base-share/components/controls/view-text-control.ftl">
							<control-param name="showLabel">false</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestCancelTaskReason" read-only="true">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
							<control-param name="rows">7</control-param>
						</control>
					</field>
					<field id="lecmErrandWf:requestCancelTaskResult" mandatory="true">
						<control template="/ru/it/lecm/base-share/components/controls/activiti-transitions-radiobuttons.ftl"/>
					</field>
					<field id="lecmErrandWf:requestCancelTaskNewExecutor">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestCancelTaskNewExecutorValidation" message-id="validation-hint.mandatory" event="change"/>
                        </constraint-handlers>
						<control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
							<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="task-type" condition="lecmErrandWf:requestCancelTask_1">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:requestCancelTask_1Reason"/>
                    <show id="lecmErrandWf:requestCancelTask_1Result"/>
                    <show id="lecmErrandWf:requestCancelTask_1CancelReason"/>
                    <show id="lecmErrandWf:requestCancelTask_1CancelChildren"/>
                    <show id="lecmErrandWf:requestCancelTask_1RejectReason"/>
                    <show id="lecmErrandWf:requestCancelTask_1NewExecutor"/>
                    <show id="requestCancelTaskFormScript" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:requestCancelTask_1Reason" read-only="true">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">3</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestCancelTask_1Result" mandatory="true" label-id="label.errands.request.cancel.result.radiobuttons">
                        <control template="/ru/it/lecm/errands/controls/errands-cancellation-activiti-radiobuttons-control.ftl">
                            <control-param name="selectedValue">CANCEL_ERRAND</control-param>
                            <control-param name="changeValueFireAction">errandsRequestCancelResultChanged</control-param>
                            <control-param name="fieldsByOption">lecmErrandWf:requestCancelTask_1CancelReason|lecmErrandWf:requestCancelTask_1CancelChildren#alf#lecmErrandWf:requestCancelTask_1RejectReason#alf#lecmErrandWf:requestCancelTask_1NewExecutor</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestCancelTask_1CancelReason" >
                        <control  template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Причины_x0020_отмены_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-cancel-reason</control-param>
                            <control-param name="nameSubstituteString">{lecm-errands-dic:errand-cancel-reason-name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestCancelTask_1CancelChildren">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:requestCancelTask_1RejectReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">3</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:requestCancelTask_1NewExecutor">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.requestCancelTaskNewExecutorValidation" message-id="validation-hint.mandatory" event="change"/>
                        </constraint-handlers>
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="useStrictFilterByOrg">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="requestCancelTaskFormScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-cancel-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">requestCancelTaskFormScriptLoaded</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsApproverDecline">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:approverDeclineReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:approverDeclineReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">5</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsInitiatorDecline">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:initiatorDeclineReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:initiatorDeclineReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$errandsInitiatorApprove">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems"/>
					<show id="lecmErrandWf:errandInitiatorApproveMessage"/>
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmErrandWf:errandInitiatorApproveMessage">
						<control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
							<control-param name="msg">ru.it.errand.initiatorApprove.message</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsControllerDecline">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
	                <show id="lecmErrandWf:controllerDeclineReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
	                <field id="lecmErrandWf:controllerDeclineReason">
		                <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
			                <control-param name="rows">7</control-param>
		                </control>
	                </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$errandsControllerApprove">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems"/>
					<show id="lecmErrandWf:errandControllerApproveMessage"/>
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmErrandWf:errandControllerApproveMessage">
						<control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
							<control-param name="msg">ru.it.errand.controllerApprove.message</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsCancel">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:cancelReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:cancelReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsCancel_1">
        <forms>
            <form>
	            <field-visibility>
		            <show id="packageItems"/>
		            <show id="lecmErrandWf:cancel_1CancelReason"/>
                    <show id="lecmErrandWf:cancel_1CancelChildren"/>
                    <show id="errandCancelFormScript" force="true"/>
	            </field-visibility>
	            <appearance>
		            <field id="packageItems">
			            <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
		            </field>
                    <field id="lecmErrandWf:cancel_1CancelReason">
                        <control  template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Причины_x0020_отмены_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-cancel-reason</control-param>
                            <control-param name="nameSubstituteString">{lecm-errands-dic:errand-cancel-reason-name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:cancel_1CancelChildren">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="errandCancelFormScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-cancel-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandCancelFormScriptLoaded</control-param>
                        </control>
                    </field>
	            </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$errandsExecute">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems"/>
					<show id="lecmErrandWf:errandExecuteMessage"/>
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmErrandWf:errandExecuteMessage">
						<control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
							<control-param name="msg">ru.it.errand.execute.message</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$errandsExecute_1">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:execute_1CloseChild"/>
                    <show id="lecmErrandWf:execute_1ReportText"/>
                    <show id="lecmErrandWf:execute_1Attachment"/>
                    <show id="lecmErrandWf:execute_1ConnectedDocument"/>
                    <show id="executeErrand_WFScript" force="true"/>
                    <show id="lecmErrandWf:execute_1Execute"/>
                    <show id="execute-errand-button" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:execute_1CloseChild">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:execute_1ReportText">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl"/>
                    </field>
                    <field id="lecmErrandWf:execute_1Attachment">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Исполнение</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:execute_1ConnectedDocument">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control-with-dialog.ftl">
                            <control-param name="multipleSelectMode">true</control-param>
                            <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:Documents</control-param>
                            <control-param name="nameSubstituteString">{lecm-document:ext-present-string}&lt;/br&gt;{lecm-document:list-present-string}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="itemType">lecm-document:base</control-param>
                            <control-param name="selectedItemsFormArgs">executionConnectedDocs</control-param>
                        </control>
                    </field>
                    <field id="execute-errand-button" label-id="button.errand.execute">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">executeErrandButtonClick</control-param>
                        </control>
                    </field>
                    <field id="executeErrand_WFScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-execute-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsExecuteWFScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:execute_1Execute">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsCoexecutorReport">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:coexecutorReportText"/>
                    <show id="lecmErrandWf:coexecutorReportAttachment"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:coexecutorReportText">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl"/>
                    </field>
                    <field id="lecmErrandWf:coexecutorReportAttachment">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Отчёты соисполнителей</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$errandsCoexecutorReport_1">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:coexecutorReport_1Text"/>
                    <show id="lecmErrandWf:coexecutorReport_1Attachment"/>
                    <show id="lecmErrandWf:coexecutorReport_1ConnectedDocument"/>
                    <show id="coexecutorReport_WFScript" force="true"/>
                    <show id="lecmErrandWf:coexecutorReport_1RouteReport"/>
                    <show id="route-report-button" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:coexecutorReport_1Text">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl"/>
                    </field>
                    <field id="lecmErrandWf:coexecutorReport_1Attachment">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Отчёты соисполнителей</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:coexecutorReport_1ConnectedDocument">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control-with-dialog.ftl">
                            <control-param name="multipleSelectMode">true</control-param>
                            <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:Documents</control-param>
                            <control-param name="nameSubstituteString">{lecm-document:ext-present-string}&lt;/br&gt;{lecm-document:list-present-string}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="itemType">lecm-document:base</control-param>
                        </control>
                    </field>
                    <field id="route-report-button" label-id="button.route-report">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">routeReportButtonClick</control-param>
                        </control>
                    </field>
                    <field id="coexecutorReport_WFScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-coexecutor-report-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsWFCoexecutorReportScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:coexecutorReport_1RouteReport">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="activiti$createErrands">
        <forms>
            <form>
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecmErrandWf:typeAssoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecmErrandWf:title"/>
                    <!-- Содержание -->
                    <show id="lecmErrandWf:content"/>
                    <!-- Исполнитель -->
                    <show id="lecmErrandWf:executorAssoc"/>
                    <!-- Соисполнители -->
                    <show id="lecmErrandWf:coexecutorsAssoc"/>
                    <!-- Автор -->
                    <show id="lecmErrandWf:initiatorAssoc"/>
                    <!-- Срок исполнения -->
                    <show id="limitation-date-script" force="true"/>
                    <show id="lecmErrandWf:limitationDateRadio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecmErrandWf:limitationDateDays" />
                    <show id="lecmErrandWf:limitationDateType"/>
                    <show id="lecmErrandWf:limitationDate" />
                    <!-- Периодичность -->
                    <show id="lecmErrandWf:periodically"/>
                    <!-- Контролер-->
                    <show id="lecmErrandWf:controllerAssoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecmErrandWf:reportRequired"/>
                    <!--Получатель отчета-->
                    <show id="lecmErrandWf:reportRecipientType"/>
                    <!-- Важное -->
                    <show id="lecmErrandWf:isImportant"/>
                    <!-- Тематика -->
                    <show id="lecmErrandWf:subjectAssoc"/>

                    <show id="change-errand-type-script" force="true"/>
                    <show id="report-required-handler-script" force="true"/>
                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <set id="exist-business-role" template="/ru/it/lecm/errands/controls/errands-choosing-set.ftl" />
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="block2"/>

                    <field id="lecmErrandWf:typeAssoc" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">createErrandsWFErrandTypeChanged</control-param>
                            <control-param name="additionalFilter">@lecm\-errands\-dic\:errand\-type\-manual\-selection:true</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:title">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:content">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:executorAssoc">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>

                    <field id="lecmErrandWf:controllerAssoc">
                        <control>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:coexecutorsAssoc">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:initiatorAssoc" set="exist-business-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecmErrandWf:limitationDateRadio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">createErrandsWFChangeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.createErrandWFLimitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecmErrandWf:limitationDateDays" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.createErrandWFLimitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecmErrandWf:limitationDateType" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecmErrandWf:limitationDate" set="limitation-date">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.createErrandWFLimitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>

                    <field id="lecmErrandWf:periodically" set="block2" read-only="true">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">periodicallyErrandChange</control-param>
                        </control>
                    </field>

                    <field id="lecmErrandWf:controllerAssoc" set="block2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">createErrandsWFErrandControllerChanged</control-param>
                        </control>
                    </field>

                    <field id="lecmErrandWf:reportRequired" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">createErrandsWFErrandReportRequiredChanged</control-param>
                        </control>
                    </field>

                    <field id="lecmErrandWf:reportRecipientType" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecmErrandWf:isImportant" set="block2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>

                    <field id="lecmErrandWf:subjectAssoc" set="block2">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                        </control>
                    </field>
                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">createErrandsWFChangeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecmErrandWf:limitationDate</control-param>
                            <control-param name="daysCountField">lecmErrandWf:limitationDateDays</control-param>
                            <control-param name="daysTypeField">lecmErrandWf:limitationDateType</control-param>
                        </control>
                    </field>
                    <field id="report-required-handler-script" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$primaryRouting">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:primaryRoutingErrandsList"/>
                    <show id="change-errand-type-script" force="true"/>
                    <show id="limitation-date-script" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:primaryRoutingErrandsList" label-id="field.primaryRouting.errands.title">
                        <control template="/ru/it/lecm/eds/controls/multi-form-control.ftl">
                            <control-param name="documentType">lecm-errands:document</control-param>
                            <control-param name="documentFromId">primary-routing</control-param>
                            <control-param name="fixSimpleDialogId">workflow-form</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="incomingPrimaryRouting">
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="unit-recipients-without-boss" force="true"/>
                    <show id="lecmErrandWf:primaryRoutingErrandsList"/>
                    <show id="change-errand-type-script" force="true"/>
                    <show id="change-recipient-script" force="true"/>
                    <show id="limitation-date-script" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="unit-recipients-without-boss">
                        <control template="/ru/it/lecm/incoming/controls/recipients-without-boss-message-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:primaryRoutingErrandsList" label-id="field.primaryRouting.errands.title">
                        <control template="/ru/it/lecm/eds/controls/multi-form-control.ftl">
                            <control-param name="availableRemoveDefault">false</control-param>
                            <control-param name="documentType">lecm-errands:document</control-param>
                            <control-param name="documentFromId">primary-routing</control-param>
                            <control-param name="fixSimpleDialogId">workflow-form</control-param>
                            <control-param name="defaultValueFromId">incoming-default-primary-routing</control-param>
                            <control-param name="defaultValueDataSource">lecm/incoming/primaryRouting/defaultErrands/datasource</control-param>
                            <control-param name="additionalCss">css/lecm-errands/errands-limitation-date-set.css</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="change-recipient-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-primary-routing-change-recipient.js</control-param>
                        </control>
                    </field>
                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>
    <config evaluator="string-compare" condition="activiti$routeErrand">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmErrandWf:errandRouteMessage"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmErrandWf:errandRouteMessage">
                        <control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
                            <control-param name="msg">ru.it.errand.route.message</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="Workflow">
        <hidden-workflows>
            <workflow name="activiti$lecm-errands_document"/>
            <workflow name="activiti$errandsRequestDueDateChange"/>
            <workflow name="activiti$errandsRequestDueDateChange_1"/>
            <workflow name="activiti$errandsRequestCancel"/>
            <workflow name="activiti$errandsRequestCancel_1"/>
            <workflow name="activiti$errandsChangeDueDate"/>
            <workflow name="activiti$errandsInitiatorApprove"/>
            <workflow name="activiti$errandsInitiatorDecline"/>
            <workflow name="activiti$errandsExecute"/>
            <workflow name="activiti$errandsExecute_1"/>
            <workflow name="activiti$errandsControllerDecline"/>
            <workflow name="activiti$errandsControllerApprove"/>
            <workflow name="activiti$errandsCancel"/>
            <workflow name="activiti$errandsCancel_1"/>
            <workflow name="activiti$errandsChangeExecutor"/>
            <workflow name="activiti$errandsChangeExecutor_1"/>
            <workflow name="activiti$errandsChangeCoexecutors"/>
            <workflow name="activiti$errandsChangeController"/>
            <workflow name="activiti$errandsCreateChildErrand"/>
            <workflow name="activiti$errandsRemoveDraft"/>
            <workflow name="activiti$errandsCoexecutorReport"/>
            <workflow name="activiti$errandsCoexecutorReport_1"/>
            <workflow name="activiti$routeErrand"/>
            <workflow name="activiti$errandsApproverDecline"/>
        </hidden-workflows>
    </config>

    <config evaluator="node-type" condition="lecm-errands:dashlet-settings">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-errands:dashlet-settings-arm"/>
                    <show id="lecm-errands:dashlet-settings-path"/>
                    <show id="lecm-errands:dashlet-settings-unexecuted"/>
                    <show id="lecm-errands:dashlet-settings-unexecuted-important"/>
                    <show id="lecm-errands:dashlet-settings-await-execution"/>
                    <show id="lecm-errands:dashlet-settings-await-execution-important"/>
                    <show id="lecm-errands:dashlet-settings-expired"/>
                    <show id="lecm-errands:dashlet-settings-expired-important"/>
                    <show id="lecm-errands:dashlet-settings-approaching-deadline"/>
                    <show id="lecm-errands:dashlet-settings-approaching-deadline-important"/>

                </field-visibility>
            </form>
        </forms>
    </config>

</alfresco-config>
