<alfresco-config>

    <config evaluator="node-type" condition="lecm-errands:document">
        <forms>
            <!-- Форма просмотра-->
            <form>
                <field-visibility>
                    <!-- Документ-основание -->
                    <show id="lecm-errands:base-assoc"/>
                    <!-- Основание -->
                    <show id="lecm-errands:additional-document-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Создатель -->
                    <show id="lecm-document:author-assoc"/>
                    <!--  Тип поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Текст поручения -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-text"/>
                    <!-- Закрывает вышестоящее поручение -->
                    <show id="lecm-errands:auto-close"/>
                    <!-- Направлять периодически  -->
                    <!-- Периодичность -->
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:period-end-text"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="common" label-id="label.errands.forms.tab.common"/>
                    <set id="commonField1" parent="common"/>
                    <set id="periodicallySet" parent="common" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="commonField2" parent="common"/>

                    <field id="lecm-errands:base-assoc" set="commonField1">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:additional-document-assoc" set="commonField1">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="commonField1">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Errands.checkChoosingInitiatorValidation" event="change"/>
                        </constraint-handlers>
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:author-assoc" set="commonField1" label-id="label.document.creator"/>
                    <field id="lecm-errands:type-assoc" set="commonField1" mandatory="true"/>
                    <field id="lecm-errands:title" set="commonField1">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" set="commonField1">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" set="commonField1">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" set="commonField1">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-text" set="commonField1"/>
                    <field id="lecm-errands:auto-close" set="commonField1">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:periodically" set="commonField1"/>
                    <field id="lecm-errands:reiteration-rule" set="periodicallySet">
                        <control template="/ru/it/lecm/errands/controls/errands-reiteration-control.ftl"/>
                    </field>
                    <field id="lecm-errands:period-start" set="periodicallySet"/>
                    <field id="lecm-errands:period-end-text" set="periodicallySet" label-id="label.errand.period-end"/>
                    <field id="lecm-errands:controller-assoc" set="commonField2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required" set="commonField2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-recipient-type" set="commonField2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-document:subject-assoc" set="commonField2"/>

                    <field id="lecm-base-dummy-aspects:script2" set="commonField2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-view-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsTabsFormScriptLoaded</control-param>
                            <control-param name="requireField">lecm-errands:periodically</control-param>
                        </control>
                    </field>

                    <field id="lecm-base-dummy-aspects:script6" set="execution">
                        <control template="/ru/it/lecm/eds/controls/execution-tree-control.ftl"/>
                    </field>
                </appearance>
            </form>

            <form id="exec_reports">
                <field-visibility>
                    <!-- Отчет об исполнении -->
                    <!-- Статус отчета -->
                    <show id="lecm-errands:execution-report-status" force="true"/>
                    <!-- Причина отмены -->
                    <show id="lecm-errands:execution-report-decline-reason" force="true"/>
                    <!-- Текст отчета -->
                    <show id="lecm-errands:execution-report"/>
                    <!-- Связи -->
                    <show id="lecm-errands:execution-connected-document-assoc"/>
                    <!-- Вложения -->
                    <show id="lecm-errands:execution-report-attachment-assoc"/>
                    <!-- Предидущие отчеты -->
                    <show id="lecm-errands-ts:execution-reports-assoc" force="true"/>
                    <!-- Разделительная линия -->
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <!-- Отчеты соисполнителей -->
                    <show id="lecm-errands-ts:coexecutor-reports-assoc"/>
                </field-visibility>
                <appearance>
                    <set id="reports" label-id="label.errands.forms.tab.reports"/>
                    <set id="execution-report" parent="reports" appearance="title" template="/ru/it/lecm/errands/controls/errands-execution-report-set.ftl" label-id="title.errands.execution-reports"/>
                    <set id="lineReports" parent="reports"/>
                    <set id="coexecutors-reports" parent="reports" appearance="title" label-id="title.errands.coexecutors-reports"/>

                    <field id="lecm-errands:execution-report-status" set="execution-report"/>
                    <field id="lecm-errands:execution-report-decline-reason" set="execution-report"/>
                    <field id="lecm-errands:execution-report" set="execution-report">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-connected-document-assoc" set="execution-report">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:ext-present-string}</control-param>
                            <control-param name="showInaccessible">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:execution-report-attachment-assoc" set="execution-report">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="viewUrl">document-attachment?nodeRef={nodeRef}</control-param> '
                        </control>
                    </field>
                    <field id="lecm-errands-ts:execution-reports-assoc" set="execution-report">
                        <control template="/ru/it/lecm/errands/controls/execution-reports-table-control.ftl">
                            <control-param name="isTableSortable">true</control-param>
                            <control-param name="sort">lecm-errands-ts:execution-report-create-date|false</control-param>
                            <control-param name="expandDataSource">lecm/components/form?formId=table-structure-expand</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="reports">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reports-tab-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsReportsTabViewFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="lineReports">
                        <control template="/ru/it/lecm/base-share/components/controls/line.ftl"/>
                    </field>
                    <field id="lecm-errands-ts:coexecutor-reports-assoc" set="coexecutors-reports">
                        <control template="/ru/it/lecm/errands/controls/coexecutors-reports-table-control.ftl">
                            <control-param name="datagridFormId">coexecutors-reports-datagrid</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="execution">
                <field-visibility>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-base-dummy-aspects:script">
                        <control template="/ru/it/lecm/eds/controls/execution-tree-control.ftl"/>
                    </field>
                </appearance>
            </form>

            <!-- Форма редактирования-->
            <form id="edit">
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Документ-основание -->
                    <show id="lecm-errands:base-assoc"/>
                    <!-- Основание -->
                    <show id="lecm-errands:additional-document-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!--  Тип поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Текст поручения -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date" />
                    <!-- Периодичность -->
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:periodically-radio"/>
                    <show id="lecm-errands:period-end"/>
                    <show id="lecm-base-dummy-aspects:script6" force="true"/>
                    <show id="lecm-errands:period-during"/>
                    <show id="lecm-errands:period-during-type"/>
                    <show id="lecm-errands:reiteration-count"/>
                    <show id="lecm-base-dummy-aspects:script7" force="true"/>

                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>

                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-base-dummy-aspects:script3" force="true"/>
                    <show id="lecm-base-dummy-aspects:script4" force="true"/>
                    <show id="lecm-base-dummy-aspects:script5" force="true"/>
                    <show id="lecm-base-dummy-aspects:script8" force="true"/>
                    <show id="lecm-base-dummy-aspects:script9" force="true"/>
                    <show id="lecm-base-dummy-aspects:script10" force="true"/>
                    <show id="reinitExecutorsScript" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="common" label-id="label.errands.forms.tab.common"/>
                    <set id="statuses" parent="common"/>
                    <set id="beforeDateSet" parent="common"/>
                    <set id="limitation-date" parent="common" label-id="label.limitation-date" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>/>
                    <set id="afterDateSet1" parent="common"/>
                    <set id="periodicallySet" parent="common" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="errand-validity" parent="periodicallySet" template="/ru/it/lecm/errands/controls/errands-validity-set.ftl"/>
                    <set id="validity-end-date" parent="errand-validity"/>
                    <set id="during" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="repeat" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="afterDateSet2" parent="common"/>

                    <field id="lecm-errands:is-important" set="statuses">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl" />
                    </field>
                    <field id="lecm-errands:base-assoc" set="beforeDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl"/>
                    </field>
                    <field id="lecm-errands:additional-document-assoc" set="beforeDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl"/>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="beforeDateSet">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Errands.checkChoosingInitiatorValidation" event="change"/>
                        </constraint-handlers>
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:type-assoc" set="beforeDateSet" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                            <control-param name="blockChangeItemOnInit">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="beforeDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="changeItemsFireAction">errandTitleChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" set="beforeDateSet">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" set="beforeDateSet">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" set="beforeDateSet">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:periodically" set="afterDateSet1">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandPeriodicallyPropChanged</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:reiteration-rule" set="periodicallySet">
                        <control template="/ru/it/lecm/errands/controls/errands-reiteration-control.ftl">
                            <control-param name="defaultType">DAILY</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-start" set="errand-validity">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:periodically-radio" set="errand-validity" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATERANGE</control-param>
                            <control-param name="fireChangeEventName">changePeriodEndDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:period-end" label="" set="validity-end-date">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script6" set="errand-validity">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.period-endless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-during" label-id="label.errand.during" set="during">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:period-during-type" set="during">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:reiteration-count" label-id="label.errand.endAfter" set="repeat">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script7" set="repeat">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.reiterationCount</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:controller-assoc" set="afterDateSet2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-recipient-type" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-document:subject-assoc" set="afterDateSet2"/>
                    <field id="lecm-base-dummy-aspects:script2" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script8" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/period-dates-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">periodDatesScriptLoaded</control-param>
                            <control-param name="bubblingName">changePeriodEndDateRadio</control-param>
                            <control-param name="startDateField">lecm-errands:period-start</control-param>
                            <control-param name="endDateField">lecm-errands:period-end</control-param>
                            <control-param name="duringCountField">lecm-errands:period-during</control-param>
                            <control-param name="duringTypeField">lecm-errands:period-during-type</control-param>
                            <control-param name="reiterationCountField">lecm-errands:reiteration-count</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script3" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script10" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-periodically-edit-form-handler.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsPeriodicalHandlerScriptLoaded</control-param>
                            <control-param name="periodicallyField">lecm-errands:periodically</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script5" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-view-form-script.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsTabsFormScriptLoaded</control-param>
                            <control-param name="requireField">lecm-errands:periodically</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script9" set="afterDateSet2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-check-other-child-auto-close.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandProcessOtherChildAutoClose</control-param>
                        </control>
                    </field>
                    <field id="reinitExecutorsScript">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-executors.js</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="errands-dnd">
                <field-visibility>
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-document-aspects:attachments-temp-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                            <control-param name="showAttsLabel">false</control-param>
                            <control-param name="showAttsList">false</control-param>
                            <control-param name="autoSubmit">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="resolution-execution-datagrid-expand">
                <field-visibility>
                    <show id="lecm-base-dummy-aspects:script2"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-base-dummy-aspects:script2">
                        <control template="/ru/it/lecm/eds/controls/execution-tree-control.ftl"/>
                    </field>
                </appearance>
            </form>

            <form id="ord-table-structure-info">
                <field-visibility>
                    <show id="ord-item-execution-tree" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="ord-item-execution-tree">
                        <control template="/ru/it/lecm/eds/controls/execution-tree-control.ftl">
                            <control-param name="showFirstLevel">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="doc-right-parts">
                <field-visibility>
                    <show id="fake:document-admin-actions"/>
                    <show id="fake:document-actions"/>
                    <show id="fake:base-doc-actions"/>
                </field-visibility>
                <appearance>
                    <field id="fake:document-admin-actions">
                        <control template="/ru/it/lecm/documents/controls/right-part-dashlet-control.ftl">
                            <control-param name="uri">/lecm/components/document/administration</control-param>
                        </control>
                    </field>
                    <field id="fake:document-actions">
                        <control template="/ru/it/lecm/documents/controls/right-part-dashlet-control.ftl">
                            <control-param name="uri">/lecm/components/dashlets/document-actions</control-param>
                        </control>
                    </field>
                    <field id="fake:base-doc-actions">
                        <control template="/ru/it/lecm/documents/controls/right-part-dashlet-control.ftl">
                            <control-param name="uri">lecm/components/dashlets/base-doc-actions</control-param>
                            <control-param name="baseDocAssocName">lecm-errands:base-assoc</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="navigation-pane">
                <field-visibility>
                    <show id="attributes"/>
                    <show id="exec_reports"/>
                    <show id="execution"/>
                    <show id="attachments"/>
                    <show id="errands"/>
                    <show id="connections"/>
                    <show id="members"/>
                    <show id="tags"/>
                    <show id="history"/>
                    <show id="reports"/>
                    <show id="comments"/>
                </field-visibility>
                <appearance>
                    <field id="attributes">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/attributes-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/form</control-param>
                            <control-param name="nodeLabel">Атрибуты</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_AttrList")</control-param>
                        </control>
                    </field>
                    <field id="exec_reports">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/reports-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/form</control-param>
                            <control-param name="uri_formId">exec_reports</control-param>
                            <control-param name="nodeLabel">Отчеты</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_AttrList")</control-param>
                        </control>
                    </field>
                    <field id="execution">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/execution-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/form</control-param>
                            <control-param name="uri_formId">execution</control-param>
                            <control-param name="nodeLabel">Исполнение</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_AttrList") AND @errandsScript.isHasChildErrandsOrResolutions(doc.getNodeRef().toString())</control-param>
                        </control>
                    </field>
                    <field id="attachments">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/attachments-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/attachments</control-param>
                            <control-param name="uri_baseDocAssocName">lecm-errands:base-assoc</control-param>
                            <control-param name="nodeLabel">Вложения</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_ContentList")</control-param>
                        </control>
                    </field>
                    <field id="errands">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/errands-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/errands</control-param>
                            <control-param name="nodeLabel">Поручения</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_LinksView")</control-param>
                        </control>
                    </field>
                    <field id="connections">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/connections-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/connections-list</control-param>
                            <control-param name="nodeLabel">Связи</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_LinksView")</control-param>
                            <control-param name="uri_excludeType">lecm-errands:document</control-param>
                        </control>
                    </field>
                    <field id="members">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/members-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/members-list</control-param>
                            <control-param name="nodeLabel">Участники документа</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_MemberList")</control-param>
                        </control>
                    </field>
                    <field id="tags">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/tags-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/tags-list</control-param>
                            <control-param name="nodeLabel">Метки</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_TagView")</control-param>
                        </control>
                    </field>
                    <field id="history">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/history-40.png</control-param>
                            <control-param name="uri">/lecm/components/document/history-datagrid</control-param>
                            <control-param name="nodeLabel">История</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_HistoryView")</control-param>
                            <control-param name="uri_showSecondaryCheckBox">true</control-param>
                            <control-param name="uri_hideCollapseButton">false</control-param>
                            <control-param name="uri_dataSource">lecm/business-journal/ds/history</control-param>
                        </control>
                    </field>
                    <field id="reports">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/print-forms-40.png</control-param>
                            <control-param name="nodeLabel">Печатные формы</control-param>
                            <control-param name="uri">/lecm/components/document/forms</control-param>
                        </control>
                    </field>
                    <field id="comments">
                        <control template="/ru/it/lecm/documents/controls/navigation-item-control.ftl">
                            <control-param name="iconSrc">/document-page/comments-40.png</control-param>
                            <control-param name="uri">/lecm/components/comments/list</control-param>
                            <control-param name="nodeLabel">Комментарии</control-param>
                            <control-param name="nodeExpression">user.currentUser().hasPermission(doc.getNodeRef(), "_lecmPerm_CommentView")</control-param>
                            <control-param name="counterUri">/lecm/document/api/getCommentsCount</control-param>
                            <control-param name="uri_activityType">document</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-errands:document">
        <forms>
            <form>
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="limitation-date-script" force="true"/>
                    <show id="lecm-errands:limitation-date-radio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date" />
                    <!-- Периодичность -->
                    <show id="period-dates-script" force="true"/>
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:periodically-radio"/>
                    <show id="lecm-errands:period-end"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-errands:period-during"/>
                    <show id="lecm-errands:period-during-type"/>
                    <show id="lecm-errands:reiteration-count"/>
                    <show id="lecm-base-dummy-aspects:script4" force="true"/>

                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!--  Вложения -->
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                    <!-- Для проверки на черновик -->
                    <show id="lecm-errands:is-short"/>
                    <!-- Ссылки  -->
                    <show id="lecm-errands:links-assoc"/>

                    <show id="lecm-document-aspects:template-name" force="true"/>
                    <show id="lecm-document-aspects:template-ref" force="true"/>

                    <show id="change-errand-type-script" force="true"/>
                    <show id="report-required-handler-script" force="true"/>
                    <show id="errands-create-form-script" force="true"/>
                    <show id="lecm-base-dummy-aspects:script3" force="true"/>

                    <!-- Buttons -->
                    <show id="save-draft-button" force="true"/>
                    <show id="expand-button" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="exist-business-role" template="/ru/it/lecm/errands/controls/errands-choosing-set.ftl" />
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="block2-1" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="block3"  template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="errand-validity" parent="block3" template="/ru/it/lecm/errands/controls/errands-validity-set.ftl"/>
                    <set id="validity-end-date" parent="errand-validity"/>
                    <set id="during" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="repeat" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="block2-2" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="static"/>

                    <field id="lecm-errands:type-assoc" mandatory="true" >
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                            <control-param name="blockChangeItemOnInit">true</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" >
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="changeItemsFireAction">errandTitleChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" >
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" >
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" >
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="exist-business-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:periodically" set="block2-1">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">periodicallyErrandChange</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:reiteration-rule" set="block3">
                        <control template="/ru/it/lecm/errands/controls/errands-reiteration-control.ftl">
                            <control-param name="defaultType">DAILY</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-start" set="errand-validity">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:periodically-radio" set="errand-validity" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATERANGE</control-param>
                            <control-param name="fireChangeEventName">changePeriodEndDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:period-end" label="" set="validity-end-date">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="errand-validity">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.period-endless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-during" label-id="label.errand.during" set="during">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:period-during-type" set="during">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:reiteration-count" label-id="label.errand.endAfter" set="repeat">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="repeat">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.reiterationCount</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:controller-assoc" set="block2-2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-required" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-recipient-type" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:is-important" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>

                    <field id="lecm-document:subject-assoc" set="block2-2">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                        </control>
                    </field>

                    <field id="lecm-document-aspects:attachments-temp-assoc" set="static">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                            <control-param name="categoriesName">["Поручение"]</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:is-short" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-errands:links-assoc" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-name" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-ref" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>

                    <field id="save-draft-button" label-id="label.save-draft">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">saveDraftButtonClick</control-param>
                        </control>
                    </field>
                    <field id="expand-button" label-id="label.show-details">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">expandButtonClick</control-param>
                        </control>
                    </field>

                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                    <field id="period-dates-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/period-dates-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">periodDatesScriptLoaded</control-param>
                            <control-param name="bubblingName">changePeriodEndDateRadio</control-param>
                            <control-param name="startDateField">lecm-errands:period-start</control-param>
                            <control-param name="endDateField">lecm-errands:period-end</control-param>
                            <control-param name="duringCountField">lecm-errands:period-during</control-param>
                            <control-param name="duringTypeField">lecm-errands:period-during-type</control-param>
                            <control-param name="reiterationCountField">lecm-errands:reiteration-count</control-param>
                        </control>
                    </field>
                    <field id="report-required-handler-script" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="errands-create-form-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/components/lecm-errands-create-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsCreateFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script3" set="exist-business-role">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-executors.js</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="document-template-fields">
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>

                </field-visibility>
                <appearance>
                    <field id="lecm-errands:type-assoc" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title">
                        <control
                                template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">
                                /app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений
                            </control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"></control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc">
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:initiator-assoc">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator
                            </control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/base-share/components/controls/relative-date-control.ftl">
                            <control-param name="radioOptions">RELATIVE,ABSOLUTE</control-param>
                            <control-param name="modeOptions">WORK|Рабочих,CALENDAR|Календарных</control-param>
                            <control-param name="minLimitCurrentDate">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:controller-assoc">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required"/>
                    <field id="lecm-errands:is-important">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-document:subject-assoc"/>
                </appearance>
            </form>

            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-errands:is-important"/>
                    <show id="lecm-errands:baseDocString"/>
                    <show id="lecm-errands:number"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:is-expired"/>
                    <show id="lecm-errands:initiator-assoc"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-statemachine:status" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:is-important" label=""/>
                    <field id="lecm-errands:baseDocString" label="" substituteString="{lecm-errands:additional-document-assoc/lecm-document:present-string}"/>
                    <field id="lecm-errands:initiator-assoc"/>
                    <field id="lecm-errands:executor-assoc"/>
                    <field id="lecm-errands:execution-date"/>
                    <field id="lecm-errands:title"/>
                    <field id="lecm-statemachine:status" force="true"/>
                    <field id="lecm-errands:number" label-id="errands.number"/>
                </appearance>
            </form>

            <form id="search">
                <field-visibility>
                    <show id="lecm-errands:number"/>
                    <!--Дата выдачи-->
                    <show id="lecm-errands:wait-for-execution-date"/>
                    <show id="lecm-errands:type-assoc"/>
                    <show id="lecm-errands:initiator-assoc"/>
                    <show id="lecm-document:author-assoc"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:limitation-date"/>
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-errands:is-important"/>
                    <show id="lecm-errands:is-expired"/>
                    <show id="lecm-errands:controller-assoc"/>
                    <show id="lecm-errands:report-required"/>
                    <show id="lecm-errands:base-doc-number"/>
                    <show id="lecm-document:subject-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:number">
                        <control template="/ru/it/lecm/base-share/search/textfield-with-search-options.ftl"/>
                    </field>
                    <field id="lecm-errands:wait-for-execution-date">
                        <control template="/ru/it/lecm/base-share/search/date-with-search-options.ftl"/>
                    </field>
                    <field id="lecm-errands:type-assoc" mandatory="true">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-document:author-assoc" label-id="label.document.creator">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:title">
                        <control template="/ru/it/lecm/base-share/search/textfield-with-search-options.ftl"/>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:executor-assoc">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date">
                        <control template="/ru/it/lecm/base-share/search/date-with-search-options.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" label-id="label.errand.limitless">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">LIMITLESS|Да,DATE|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-important">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-expired">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:controller-assoc">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-required">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:base-doc-number">
                        <control template="/ru/it/lecm/base-share/search/textfield-with-search-options.ftl"/>
                    </field>
                    <field id="lecm-document:subject-assoc">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="workflow-form">
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="limitation-date-script" force="true"/>
                    <show id="lecm-errands:limitation-date-radio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date" />
                    <!-- Периодичность -->
                    <show id="period-dates-script" force="true"/>
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:periodically-radio"/>
                    <show id="lecm-errands:period-end"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-errands:period-during"/>
                    <show id="lecm-errands:period-during-type"/>
                    <show id="lecm-errands:reiteration-count"/>
                    <show id="lecm-base-dummy-aspects:script4" force="true"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!--  Вложения -->
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                    <!-- Для проверки на черновик -->
                    <show id="lecm-errands:is-short"/>
                    <!-- Ссылки  -->
                    <show id="lecm-errands:links-assoc"/>

                    <show id="lecm-document-aspects:template-name" force="true"/>
                    <show id="lecm-document-aspects:template-ref" force="true"/>

                    <show id="change-errand-type-script" force="true"/>
                    <show id="report-required-handler-script" force="true"/>
                    <show id="errands-workflow-form-script" force="true"/>
                    <show id="lecm-base-dummy-aspects:script3" force="true"/>

                    <!-- Buttons -->
                    <show id="save-draft-button" force="true"/>
                    <show id="expand-button" force="true"/>

                    <!-- Ссылка на документ основание  -->
                    <show id="lecm-errands:additional-document-assoc"/>

                    <show id="errands-process-other-auto-close-script" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="exist-business-role" template="/ru/it/lecm/errands/controls/errands-choosing-set.ftl" />
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="block2-1" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="block3"  template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="errand-validity" parent="block3" template="/ru/it/lecm/errands/controls/errands-validity-set.ftl"/>
                    <set id="validity-end-date" parent="errand-validity" />
                    <set id="during" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="repeat" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="block2-2" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="static"/>

                    <field id="lecm-errands:type-assoc" mandatory="true" >
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" >
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="changeItemsFireAction">errandTitleChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" >
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" >
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" >
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="exist-business-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:periodically" set="block2-1">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">periodicallyErrandChange</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:reiteration-rule" set="block3">
                        <control template="/ru/it/lecm/errands/controls/errands-reiteration-control.ftl">
                            <control-param name="defaultType">DAILY</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-start" set="errand-validity">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:periodically-radio" set="errand-validity" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATERANGE</control-param>
                            <control-param name="fireChangeEventName">changePeriodEndDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:period-end" label="" set="validity-end-date">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="errand-validity">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.period-endless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-during" label-id="label.errand.during" set="during">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:period-during-type" set="during">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:reiteration-count" label-id="label.errand.endAfter" set="repeat">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="repeat">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.reiterationCount</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:controller-assoc" set="block2-2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-required" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-recipient-type" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:is-important" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>

                    <field id="lecm-document:subject-assoc" set="block2-2">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                            <control-param name="selectedItemsFormArgs">parentDocSubjectAssoc</control-param>
                        </control>
                    </field>

                    <field id="lecm-document-aspects:attachments-temp-assoc" set="static">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                            <control-param name="categoriesName">["Поручение"]</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:additional-document-assoc">
                        <control template="/ru/it/lecm/errands/controls/additional-document-assoc.ftl">
                            <control-param name="parentDocArg">parentDoc</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-short" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-errands:links-assoc" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-name" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-ref" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>

                    <field id="save-draft-button" label-id="label.save-draft">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">saveDraftButtonClick</control-param>
                        </control>
                    </field>
                    <field id="expand-button" label-id="label.show-details">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">expandButtonClick</control-param>
                        </control>
                    </field>

                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                    <field id="period-dates-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/period-dates-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">periodDatesScriptLoaded</control-param>
                            <control-param name="bubblingName">changePeriodEndDateRadio</control-param>
                            <control-param name="startDateField">lecm-errands:period-start</control-param>
                            <control-param name="endDateField">lecm-errands:period-end</control-param>
                            <control-param name="duringCountField">lecm-errands:period-during</control-param>
                            <control-param name="duringTypeField">lecm-errands:period-during-type</control-param>
                            <control-param name="reiterationCountField">lecm-errands:reiteration-count</control-param>
                        </control>
                    </field>
                    <field id="report-required-handler-script" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="errands-workflow-form-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/components/lecm-errands-create-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsCreateFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script3" set="exist-business-role">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-executors.js</control-param>
                        </control>
                    </field>
                    <field id="errands-process-other-auto-close-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-check-other-child-auto-close.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandProcessOtherChildAutoClose</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="child-errand">
                <field-visibility>
                    <!-- Тип Поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="limitation-date-script" force="true"/>
                    <show id="lecm-errands:limitation-date-radio" />
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date" />
                    <!-- Периодичность -->
                    <show id="period-dates-script" force="true"/>
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:periodically-radio"/>
                    <show id="lecm-errands:period-end"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-errands:period-during"/>
                    <show id="lecm-errands:period-during-type"/>
                    <show id="lecm-errands:reiteration-count"/>
                    <show id="lecm-base-dummy-aspects:script4" force="true"/>

                    <show id="lecm-base-dummy-aspects:script3" force="true"/>
                    <!-- Закрывать вышестоящее поручение -->
                    <show id="lecm-errands:auto-close"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!--  Вложения -->
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                    <!-- Для проверки на черновик -->
                    <show id="lecm-errands:is-short"/>
                    <!-- Ссылки  -->
                    <show id="lecm-errands:links-assoc"/>

                    <show id="lecm-document-aspects:template-name" force="true"/>
                    <show id="lecm-document-aspects:template-ref" force="true"/>

                    <show id="change-errand-type-script" force="true"/>
                    <show id="report-required-handler-script" force="true"/>
                    <show id="errands-workflow-form-script" force="true"/>

                    <!-- Buttons -->
                    <show id="save-draft-button" force="true"/>
                    <show id="expand-button" force="true"/>

                    <!-- Ссылка на документ основание  -->
                    <show id="lecm-errands:additional-document-assoc"/>

                    <show id="errands-process-other-auto-close-script" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="exist-business-role" template="/ru/it/lecm/errands/controls/errands-choosing-set.ftl" />
                    <set id="limitation-date"  template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="block2-1" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="block3"  template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="errand-validity" parent="block3" template="/ru/it/lecm/errands/controls/errands-validity-set.ftl"/>
                    <set id="validity-end-date" parent="errand-validity"/>
                    <set id="during" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="repeat" parent="errand-validity" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="block2-2" template="/ru/it/lecm/base-share/components/hidden-set.ftl"/>
                    <set id="static"/>

                    <field id="lecm-errands:type-assoc" mandatory="true" >
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                        </control>
                    </field>
                    <field id="change-errand-type-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" >
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="changeItemsFireAction">errandTitleChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:content" >
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">8</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" >
                        <control>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                            <control-param name="showSearch">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" >
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:initiator-assoc" set="exist-business-role">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                            <control-param name="changeItemsFireAction">initiatorChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script3" set="exist-business-role">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-executors.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-radio" set="limitation-date"  mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:periodically" set="block2-1">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">periodicallyErrandChange</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:reiteration-rule" set="block3">
                        <control template="/ru/it/lecm/errands/controls/errands-reiteration-control.ftl">
                            <control-param name="defaultType">DAILY</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-start" set="errand-validity">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:periodically-radio" set="errand-validity" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DATERANGE</control-param>
                            <control-param name="fireChangeEventName">changePeriodEndDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                        </constraint-handlers>
                    </field>

                    <field id="lecm-errands:period-end" label="" set="validity-end-date">
                        <control template="/ru/it/lecm/base-share/components/controls/date.ftl">
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="DATE" validation-handler="LogicECM.module.Errands.periodEndDateValidation" message-id="LogicECM.module.Errands.periodEndDateValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="errand-validity">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.period-endless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:period-during" label-id="label.errand.during" set="during">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:period-during-type" set="during">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:reiteration-count" label-id="label.errand.endAfter" set="repeat">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.periodValidation" message-id="Alfresco.forms.validation.mandatory.message" event="change"/>
                            <constraint type="NUMBER" validation-handler="LogicECM.module.Errands.positiveNumberValidation" message-id="LogicECM.module.Errands.positiveNumberValidation.message" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="repeat">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.reiterationCount</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:auto-close" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>
                    <field id="lecm-errands:controller-assoc" set="block2-2">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-required" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl">
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:report-recipient-type" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-errands:is-important" set="block2-2">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl"/>
                    </field>

                    <field id="lecm-document:subject-assoc" set="block2-2">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultSubject</control-param>
                            <control-param name="selectedItemsFormArgs">parentDocSubjectAssoc</control-param>
                        </control>
                    </field>

                    <field id="lecm-document-aspects:attachments-temp-assoc" set="static">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.errands.attachments</control-param>
                            <control-param name="categoriesName">["Поручение"]</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:additional-document-assoc">
                        <control template="/ru/it/lecm/errands/controls/additional-document-assoc.ftl">
                            <control-param name="parentDocArg">parentDoc</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:is-short" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-errands:links-assoc" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-name" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:template-ref" >
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-default-value.ftl"/>
                    </field>

                    <field id="save-draft-button" label-id="label.save-draft">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">saveDraftButtonClick</control-param>
                        </control>
                    </field>
                    <field id="expand-button" label-id="label.show-details">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">expandButtonClick</control-param>
                        </control>
                    </field>

                    <field id="limitation-date-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/complex-date-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">complexDateScriptLoaded</control-param>
                            <control-param name="bubblingName">changeLimitationDateRadio</control-param>
                            <control-param name="dateField">lecm-errands:limitation-date</control-param>
                            <control-param name="daysCountField">lecm-errands:limitation-date-days</control-param>
                            <control-param name="daysTypeField">lecm-errands:limitation-date-type</control-param>
                        </control>
                    </field>
                    <field id="period-dates-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/period-dates-listener.js</control-param>
                            <control-param name="scriptLoadedFireAction">periodDatesScriptLoaded</control-param>
                            <control-param name="bubblingName">changePeriodEndDateRadio</control-param>
                            <control-param name="startDateField">lecm-errands:period-start</control-param>
                            <control-param name="endDateField">lecm-errands:period-end</control-param>
                            <control-param name="duringCountField">lecm-errands:period-during</control-param>
                            <control-param name="duringTypeField">lecm-errands:period-during-type</control-param>
                            <control-param name="reiterationCountField">lecm-errands:reiteration-count</control-param>
                        </control>
                    </field>
                    <field id="report-required-handler-script" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-report-required-handler.js</control-param>
                        </control>
                    </field>
                    <field id="errands-workflow-form-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/components/lecm-errands-create-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandsCreateFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="errands-process-other-auto-close-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-check-other-child-auto-close.js</control-param>
                            <control-param name="scriptLoadedFireAction">errandProcessOtherChildAutoClose</control-param>
                        </control>
                    </field>
                </appearance>
            </form>

            <form id="primary-routing">
                <create-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>
                <edit-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>

                <field-visibility>
                    <!-- Получатель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!--  Типы поручений -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days"/>
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date"/>
                </field-visibility>
                <appearance>
                    <set id="left"/>
                    <set id="right"/>
                    <set id="limitation-date" parent="right" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>

                    <field id="lecm-errands:executor-assoc" set="left" label-id="label.primaryRouting.recipient">
                        <control>
                            <control-param name="changeItemsFireAction">primaryRoutingRecipientChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:type-assoc" set="left" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="left">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint message-id="Alfresco.forms.validation.mandatory.message" type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint message-id="Alfresco.forms.validation.mandatory.message" type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>

            <form id="incoming-default-primary-routing">
                <create-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>
                <edit-form template="/ru/it/lecm/errands/components/primary-routing-form-template.ftl"/>

                <field-visibility>
                    <!-- Получатель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!--  Типы поручений -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days"/>
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date"/>
                </field-visibility>
                <appearance>
                    <set id="left"/>
                    <set id="right"/>
                    <set id="limitation-date" parent="right" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>

                    <field id="lecm-errands:executor-assoc" set="left" label-id="label.primaryRouting.recipient">
                        <control>
                            <control-param name="changeItemsFireAction">primaryRoutingRecipientChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:type-assoc" set="left" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">errandTypeChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="left">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint message-id="Alfresco.forms.validation.mandatory.message" type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint message-id="Alfresco.forms.validation.mandatory.message" type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>

            <form id="from-resolution">
                <field-visibility>
                    <!--  Типы поручений -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days"/>
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                </field-visibility>
                <appearance>
                    <set id="parent" template="/ru/it/lecm/eds/controls/2-column-parent-set.ftl"/>
                    <set id="left" parent="parent"/>
                    <set id="right" parent="parent"/>
                    <set id="limitation-date" parent="right" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="right-end" parent="right"/>

                    <field id="lecm-errands:type-assoc" set="left" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">resolutionErrandTypeChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="left">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:coexecutors-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:controller-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Resolutions.ErrandsExecutionDateValidation" message-id="message.errandExecutionDate.laterResolution" event="keyup"/>
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="maxLimitArg">parentDocLimitationDate</control-param>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Resolutions.ErrandsExecutionDateValidation" message-id="message.errandExecutionDate.laterResolution" event="keyup"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:report-required" set="right-end">
                        <control>
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-recipient-type" set="right-end">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                </appearance>
            </form>

            <form id="from-edit-resolution">
                <field-visibility>
                    <!--  Типы поручений -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Контролер-->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-errands:limitation-date-days"/>
                    <show id="lecm-errands:limitation-date-type"/>
                    <show id="lecm-errands:limitation-date"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                </field-visibility>
                <appearance>
                    <set id="parent" template="/ru/it/lecm/eds/controls/2-column-parent-set.ftl"/>
                    <set id="left" parent="parent"/>
                    <set id="right" parent="parent"/>
                    <set id="limitation-date" parent="right" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="right-end" parent="right"/>

                    <field id="lecm-errands:type-assoc" set="left" mandatory="true">
                        <control>
                            <control-param name="changeItemsFireAction">resolutionEditErrandTypeChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:title" set="left">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-association-autocomplete-text-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Заголовки_x0020_поручений</control-param>
                            <control-param name="itemType">lecm-errands-dic:errand-titles</control-param>
                            <control-param name="nameSubstituteString">{cm:title}</control-param>
                            <control-param name="sortProp">cm:title</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"> </control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="childrenDataSource">lecm/errands/executors/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:controller-assoc" set="left">
                        <control>
                            <control-param name="showSearch">true</control-param>
                            <control-param name="changeItemsFireAction">errandControllerChanged</control-param>
                            <control-param name="childrenDataSource">lecm/employees/DA_CONTROLLERS/picker</control-param>
                        </control>
                    </field>

                    <field id="lecm-errands:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Resolutions.ErrandsExecutionDateValidation" message-id="message.errandExecutionDate.laterResolution" event="keyup"/>
                            <constraint type="REGEX" event="keyup" validation-handler="Alfresco.forms.validation.repoRegexMatch" message-id="message.constraint.number.positive"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-errands:limitation-date" set="limitation-date" mandatory="true">
                        <control>
                            <control-param name="maxLimitArg">parentDocLimitationDate</control-param>
                            <control-param name="minLimitCurrentDate">#{!appSettings.get('lecm.eds.controls.allowPastDate-Errand', false)}</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Errands.limitationDateValidation" event="change"/>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Resolutions.ErrandsExecutionDateValidation" message-id="message.errandExecutionDate.laterResolution" event="keyup"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-errands:report-required" set="right-end">
                        <control>
                            <control-param name="changeFireAction">errandReportRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:report-recipient-type" set="right-end">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                </appearance>
            </form>

            <form id="resolution-execution-datagrid">
                <field-visibility>
                    <show id="lecm-errands:child-index-counter"/>
                    <show id="lecm-errands:type-assoc"/>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:limitation-date-text"/>
                    <show id="lecm-errands:report-required"/>
                    <show id="lecm-statemachine:status" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:limitation-date-text" label-id="label.execution.date"/>
                </appearance>
            </form>

            <form id="statemachine-editable-fields">
                <field-visibility>
                    <!--  Тип поручения -->
                    <show id="lecm-errands:type-assoc"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <!-- Текст поручения -->
                    <show id="lecm-errands:content"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Автор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date-radio"/>
                    <show id="lecm-errands:limitation-date"/>
                    <show id="lecm-errands:limitation-date-days" />
                    <show id="lecm-errands:limitation-date-type"/>
                    <!-- Закрывает вышестоящее поручение -->
                    <show id="lecm-errands:auto-close"/>
                    <!-- Направлять периодически  -->
                    <show id="lecm-errands:periodically"/>
                    <show id="lecm-errands:reiteration-rule"/>
                    <show id="lecm-errands:periodically-radio"/>
                    <show id="lecm-errands:period-start"/>
                    <show id="lecm-errands:period-end"/>
                    <show id="lecm-errands:period-during"/>
                    <show id="lecm-errands:period-during-type"/>
                    <show id="lecm-errands:reiteration-count"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Требуется отчет -->
                    <show id="lecm-errands:report-required"/>
                    <!--Получатель отчета-->
                    <show id="lecm-errands:report-recipient-type"/>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                </field-visibility>
            </form>

            <form id="searchQueryGrid">
                <field-visibility>
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-statemachine:status" force="true"/>
                    <show id="lecm-errands:executor-assoc"/>
                    <show id="lecm-errands:controller-assoc"/>
                    <show id="lecm-errands:initiator-assoc"/>
                </field-visibility>
            </form>

            <form id="search-editor-fields">
                <field-visibility>
                    <!-- Важное -->
                    <show id="lecm-errands:is-important"/>
                    <!-- Статус -->
                    <show id="lecm-statemachine:status" force="true"/>
                    <!-- Инициатор -->
                    <show id="lecm-errands:initiator-assoc"/>
                    <!-- Срок исполнения -->
                    <show id="lecm-errands:limitation-date"/>
                    <!--  Заголовок поручения -->
                    <show id="lecm-errands:title"/>
                    <show id="lecm-errands:number"/>
                    <!-- Исполнитель -->
                    <show id="lecm-errands:executor-assoc"/>
                    <!-- Срок завершения поручения -->
                    <show id="lecm-errands:end-date"/>
                    <!-- Контролер -->
                    <show id="lecm-errands:controller-assoc"/>
                    <!-- Содержание -->
                    <show id="lecm-errands:content"/>
                    <!-- Соисполнители -->
                    <show id="lecm-errands:coexecutors-assoc"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!-- Без утверждения инициатором -->
                    <show id="lecm-errands:without-initiator-approval"/>
                    <!-- Дата исполнения -->
                    <show id="lecm-errands:execution-date"/>
                    <show id="lecm-document:author-assoc"/>
                    <show id="lecm-errands:execution-report"/>

                    <show id="cm:created"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-errands:initiator-assoc">
                        <control>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:author-assoc" label-id="label.creator">
                        <control>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:executor-assoc">
                        <control>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:controller-assoc">
                        <control>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                    </field>
                    <field id="lecm-errands:coexecutors-assoc">
                        <control>
                            <control-param name="additionalFilter"></control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="isShowNotActiveCheckBox">true</control-param>
                            <control-param name="notActiveCheckBoxLabelId">label.control.employees-show-dismissed</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

</alfresco-config>
