<alfresco-config>
    <config>
        <forms>
            <dependencies>
                <js src="/scripts/components/document-component-base.js"/>
                <js src="/scripts/documents/connections/type-select.js"/>
                <js src="/scripts/documents/members/lecm-document-members.js"/>
                <js src="/scripts/grids/doc-members-datagrid.js"/>
            </dependencies>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-connect-types:connection-type">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="lecm-connect-types:reverse-name"/>
                    <show id="lecm-connect-types:code"/>
                </field-visibility>
	            <appearance>
	                <field id="lecm-connect-types:code" read-only="true"/>
	            </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-connect-types:connection-type">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="lecm-connect-types:reverse-name"/>
                    <show id="lecm-connect-types:code"/>
                </field-visibility>
	            <appearance>
		            <field id="lecm-connect-types:code">
			            <control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
			            <constraint-handlers>
				            <constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup" />
			            </constraint-handlers>
		            </field>
	            </appearance>
            </form>

            <form id="datagrid">
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="lecm-connect-types:reverse-name"/>
                    <show id="lecm-connect-types:code"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-connect-types:available-connection-type">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-connect-types:primary-document-type"/>
                    <show id="lecm-connect-types:connected-document-type"/>
                    <show id="lecm-connect-types:available-connection-types-assoc"/>
                    <show id="lecm-connect-types:default-connection-type-assoc"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-connect-types:available-connection-type">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-connect-types:primary-document-type"/>
                    <show id="lecm-connect-types:connected-document-type"/>
                    <show id="lecm-connect-types:available-connection-types-assoc"/>
                    <show id="lecm-connect-types:default-connection-type-assoc"/>
                </field-visibility>
            </form>

            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-connect-types:primary-document-type"/>
                    <show id="lecm-connect-types:connected-document-type"/>
                    <show id="lecm-connect-types:available-connection-types-assoc"/>
                    <show id="lecm-connect-types:default-connection-type-assoc"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-connect:connection">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-connect:primary-document-assoc"/>
                    <show id="lecm-connect:connected-document-assoc"/>
                    <show id="lecm-connect:connection-type-assoc"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-connect:connection">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-connect:primary-document-assoc"/>
                    <show id="lecm-connect:connected-document-assoc"/>
                    <show id="lecm-connect:connection-type-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-connect:primary-document-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-connect:connected-document-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-search-control.ftl">
                            <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:Documents</control-param>
                            <control-param name="nameSubstituteString">{lecm-document:present-string}&lt;/br&gt;{lecm-document:list-present-string}</control-param>
                            <control-param name="selectedItemsNameSubstituteString">{lecm-document:present-string}</control-param>
	                        <control-param name="changeItemsFireAction">changeConnectedDocument</control-param>
                        </control>
                    </field>
                    <field id="lecm-connect:connection-type-assoc">
                        <control template="/ru/it/lecm/documents/controls/connections/select-types.ftl">
                            <control-param name="startLocation">
                                /app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Типы_x0020_связи
                            </control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="notSelectedOptionShow">true</control-param>
                            <control-param name="notSelectedOptionLabel"></control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-doc-members:member">
        <forms>
            <form>
                <field-visibility>
                    <!--<show id="lecm-doc-members:group"/>-->
                    <show id="lecm-doc-members:employee-assoc"/>
                </field-visibility>
                <!--<appearance>
                    <field id="lecm-doc-members:group">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-webscript-values.ftl">
                            <control-param name="webscriptType">server</control-param>
                            <control-param name="webscript">/lecm/statemachine/editor/privileges</control-param>
                            <control-param name="withEmpty">true</control-param>
                        </control>
                    </field>
                </appearance>-->
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-doc-members:member-fio" force="true"/>
                    <show id="lecm-doc-members:member-position" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-doc-members:member-fio" substituteString="$includeRef{lecm-doc-members:employee-assoc/lecm-orgstr:employee-last-name} {lecm-doc-members:employee-assoc/lecm-orgstr:employee-first-name} {lecm-doc-members:employee-assoc/lecm-orgstr:employee-middle-name}"/>
                    <field id="lecm-doc-members:member-position" substituteString="{lecm-doc-members:employee-assoc/..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}"/>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-doc-members:member">
        <forms>
            <form>
                <field-visibility>
                    <!--<show id="lecm-doc-members:group"/>-->
                    <show id="lecm-doc-members:employee-assoc"/>
                </field-visibility>
            </form>
        </forms>
    </config>

	<config evaluator="model-type" condition="cm:content">
		<forms>
			<form id="attachments-dashlet-table">
				<field-visibility>
					<show id="cm:image"/>
					<show id="cm:name"/>
					<show id="lecm-document:creator"/>
					<show id="cm:versionLabel"/>
				</field-visibility>
				<appearance>
					<field id="cm:image" label=" "/>
					<field id="cm:name" label-id="label.attachmets.file.name"/>
					<field id="lecm-document:creator" label-id="label.attachmets.autor"/>
					<field id="cm:versionLabel" label-id="label.attachmets.version"/>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="model-type" condition="lecm-document:base">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="cm:image"/>
                    <show id="lecm-document:present-string"/>
                    <show id="lecm-document:list-present-string"/>
                </field-visibility>
                <appearance>
                    <field id="cm:image" label=" "/>
                    <field id="cm:name" label=" "/>
                    <field id="lecm-document:present-string" label=" "/>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="DocumentLibrary">
        <metadata-templates>
            <template id="baseDocument">
                <evaluator>evaluator.ru.it.lecm.documents.isBase</evaluator>
                <line index="10" id="list-present" view="detailed">{list-present}</line>
                <line index="20" id="date">{date}</line>
                <line index="30" id="tags" view="detailed">{tags}</line>
            </template>
        </metadata-templates>
    </config>

    <config evaluator="string-compare" condition="DocLibCustom">
        <dependencies>
            <js src="/scripts/lecm-documents/contracts-renderers-register.js"/>
            <js src="/scripts/lecm-documents/lecm-doc-list-overrride.js"/>
        </dependencies>
    </config>
</alfresco-config>