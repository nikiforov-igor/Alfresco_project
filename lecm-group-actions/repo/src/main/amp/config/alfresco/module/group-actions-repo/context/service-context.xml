<?xml version='1.0' encoding='UTF-8'?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<bean id="groupActions.modelBootstrap" parent="dictionaryModelBootstrap">
		<property name="models">
			<list>
				<value>alfresco/module/${artifactId}/models/lecm-group-actions-model.xml</value>
			</list>
		</property>
		<property name="labels">
			<list>
				<value>alfresco/module/${artifactId}/messages/group-actions</value>
			</list>
		</property>
	</bean>

    <util:constant id="GA_ROOT_ID" static-field="ru.it.lecm.actions.bean.GroupActionsService.GA_ROOT_ID"/>
    <util:constant id="GA_ROOT_NAME" static-field="ru.it.lecm.actions.bean.GroupActionsService.GA_ROOT_NAME"/>

    <bean id="groupActionsService" parent="baseBean"
		  class="ru.it.lecm.actions.bean.GroupActionsServiceImpl"
		  depends-on="groupActions.modelBootstrap, statemachineEditor.editorModelBootstrap">
        <property name="dictionaryService" ref="dictionaryService"/>
        <property name="repositoryStructureHelper" ref="repositoryStructureHelper" />
        <!--<property name="stateMachineService"  ref="stateMachineHelper"/>-->
        <property name="namespaceService" ref="namespaceService"/>
        <property name="documentService" ref="documentService"/>
        <property name="lecmPermissionService" ref="lecmPermissionServiceBean"/>
        <!-- Автоматическое создание каталогов. -->
        <property name="folders">
            <map>
                <entry key="#{GA_ROOT_ID}" value="#{GA_ROOT_NAME}"/>
            </map>
        </property>
        <property name="aspects">
            <list/>
        </property>
    </bean>

    <bean id="groupActionsScript" parent="baseScript" class="ru.it.lecm.actions.script.GroupActionsScript">
        <property name="extensionName">
            <value>groupActions</value>
        </property>
        <property name="actionsService" ref="groupActionsService"/>
        <property name="documentService" ref="documentService"/>
        <property name="dictionaryService" ref="dictionaryService"/>
        <property name="namespaceService" ref="namespaceService"/>
    </bean>

    <bean id="webscript.ru.it.lecm.actions.action.exec.post"
          class="ru.it.lecm.actions.script.GroupActionExecutor"
          parent="webscript">
        <property name="nodeService" ref="nodeService"/>
        <property name="actionsService" ref="groupActionsService"/>
        <property name="serviceRegistry"  ref="ServiceRegistry"/>
        <property name="transactionService" ref="transactionService"/>
        <property name="lecmTransactionHelper" ref="lecmTransactionHelper"/>
        <property name="substitudeBean" ref="substitudeService"/>
    </bean>

    <bean id="groupActions.exportSettingsInitializer" parent="dictionary.exportSettingsInitializer" class="ru.it.lecm.dictionary.beans.ExportSettingsInitializerBean">
        <constructor-arg>
            <map>
                <entry key="lecm-group-actions:script-action">
                    <list>
                        <value>cm:name</value>
                        <value>cm:title</value>
                        <value>lecm-group-actions:expression</value>
                        <value>lecm-group-actions:type</value>
                        <value>lecm-group-actions:statuses</value>
                        <value>lecm-group-actions:isGroup</value>
                        <value>lecm-group-actions:availableForReader</value>
                        <value>lecm-group-actions:forCollection</value>
                        <value>lecm-group-actions:order</value>
                        <value>lecm-group-actions:script</value>
                    </list>
                </entry>
                <entry key="lecm-group-actions:form-field">
                    <list>
                        <value>cm:name</value>
                        <value>lecm-group-actions:field-id</value>
                        <value>lecm-group-actions:field-type</value>
                        <value>lecm-group-actions:field-priority</value>
                        <value>lecm-group-actions:field-default-value</value>
                        <value>lecm-group-actions:field-is-mandatory</value>
                    </list>
                </entry>
                <entry key="lecm-group-actions:workflow-action">
                    <list>
                        <value>cm:name</value>
                        <value>cm:title</value>
                        <value>lecm-group-actions:expression</value>
                        <value>lecm-group-actions:type</value>
                        <value>lecm-group-actions:statuses</value>
                        <value>lecm-group-actions:isGroup</value>
                        <value>lecm-group-actions:availableForReader</value>
                        <value>lecm-group-actions:order</value>
                        <value>lecm-group-actions:workflow</value>
                    </list>
                </entry>
                <entry key="lecm-group-actions:document-action">
                    <list>
                        <value>cm:name</value>
                        <value>cm:title</value>
                        <value>lecm-group-actions:expression</value>
                        <value>lecm-group-actions:type</value>
                        <value>lecm-group-actions:statuses</value>
                        <value>lecm-group-actions:order</value>
                        <value>lecm-group-actions:availableForReader</value>
                        <value>lecm-group-actions:document-type</value>
                        <value>lecm-group-actions:document-connection</value>
                        <value>lecm-group-actions:document-connection-system</value>
                        <value>lecm-group-actions:document-autofill-enabled</value>
                    </list>
                </entry>
            </map>
        </constructor-arg>
    </bean>

    <bean id="${groupId}.${artifactId}.groupOperations" parent="ServiceFolderPermissionHelper">
        <property name="serviceBean" ref="groupActionsService"/>
        <property name="permissionsList">
            <list>
                <value>alfresco/module/${artifactId}/permissions/directories-permissions.xml</value>
            </list>
        </property>
    </bean>
</beans>