<?xml version="1.0" encoding="UTF-8"?>
<!--
	Договорная деятельность.

Фильтры отчета:
•	Период 
•	Контрагент
•	Актуальные/все
•	Сумма
•	Вид договора
•	Тематика договора

Выходные данные отчета:
•	Номер договора
•	(A) Контрагент
•	(A) Вид договора

•	(A) Тематика договора
•	(!) Статус договора
•	Дата начала действия договора
•	Дата завершения действия договора
•	(!) Исполнитель

  -->

<ds.config>
    <report.descriptor mnem="contracts-list">
        <type mnem="JASPER"/>
        <l18>
            <item key="RU_RU" value="Договорная деятельность"/>
        </l18>
        <provider mnem="DSProviderReestrDogovorov" javaClass="ru.it.lecm.reports.jasper.DSProviderReestrDogovorov" >
           <l18>
               <item key="RU_RU" value="Провайдер Jasper отчётов: Договорная деятельность"/>
           </l18>
        </provider>
        <template filename="contracts-list.jrxml"/>
        <datasource.descriptor mnem="datasource-approval">
            <l18>
                <item key="RU_RU" value="81a7ffa8-7fe4-4df6-8556-e11e77fd0727"/>
            </l18>
        </datasource.descriptor>
    </report.descriptor>

	<query.descriptor>
		<offset>0</offset>
		<limit>-1</limit>
		<pgsize>-1</pgsize>
		<allVersions>true</allVersions>
		<preferedType>{lecm-contract:document}</preferedType>
		<isMultiRow>true</isMultiRow>
		<isCustom>true</isCustom>
		<!--
			select * from lecm:documents
			select * from lecm-contract:document as Contract
		  -->
		<queryText>	<![CDATA[]]> </queryText>
	</query.descriptor>

	<!-- параметры соединения с Альфреско (пока не используются) -->
	<cmis.connection>
		<url>http://localhost:8080/alfresco/service/cmis</url>
		<username>admin</username>
		<password>111</password>
	</cmis.connection>


	<fields>
		<field queryFldName="lecm-contract:regNumSystem"
				jrFldName="col_Regnum"
				displayName="Регистрационный номер договора" javaValueClass="String"/>

		<field jrFldName="col_numContragent" queryFldName="lecm-contract:regNumContractor" displayName="Регистрационный номер контрагента" />

		<!-- Данные по контрагенту (с типом "lecm-contractor:contractor-type") 
			в виде "а-ля форматной" строки
		  -->
		<field jrFldName="col_Contragent.name"  queryFldName="{lecm-contract:partner-assoc/lecm-contractor:shortname}" displayName="Контрагент"/>
		<field jrFldName="col_Contragent.phone" queryFldName="{lecm-contract:partner-assoc/lecm-contractor:phone}" displayName="Тел Контрагента" />

		<!-- Данные по "Виду договора" (с типом "lecm-contract-dic:contract-type") -->
		<field jrFldName="col_DocKind" queryFldName="{lecm-contract:typeContract-assoc/cm:name}" displayName="Вид договора" />

		<!-- Данные по "Тематика договора" (с типом "lecm-contract-dic:contract-subjects") -->
		<field jrFldName="col_Theme.code" queryFldName="{lecm-contract:subjectContract-assoc/lecm-contract-dic:contract-subjects-code}" displayName="Тематика.Код" />
		<field jrFldName="col_Theme.tname" queryFldName="{lecm-contract:subjectContract-assoc/cm:name}" displayName="Тематика.Название" />
		<field jrFldName="col_Theme.desc" queryFldName="{lecm-contract:subjectContract-assoc/lecm-contract-dic:contract-subjects-description}" displayName="Тематика.Описание" />

		<!-- Статус -->
		<field jrFldName="col_Status" queryFldName="lecm-statemachine:status" displayName="Статус" />

		<!-- Дата изменения статуса -->
		<field jrFldName="col_StatusDate" queryFldName="lecm-document:status-changed-date" displayName="Дата смены статус"
				javaValueClass="java.util.Date"/>

		<field jrFldName="col_DateStart" queryFldName="lecm-contract:startDate" displayName="Дата начала действия договора"
				javaValueClass="java.util.Date"/>

		<field jrFldName="col_DateEnd" queryFldName="lecm-contract:endDate" displayName="Дата окончания действия договора"
				javaValueClass="java.util.Date"/>

		<!-- Создатель договора -->
		<field jrFldName="col_Creator" queryFldName="lecm-document:creator-ref" displayName="Создатель договора" />

		<!--Представители (типа "lecm-representative:representative-type")
			Фамилия Имя Отчество и Должность
		  -->
		<field jrFldName="col_Executor_Family" queryFldName="{lecm-contract:representative-assoc/lecm-representative:surname}" displayName="Исполнитель.Фамилия" />
		<field jrFldName="col_Executor_Name" queryFldName="{lecm-contract:representative-assoc/lecm-representative:firstname}" displayName="Исполнитель.Имя" />
		<field jrFldName="col_Executor_Otchestvo" queryFldName="{lecm-contract:representative-assoc/lecm-representative:middlename}" displayName="Исполнитель.Отчество" />
		<field jrFldName="col_Executor_Staff" queryFldName="{lecm-contract:representative-assoc/lecm-representative:rank}" displayName="Исполнитель.Должность" />

		<!--
			<field queryFldName="fmydata" dislayName="" javaValueClass="my.check.type"/>
		  -->
	</fields>

</ds.config>
