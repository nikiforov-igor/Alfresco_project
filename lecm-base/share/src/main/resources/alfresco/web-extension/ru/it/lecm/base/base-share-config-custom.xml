<alfresco-config>
    <!--Ридер для кастомного корневого элемента типов полей-->
    <plug-ins>
      <element-readers>
         <element-reader element-name="field-types" class="ru.it.lecm.base.formsConfig.elements.fieldsElement.FieldTypesReader"/>
         <element-reader element-name="forms-info" class="ru.it.lecm.base.formsConfig.elements.formsInfoElement.FormsInfoElementReader"/>
      </element-readers>
   </plug-ins>

    <config>
        <forms>
	        <default-controls>
		        <!--Переопределённые базовые контролы-->
		        <!--Переопределяются только контролы с параметрами, потому что параметры затираются (баг в alfresco)-->
		        <type name="datetime" template="/ru/it/lecm/base-share/components/controls/date.ftl">
			        <control-param name="showTime">true</control-param>
		        </type>
                <type name="date" template="/ru/it/lecm/base-share/components/controls/date.ftl" />

                <type name="date-range" template="/org/alfresco/components/form/controls/daterange.ftl"/>
                <type name="int-range" template="/org/alfresco/components/form/controls/numberrange.ftl"/>
                <type name="float-range" template="/org/alfresco/components/form/controls/numberrange.ftl"/>
                <type name="double-range" template="/org/alfresco/components/form/controls/numberrange.ftl"/>
                <type name="long-range" template="/org/alfresco/components/form/controls/numberrange.ftl"/>

		        <!--Контролы оргструктуры-->
		        <type name="association:lecm-orgstr:organization-unit" template="/ru/it/lecm/base-share/components/controls/association-tree-picker.ftl">
			        <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
			        <control-param name="nameSubstituteString">{lecm-orgstr:element-short-name}</control-param>
			        <control-param name="treeNodeSubstituteString">{lecm-orgstr:element-short-name}</control-param>
			        <control-param name="treeNodeTitleSubstituteString">{cm:name}</control-param>
			        <control-param name="plane">false</control-param>
			        <control-param name="showCreateNewLink">false</control-param>
			        <control-param name="showCreateNewButton">false</control-param>
			        <control-param name="showSelectedItemsPath">false</control-param>
		        </type>
		        <type name="association:lecm-orgstr:staff-list" template="/ru/it/lecm/base-share/components/controls/association-tree-picker.ftl">
			        <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
			        <control-param name="nameSubstituteString">{lecm-orgstr:element-member-position-assoc/cm:name} {lecm-orgstr:element-member-employee-assoc/lecm-orgstr:employee-link-employee-assoc/cm:name}</control-param>
			        <control-param name="selectedItemsNameSubstituteString">{lecm-orgstr:element-member-position-assoc/cm:name} {../lecm-orgstr:element-short-name} {lecm-orgstr:element-member-employee-assoc/lecm-orgstr:employee-link-employee-assoc/cm:name}</control-param>
			        <control-param name="treeNodeSubstituteString">{lecm-orgstr:element-short-name}</control-param>
			        <control-param name="treeNodeTitleSubstituteString">{cm:name}</control-param>
			        <control-param name="treeItemType">lecm-orgstr:organization-unit</control-param>
			        <control-param name="plane">false</control-param>
			        <control-param name="showCreateNewLink">false</control-param>
			        <control-param name="showCreateNewButton">false</control-param>
			        <control-param name="showSelectedItemsPath">false</control-param>
			        <control-param name="showSearch">false</control-param>
		        </type>
		        <type name="association:lecm-orgstr:workGroup" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
			        <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
			        <control-param name="nameSubstituteString">{cm:name}</control-param>
			        <control-param name="showCreateNewLink">false</control-param>
			        <control-param name="showCreateNewButton">false</control-param>
		        </type>
		        <type name="association:lecm-orgstr:employee" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
			        <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
			        <control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
			        <control-param name="showCreateNewLink">false</control-param>
			        <control-param name="showCreateNewButton">false</control-param>
                    <control-param name="employeeAbsenceMarker">true</control-param>
		        </type>
		        <type name="association:lecm-orgstr:workRole" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
			        <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Роли_x0020_для_x0020_рабочих_x0020_групп</control-param>
			        <control-param name="nameSubstituteString">{cm:name}</control-param>
			        <control-param name="showCreateNewLink">false</control-param>
			        <control-param name="showCreateNewButton">false</control-param>
		        </type>
                <type name="association:lecm-orgstr-docType:documentType" template="/ru/it/lecm/base-share/components/controls/association-tree-picker.ftl">
                    <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Виды_x0020_документов</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="plane">true</control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                </type>
                <type name="association:lecm-busjournal:objectType" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                    <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Тип_x0020_объекта</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                </type>
                <type name="association:lecm-busjournal:eventCategory" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                    <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Категория_x0020_события</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                </type>

		        <!--Контролы уведомлений/подписок-->
		        <type name="association:lecm-notf-type:notification-type" template="/ru/it/lecm/base-share/components/controls/association-checkboxes-control.ftl">
			        <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Типы_x0020_доставки_x0020_уведомлений</control-param>
			        <control-param name="nameSubstituteString">{cm:name}</control-param>
			        <control-param name="defaultValuesDataSource">lecm/notifications/getDefaultChannels</control-param>
		        </type>

		        <!--Контролы связей документов-->
		        <type name="association:lecm-connect-types:connection-type" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
			        <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Типы_x0020_связи</control-param>
			        <control-param name="nameSubstituteString">{cm:name}</control-param>
			        <control-param name="showCreateNewLink">false</control-param>
			        <control-param name="showCreateNewButton">false</control-param>
                </type>
	        </default-controls>

            <dependencies>
                <!-- CSS-файлы подключать в этом файле: -->
                <css src="/css/lecm-base/base-styles.css" />
                <js src="/scripts/lecm-base/components/lecm-toolbar.js" />
                <js src="/scripts/lecm-base/components/object-finder/lecm-object-finder.js" />
                <js src="/scripts/lecm-base/components/lecm-association-selectone.js" />
                <js src="/scripts/lecm-base/components/lecm-association-cascading-selectone.js" />
                <js src="/scripts/lecm-base/components/lecm-association-autocomplete.js" />
                <js src="/scripts/lecm-base/components/lecm-validation.js" />
                <js src="/scripts/lecm-base/components/lecm-date-display.js" />
                <js src="/scripts/lecm-base/components/lecm-fillproperties.js" />
                <js src="/scripts/lecm-base/components/association-tree/association-tree-view.js" />
				<js src="/scripts/lecm-base/components/base-utils.js" />
				<js src="/scripts/lecm-base/components/lecm-selectone.js" />
				<js src="/scripts/lecm-base/components/lecm-datagrid.js" />
				<js src="/scripts/lecm-base/components/lecm-datagrid-association.js" />
				<js src="/scripts/lecm-base/components/lecm-association-datagrid-control.js" />
				<js src="/scripts/lecm-base/components/advsearch.js" />
                <js src="/yui/resize/resize.js" />
                <js src="/yui/tabview/tabview.js" />
	            <js src="/scripts/lecm-base/components/lecm-association-checkboxes.js" />
	            <js src="/scripts/lecm-base/components/lecm-association-search.js" />
                <js src="/scripts/lecm-base/components/lecm-rich-text.js" />
                <js src="/scripts/lecm-base/components/lecm-datarange.js" />
	            <js src="/scripts/lecm-base/components/lecm-uploader-control.js" />
	            <js src="/components/upload/html-upload.js" />
	            <js src="/components/upload/file-upload.js" />
	            <js src="/components/upload/flash-upload.js" />
                <js src="/jquery/jquery-1.6.2.js"/>
                <js src="/modules/simple-dialog.js"/>
	            <js src="/scripts/lecm-base/components/lecm-checkbox.js" />
	            <js src="/scripts/lecm-base/components/lecm-association-autocomplete-text.js" />
	            <js src="/scripts/lecm-base/components/lecm-dnd-uploader-control.js" />
	            <js src="/scripts/lecm-base/components/lecm-dnd-uploader.js" />
	            <js src="/scripts/lecm-base/components/lecm-dnd-upload.js" />
	            <js src="/scripts/lecm-base/components/lecm-uploader-initializer.js" />
	            <js src="/scripts/lecm-base/components/activiti-transitions-radiobuttons.js" />
                <js src="/scripts/lecm-base/components/lecm-date-picker.js" />
	            <js src="/scripts/lecm-base/components/lecm-uploader-with-preview-control.js" />
                <js src="/scripts/lecm-base/components/binder.js" />
	            <js src="/scripts/lecm-base/components/lecm-association-create-control.js" />
	            <js src="/scripts/lecm-base/components/lecm-text-checkboxes-control.js" />
	            <js src="/scripts/lecm-base/components/lecm-reassign-task-control.js" />
	            <js src="/scripts/lecm-base/constraints/current-date-limit-validator.js" />
	            <js src="/scripts/lecm-base/constraints/regex-color-validator.js" />
				<js src="/scripts/knockout.min.js" />

	            <!--Web preview-->
	            <js src="/components/preview/web-preview.js" />
	            <js src="/components/preview/WebPreviewer.js" />
	            <js src="/js/flash/extMouseWheel.js" />
	            <js src="/components/preview/FlashFox.js" />
	            <js src="/components/preview/StrobeMediaPlayback.js" />
	            <js src="/components/preview/Video.js" />
	            <js src="/components/preview/Audio.js" />
	            <js src="/components/preview/Flash.js" />
	            <js src="/components/preview/Image.js" />
	            <js src="/extras/components/preview/web-preview-extend.js" />
	            <js src="/extras/components/preview/PdfJs.js" />
	            <js src="/extras/components/preview/Embed.js" />
	            <js src="/extras/components/preview/pdfjs/compatibility.js" />
	            <js src="/extras/components/preview/pdfjs/pdf.js" />
	            <js src="/extras/components/preview/spin.js" />
            </dependencies>

            <constraint-handlers>
                <constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup" />
            </constraint-handlers>

        </forms>
    </config>

	<config evaluator="model-type" condition="bpm:startTask">
		<forms>
			<form id="reassignTask">
				<field-visibility>
					<show id="cm:owner" force="true"/>
					<show id="taskIds" force="true"/>
				</field-visibility>
				<appearance>
					<field id="cm:owner" label="Сотрудник" mandatory="true">
						<control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
							<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="employeeAbsenceMarker">true</control-param>
							<control-param name="itemType">lecm-orgstr:employee</control-param>
						</control>
					</field>
					<field id="taskIds" label="Сотрудник" mandatory="false">
						<control template="/ru/it/lecm/base-share/components/controls/lecm-arguments-hidden-control.ftl">
							<control-param name="argName">taskIds</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>
</alfresco-config>