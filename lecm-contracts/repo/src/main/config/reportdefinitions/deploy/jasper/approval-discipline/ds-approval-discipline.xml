<?xml version="1.0" encoding="UTF-8"?>
<!--
Фильтры отчета по 10.5.2 "Исполнительская дисциплина по согласованиям за период":
Входные параметры:
•	Период 

Выходные данные отчета:
•	ФИО Сотрудника
•	Должность сотрудника
•	Отдел
	Количество просроченных согласований
•	Средний срок согласования
•	Ср просрочка
  -->

<ds.config>
    <report.descriptor mnem="approval-discipline">
        <type mnem="JASPER"/>
        <l18>
            <item key="RU_RU" value="Исполнительская дисциплина по согласованиям за период"/>
        </l18>
        <provider mnem="DSProdiverApprovalSummaryByPeriod" javaClass="ru.it.lecm.contracts.reports.DSProdiverApprovalSummaryByPeriod" >
           <l18>
               <item key="RU_RU" value="Провайдер Jasper отчётов: Дисциплина согласований за период"/>
           </l18>
        </provider>
        <template filename="approval-discipline.jrxml"/>
    </report.descriptor>

	<query.descriptor>
		<offset>0</offset>
		<limit>-1</limit>
		<pgsize>-1</pgsize>
		<allVersions>true</allVersions>
		<preferedType>{lecm-contract:document}</preferedType>
		<isMultiRow>true</isMultiRow>
		<isCustom>false</isCustom>
        <queryText><![CDATA[]]></queryText>
	</query.descriptor>

	<cmis.connection>
		<url>http://localhost:8080/alfresco/service/cmis</url>
		<username>admin</username>
	</cmis.connection>

	<fields>
        <!-- параметры -->
		<!-- Период - начало и конец -->
		<field queryFldName="{lecm-al:approval-list-approve-start}" jrFldName="periodDate" displayName="Период" javaValueClass="java.util.Date" alfrescoType="d:date">
            <parameter mnem="PARAM_TYPE_RANGE" paramType="PARAM_TYPE_RANGE">
                <l18>
                    <item key="RU_RU" value="Диапазон"/>
                </l18>
                <label1>
                    <item key="RU_RU" value="Начало отсчета"/>
                </label1>
                <label2>
                    <item key="RU_RU" value="Конец отсчета"/>
                </label2>
            </parameter>
        </field>

        <field queryFldName="lecm-al:approval-list" jrFldName="TYPE" displayName="Тип" javaValueClass="java.lang.String"/>

        <field queryFldName="{period.start}" jrFldName="col_Period.Start" displayName="Начало периода" javaValueClass="java.util.Date"/>
        <field queryFldName="{period.end}" jrFldName="col_Period.End" displayName="Конец периода" javaValueClass="java.util.Date"/>

        <!-- данные в отчете -->
		<!-- Фамилия И.О. Сотрудника-->
		<field queryFldName="{lecm-al:approval-list-contains-approval-item/lecm-al:approval-item-employee-assoc/lecm-orgstr:employee-short-name}"
				jrFldName="col_Employee"
				displayName="Сотрудник" javaValueClass="java.lang.String"/>

		<!-- Должность Сотрудника (!) вычисляемое -->
		<field queryFldName="{col_Employee.StaffPosition}"
				jrFldName="col_Employee.StaffPosition"
				displayName="Должность Сотрудника" javaValueClass="java.lang.String"/>

		<!-- Отдел Сотрудника (!) вычисляемое -->
		<field queryFldName="{col_Employee.Unit}"
				jrFldName="col_Employee.Unit"
				displayName="Отдел Сотрудника" javaValueClass="java.lang.String"/>

		<!-- Кол-во просроченных согласований (!) вычисляемое -->
		<field queryFldName="{col_Employee.MissedApproves}"
				jrFldName="col_Employee.MissedApproves"
				displayName="Кол-во просроченных согласований" javaValueClass="java.lang.Integer"/>

		<!-- Средний срок согласований, дней (!) вычисляемое -->
		<field queryFldName="{col_Employee.AvgApproved}"
				jrFldName="col_Employee.AvgApproved"
				displayName="Средний срок согласований, дней" javaValueClass="java.lang.Float"/>

		<!-- Средний срок просрочки, дней (!) вычисляемое -->
		<field queryFldName="{col_Employee.AvgMissed}"
				jrFldName="col_Employee.AvgMissed"
				displayName="Средний срок просрочки, дней" javaValueClass="java.lang.Float"/>
	</fields>
</ds.config>
