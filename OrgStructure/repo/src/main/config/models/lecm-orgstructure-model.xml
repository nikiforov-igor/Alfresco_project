<?xml version="1.0" encoding="UTF-8"?>

<model name="lecm-orgstr:organizationStructure" xmlns="http://www.alfresco.org/model/dictionary/1.0">
    <description>Orgstructure Model</description>
    <author>DBashmakov</author>
    <version>1.0</version>
    <imports>
        <import uri="http://www.alfresco.org/model/dictionary/1.0" prefix="d"/>
        <import uri="http://www.alfresco.org/model/content/1.0" prefix="cm"/>
    </imports>

    <namespaces>
        <namespace uri="http://www.it.ru/lecm/org/structure/1.0" prefix="lecm-orgstr"/>
    </namespaces>

    <types>
        <!-- Абстрактные модели -->
        <!-- Описание ресурса проекта -->
        <type name="lecm-orgstr:project_resource">
            <title>Project Resource</title>
            <parent>cm:object</parent>
            <properties>
                <property name="lecm-orgstr_project_resource_title">
                    <title>Title</title>
                    <type>d:text</type>
                </property>
            </properties>
        </type>

        <!-- Описание организационной единицы -->
        <type name="lecm-orgstr:organization_element">
            <title>Organization Element</title>
            <parent>cm:folder</parent>
            <properties>
                <property name="lecm-orgstr:element_full_name">
                    <title>Full Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:element_short_name">
                    <title>Short Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
            </properties>
            <associations>
                <association name="lecm-orgstr:element_official_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:official</class>
                        <mandatory>true</mandatory>
                        <many>true</many>
                    </target>
                </association>
            </associations>
        </type>

        <!-- Описание моделей -->
        <!-- Описание организации -->
        <type name="lecm-orgstructure:organization">
            <title>Organization</title>
            <parent>lecm-orgstr:organization_element</parent>
            <properties>
                <property name="lecm-orgstr:org_leg_address">
                    <title>Legal Address</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:org_act_address">
                    <title>Actual Address</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:org_off_site">
                    <title>Official Site</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:org_phone">
                    <title>Phone numbers</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:org_fax">
                    <title>Fax numbers</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:org_email">
                    <title>E-mails</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:org_logo">
                    <title>Logo</title>
                    <type>d:any</type>
                </property>
                <property name="lecm-orgstr:org_tin">
                    <title>TIN</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:org_ownership_type">
                    <title>Type of ownership</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:org_incorporation_form">
                    <title>Form of incorporation</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:org_founding_docs">
                    <title>Information about the founding documents</title>
                    <type>d:text</type>
                </property>
            </properties>
            <associations>
                <!-- Связь со структурными подразделениями -->
                <child-association name="lecm-orgstr:org_unit_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:organization_unit</class>
                        <mandatory>true</mandatory>
                        <many>true</many>
                    </target>
                </child-association>

<!--                &lt;!&ndash; Связь с сотрудниками &ndash;&gt;
                <child-association name="lecm-orgstr:org_employees_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:employee_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>

                &lt;!&ndash;  Связь с персональной датой &ndash;&gt;
                <child-association name="lecm-orgstr:org_personal_data_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:personal_data_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>

                &lt;!&ndash; Связь с офисами &ndash;&gt;
                <child-association name="lecm-orgstr:org_office_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:office_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>

                &lt;!&ndash; Связь с должностными лицами &ndash;&gt;
                <child-association name="lecm-orgstr:org_official_container_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:official_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>

                &lt;!&ndash; Связь с проектами &ndash;&gt;
                <child-association name="lecm-orgstr:org_projects_container_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:projects_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>

                &lt;!&ndash; Связь с трудовыми ресурсами &ndash;&gt;
                <child-association name="lecm-orgstr:org_workforce_container_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:workforce_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>

                &lt;!&ndash; Связь с реестром проектов &ndash;&gt;
                <child-association name="lecm-orgstr:org_project_register_container_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:project_register_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>

                &lt;!&ndash; Связь со штатным расписанием &ndash;&gt;
                <child-association name="lecm-orgstr:org_staff_list_container_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:staff_list_container</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>-->
            </associations>
        </type>

        <!-- Папки объектов. DO NOT MODIFY -->

        <type name="lecm-orgstr:employee_container">
            <title>Employees Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:personal_data_container">
            <title>Personal Data Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:office_container">
            <title>Offices Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:job_position_container">
            <title>Job Position Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:official_container">
            <title>Official Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:projects_container">
            <title>Projects Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:workforce_container">
            <title>Workforce Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:project_register_container">
            <title>Project Register Directory</title>
            <parent>cm:folder</parent>
        </type>

        <type name="lecm-orgstr:staff_list_container">
            <title>Staff List Directory</title>
            <parent>cm:folder</parent>
            <properties>
                <property name="lecm-orgstr:staff_list_approval_date">
                    <type>d:date</type>
                </property>
            </properties>
        </type>

        <!-- Структурное подразделение -->
        <type name="lecm-orgstr:organization_unit">
            <title>Organization Unit</title>
            <parent>lecm-orgstr:organization_element</parent>
            <properties>
                <property name="lecm-orgstr:unit_code">
                    <title>Code</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:unit_type">
                    <title>Type</title>
                    <type>d:text</type>
                    <constraints>
                        <constraint type="LIST">
                            <parameter name="allowedValues">
                                <list>
                                    <value>Separated</value>
                                    <value>Segregated</value>
                                </list>
                            </parameter>
                        </constraint>
                    </constraints>
                </property>
                <property name="lecm-orgstr:unit_exist">
                    <title>Is exist</title>
                    <type>d:boolean</type>
                    <default>true</default>
                </property>
            </properties>
            <associations>
                <!-- Связь с офисами -->
                <association name="lecm-orgstr:unit_offices_assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:office</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </association>

                <!-- Связь с реестром проектов-->
                <association name="lecm-orgstr:unit_register_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:project_register</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </association>

                <!-- Связь с составом -->
                <association name="lecm-orgstr:unit_composition_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:unit_composition</class>
                        <mandatory>true</mandatory>
                        <many>true</many>
                    </target>
                </association>

                <!-- Связь с подструктурными подразделениями -->
                <child-association name="lecm-orgstr:unit_inner_assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:organization_unit</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </child-association>
            </associations>
        </type>

        <!-- Сотрудник организации -->
        <type name="lecm-orgstr:employee">
            <title>Еmployee</title>
            <parent>cm:cmobject</parent>
            <properties>
                <property name="lecm-orgstr:employee_first_name">
                    <title>First Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:employee_middle_name">
                    <title>Middle Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:employee_last_name">
                    <title>Last Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:employee_sex">
                    <title>Sex</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <constraints>
                        <constraint type="LIST">
                            <parameter name="allowedValues">
                                <list>
                                    <value>Male</value>
                                    <value>Female</value>
                                </list>
                            </parameter>
                        </constraint>
                    </constraints>
                </property>
                <property name="lecm-orgstr:employee_phone">
                    <title>Phone Number</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:employee_photo">
                    <title>Photo</title>
                    <type>d:any</type>
                </property>
                <property name="lecm-orgstr:employee_number">
                    <title>Employee number</title>
                    <type>d:long</type>
                </property>
                <property name="lecm-orgstr:employee_fio_g">
                    <title>Full name in genitive</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:employee_fio_d">
                    <title>Full name in dative</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:employee_login">
                    <title>Login</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:employee_is_system_user">
                    <title>Is System User</title>
                    <type>d:boolean</type>
                    <default>false</default>
                </property>
            </properties>
            <associations>
                <!-- Связь с учетной записью в системе -->
                <association name="lecm-orgstr:employee_person_assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:person</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>

                <!--  Связь с персональными данными -->
                <child-association name="lecm-orgstr:employee_person_data_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:personal_data</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </child-association>
            </associations>
        </type>

        <!-- Должностное лицо -->
        <type name="lecm-orgstr:official">
            <title>Official</title>
            <parent>cm:object</parent>
            <properties>
                <property name="lecm-orgstr:official_can_facsimile">
                    <title>Can use a facsimile</title>
                    <type>d:boolean</type>
                </property>
            </properties>
            <associations>
                <!-- Связь с сотрудником -->
                <association name="lecm-orgstr:official_employee_assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:employee</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>
        </type>

        <!-- Должность -->
        <type name="lecm-orgstr:position">
            <title>Position</title>
            <parent>cm:object</parent>
            <properties>
                <property name="lecm-orgstr:position_name">
                    <title>Title</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:position_description">
                    <title>Description</title>
                    <type>d:any</type>
                </property>
                <property name="lecm-orgstr:position_name_g">
                    <title>Name in genitive</title>
                    <type>d:boolean</type>
                </property>
                <property name="lecm-orgstr:position_name_d">
                    <title>Name in dative</title>
                    <type>d:boolean</type>
                </property>
            </properties>
        </type>

        <!-- Офис организации -->
        <type name="lecm-orgstr:office">
            <title>Office</title>
            <parent>cm:object</parent>
            <properties>
                <property name="lecm-orgstr:office_full_name">
                    <title>Full Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:office_short_name">
                    <title>Short Name</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:office_phone">
                    <title>Phone</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:office_fax">
                    <title>Fax</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:office_address">
                    <title>Address</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:office_transit_scheme">
                    <title>Transit Scheme</title>
                    <type>d:any</type>
                </property>
            </properties>
        </type>

       <!-- Персональные данные -->
        <type name="lecm-orgstr:personal_data">
            <title>Personal Data</title>
            <parent>cm:object</parent>
            <properties>
                <property name="lecm_orgstr:person_data_address">
                    <title>Person Address</title>
                    <type>d:text</type>
                </property>
                <property name="lecm_orgstr:person_data_email">
                    <title>Person E-Mail</title>
                    <type>d:text</type>
                </property>
                <property name="lecm_orgstr:person_data_phone">
                    <title>Person Phone</title>
                    <type>d:text</type>
                </property>
                <property name="lecm_orgstr:person_data_date">
                    <title>Person Birthday</title>
                    <type>d:date</type>
                </property>
                <property name="lecm_orgstr:person_data_service_id">
                    <title>Person Messaging service ID</title>
                    <type>d:text</type>
                </property>
            </properties>
        </type>

        <!-- Проект -->
        <type name="lecm-orgstr:project">
            <title>Project</title>
            <parent>lecm-ogrstr:organization_element</parent>
            <properties>
                <property name="lecm-orgstr:project_target">
                    <title>Project Targets</title>
                    <type>d:text</type>
                </property>
                <property name="lecm-orgstr:project_schedule">
                    <title>Project schedule</title>
                    <type>d:text</type>
                </property>
            </properties>
            <associations>
                <!-- Список участников проекта -->
                <association name="lecm-orgstr:project_workforce_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:workforce</class>
                        <mandatory>true</mandatory>
                        <many>true</many>
                    </target>
                </association>
            </associations>
        </type>

        <!-- Реестр проектов -->
        <type name="lecm-orgstr:project_register">
            <title>Project Register</title>
            <parent>cm:object</parent>
            <properties>
                <property name="lecm-orgstr:project_register_name">
                    <title>Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
            </properties>
            <associations>
                <!-- Связь с реестром проектов -->
                <association name="lecm-orgstr:project_register_projects_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:project</class>
                        <mandatory>true</mandatory>
                        <many>true</many>
                    </target>
                </association>
            </associations>
        </type>

        <!-- Участник (трудовой ресурс) -->
        <type name="lecm-orgstr:workforce">
            <title>Workforce</title>
            <parent>lecm-orgstr:project_resource</parent>
            <properties>
                <property name="lecm-orgstr:workforce_name">
                    <title>Name</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:workforce_role">
                    <title>Role</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
            </properties>
            <associations>
                <!-- Связь с сотрудником -->
                <association name="lecm-orgstr:workforce_employee_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:employee</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>
        </type>

        <!-- Состав подразделения -->
        <type name="lecm-orgstr:unit_composition">
            <title>Unit Composition</title>
            <parent>cm:object</parent>
            <properties>
                <property name="lecm-orgstr:composition_code">
                    <title>Code</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-orgstr:composition_is_boss">
                    <title>Employee Is Boss</title>
                    <type>d:boolean</type>
                    <default>false</default>
                </property>
            </properties>
            <associations>
                <!-- Связь с должностью -->
                <association name="lecm-orgstr:composition_position_assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:position</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </association>

                <!-- Связь с сотрудником -->
                <association name="lecm-orgstr:composition_employee_assoc">
                    <source>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:employee</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </association>
            </associations>
        </type>
    </types>
</model>