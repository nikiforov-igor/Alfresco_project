<?xml version="1.0" encoding="UTF-8"?>

<model name="lecm-busjournal:businessJournalModel" xmlns="http://www.alfresco.org/model/dictionary/1.0">
    <description>Business Journal Model</description>
    <author>DBashmakov</author>
    <version>1.0</version>
    <imports>
        <import uri="http://www.alfresco.org/model/dictionary/1.0" prefix="d"/>
        <import uri="http://www.alfresco.org/model/content/1.0" prefix="cm"/>
        <import uri="http://www.it.ru/lecm/dictionary/1.0" prefix="lecm-dic"/>
        <import uri="http://www.it.ru/lecm/org/structure/1.0" prefix="lecm-orgstr"/>
    </imports>

    <namespaces>
        <namespace uri="http://www.it.ru/logicECM/business-journal/1.0" prefix="lecm-busjournal"/>
    </namespaces>

    <types>
        <!-- Справочники -->
        <!-- Тип объекта-->
        <type name="lecm-busjournal:objectType">
            <title>Object Type</title>
            <parent>lecm-dic:plane_dictionary_values</parent>
            <properties>
                <property name="lecm-busjournal:objectType-code">
                    <title>Code</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:objectType-class">
                    <title>Class</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:objectType-template">
                    <title>Template</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:objectType-list-template">
                    <title>List Template</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
            </properties>
            <mandatory-aspects>
                <aspect>lecm-dic:aspect_active</aspect>
            </mandatory-aspects>
        </type>

        <!-- Категория событий-->
        <type name="lecm-busjournal:eventCategory">
            <title>Event category</title>
            <parent>lecm-dic:plane_dictionary_values</parent>
            <properties>
                <property name="lecm-busjournal:eventCategory-code">
                    <title>Code</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
            <property name="lecm-busjournal:eventCategory-on">
                    <title>On</title>
                    <type>d:boolean</type>
                    <mandatory>true</mandatory>
                    <default>true</default>
                </property>
            </properties>
            <mandatory-aspects>
                <aspect>lecm-dic:aspect_active</aspect>
            </mandatory-aspects>
        </type>

        <!-- Шаблон сообщения-->
        <type name="lecm-busjournal:messageTemplate">
            <title>Message Template</title>
            <parent>lecm-dic:plane_dictionary_values</parent>
            <properties>
                <property name="lecm-busjournal:messageTemplate-template">
                    <title>Template</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:messageTemplate-code">
                    <title>Code</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:messageTemplate-objType-assoc-ref">
                    <title>Type Ref</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:messageTemplate-evCategory-assoc-ref">
                    <title>Category Ref</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
            </properties>
            <associations>
                <!--Ссылка на тип объекьа -->
                <association name="lecm-busjournal:messageTemplate-objType-assoc">
                    <title>Object Type</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-busjournal:objectType</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <!--Ссылка на категорию события -->
                <association name="lecm-busjournal:messageTemplate-evCategory-assoc">
                    <title>Event Category</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-busjournal:eventCategory</class>
                        <mandatory>true</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>
            <mandatory-aspects>
                <aspect>lecm-dic:aspect_active</aspect>
            </mandatory-aspects>
        </type>

        <!-- Запись бизнес-журнала-->
        <type name="lecm-busjournal:bjRecord">
            <title>Business Journal record</title>
            <parent>cm:content</parent>
            <properties>
                <property name="lecm-busjournal:bjRecord-date">
                    <title>Date</title>
                    <type>d:datetime</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-description">
                    <title>Description</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-initiator">
                    <title>Initiator</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-mainObject">
                    <title>Main Object</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj1">
                    <title>Secondary Object 1</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj2">
                    <title>Secondary Object 2</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj3">
                    <title>Secondary Object 3</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj4">
                    <title>Secondary Object 4</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj5">
                    <title>Secondary Object 5</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-initiator-assoc-ref">
                    <title>Initiator Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-mainObject-assoc-ref">
                    <title>Main Object Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-evCategory-assoc-ref">
                    <title>Event Category Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-objType-assoc-ref">
                    <title>Object Type Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj1-assoc-ref">
                    <title>Secondary Object 1 Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj2-assoc-ref">
                    <title>Secondary Object 2 Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj3-assoc-ref">
                    <title>Secondary Object 3 Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj4-assoc-ref">
                    <title>Secondary Object 4 Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj5-assoc-ref">
                    <title>Secondary Object 5 Ref</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-initiator-assoc-text-content">
                    <title>Initiator</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-mainObject-assoc-text-content">
                    <title>Main Object</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-evCategory-assoc-text-content">
                    <title>Event Category</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-objType-assoc-text-content">
                    <title>Object Type</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj1-assoc-text-content">
                    <title>Secondary Object 1</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj2-assoc-text-content">
                    <title>Secondary Object 2</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj3-assoc-text-content">
                    <title>Secondary Object 3</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj4-assoc-text-content">
                    <title>Secondary Object 4</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
                <property name="lecm-busjournal:bjRecord-secondaryObj5-assoc-text-content">
                    <title>Secondary Object 5</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>both</tokenised>
                    </index>
                </property>
            </properties>
            <associations>
                <association name="lecm-busjournal:bjRecord-initiator-assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-orgstr:employee</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-mainObject-assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:cmobject</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-evCategory-assoc">
                    <title>Event Category</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-busjournal:eventCategory</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-objType-assoc">
                    <title>Object Type</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>lecm-busjournal:objectType</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-secondaryObj1-assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:cmobject</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-secondaryObj2-assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:cmobject</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-secondaryObj3-assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:cmobject</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-secondaryObj4-assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:cmobject</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="lecm-busjournal:bjRecord-secondaryObj5-assoc">
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:cmobject</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>
            <mandatory-aspects>
                <aspect>lecm-dic:aspect_active</aspect>
            </mandatory-aspects>
        </type>

        <type name="lecm-busjournal:archiverSettings">
            <title>Archiver Settings</title>
            <parent>cm:cmobject</parent>
            <properties>
                <property name="lecm-busjournal:archiver-deep">
                    <title>Archive Deep</title>
                    <type>d:int</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="lecm-busjournal:archiver-period">
                    <title>Period</title>
                    <type>d:int</type>
                    <mandatory>true</mandatory>
                </property>
            </properties>
        </type>
    </types>
</model>