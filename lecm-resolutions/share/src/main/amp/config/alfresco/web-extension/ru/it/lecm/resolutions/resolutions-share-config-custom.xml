<alfresco-config>
    <config>
        <forms>
            <dependencies>
                <js src="/scripts/lecm-resolution/constraints/resolutions-constraints.js"/>
            </dependencies>

            <default-controls>
                <type name="association:lecm-resolutions-dic:completion-methods" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
                    <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Способы_x0020_завершения_x0020_резолюции</control-param>
                    <control-param name="plane">true</control-param>
                </type>
            </default-controls>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-resolutions:document">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-base-dummy-aspects:script9" force="true"/>

                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                    <show id="lecm-base-dummy-aspects:script8" force="true"/>
                    <show id="lecm-resolutions:closers"/>

                    <show id="lecm-base-dummy-aspects:script4" force="true"/>
                    <show id="lecm-resolutions:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-resolutions:limitation-date-days"/>
                    <show id="lecm-resolutions:limitation-date-type"/>
                    <show id="lecm-resolutions:limitation-date"/>

                    <show id="lecm-resolutions:errands-json"/>
                    <show id="lecm-base-dummy-aspects:script5" force="true"/>
                    <show id="lecm-base-dummy-aspects:script7" force="true"/>
                    <show id="lecm-base-dummy-aspects:script6" force="true"/>

                    <show id="lecm-resolutions:reviewers-assoc"/>

                    <show id="lecm-resolutions:is-draft"/>
                    <show id="lecm-resolutions:base-assoc"/>
                    <show id="lecm-resolutions:base-document-assoc"/>
                    <show id="lecm-resolutions:base-doc-execution-date-attr-name"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-base-dummy-aspects:script3" force="true"/>
                    <show id="lecm-base-dummy-aspects:script4" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="start"/>
                    <set id="start-2-column" template="/ru/it/lecm/eds/controls/2-column-parent-set.ftl"/>
                    <set id="start-left" parent="start-2-column"/>
                    <set id="start-right" parent="start-2-column"/>
                    <set id="start-right-start" parent="start-right"/>
                    <set id="limitation-date" parent="start-right" label-id="label.limitation-date" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="errands"/>
                    <set id="reviewers-hidden" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="reviewers-fieldset" parent="reviewers-hidden" appearance="fieldset" label-id="label.review"/>
                    <set id="reviewers" parent="reviewers-fieldset" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="end"/>

                    <field id="lecm-base-dummy-aspects:script9" set="start">
                        <control template="/ru/it/lecm/resolutions/controls/resolution-base-doc-control.ftl">
                            <control-param name="documentArgName">assoc_lecm-resolutions_base-document-assoc</control-param>
                            <control-param name="formatString">
                                <![CDATA[На основании документа <a target='_blank' href='/share/page/document?nodeRef={nodeRef}'>{lecm-document:present-string}</a>]]>
                            </control-param>
                        </control>
                    </field>
                    <field id="lecm-document:subject-assoc" set="start-left"/>
                    <field id="lecm-resolutions:author-assoc" set="start-left">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/errands/getDefaultInitiator</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:controller-assoc" set="start-left">
                        <control>
                            <control-param name="changeItemsFireAction">resolutionControllerChanged</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.controllerValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script8" set="start-left" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-resolution/resolution-change-controller.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:closers" set="start-left">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-resolutions:control" set="start-right-start">
                        <control>
                            <control-param name="fireMandatoryByChange">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="start-right-start" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-resolution/resolutions-change-limitation-date.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="defaultValue">DAYS</control-param>
                            <control-param name="fireChangeEventName">changeResolutionLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-resolutions:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-resolutions:limitation-date" set="limitation-date"  mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>

                    <field id="lecm-resolutions:errands-json" label-id="field.primaryRouting.errands.title" set="errands">
                        <control template="/ru/it/lecm/eds/controls/multi-form-control.ftl">
                            <control-param name="availableRemoveDefault">true</control-param>
                            <control-param name="documentType">lecm-errands:document</control-param>
                            <control-param name="documentFromId">from-resolution</control-param>
                            <control-param name="submitFireEvent">sendResolution</control-param>
                            <control-param name="argsConfig"><![CDATA[{
                                    "assoc_lecm-resolutions_controller-assoc": "assoc_lecm-errands_controller-assoc",
                                    "prop_lecm-resolutions_limitation-date-radio": "prop_lecm-errands_limitation-date-radio",
                                    "prop_lecm-resolutions_limitation-date-days": "prop_lecm-errands_limitation-date-days",
                                    "prop_lecm-resolutions_limitation-date-type": "prop_lecm-errands_limitation-date-type",
                                    "prop_lecm-resolutions_limitation-date": "prop_lecm-errands_limitation-date"
                                }]]></control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script5" set="errands">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script7" set="errands">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-change-limitation-date.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script6" set="errands">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-change-controller-handler.js</control-param>
                        </control>
                    </field>

                    <field id="lecm-resolutions:reviewers-assoc" set="reviewers">
                        <control template="/ru/it/lecm/base-share/components/controls/association-complex-control.ftl">
                            <control-param name="items">employee,orgUnit,workGroup,reviewItem</control-param>
                            <!-- lecm-orgstr:employee -->
                            <control-param name="employee_label">Сотрудник</control-param>
                            <control-param name="employee_endpointType">lecm-orgstr:employee</control-param>
                            <control-param name="employee_endpointMany">true</control-param>
                            <control-param name="employee_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="employee_nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
                            <control-param name="employee_plane">true</control-param>
                            <control-param name="employee_showSearch">true</control-param>
                            <control-param name="employee_useStrictFilterByOrg">true</control-param>
                            <control-param name="employee_sortProp">lecm-orgstr:employee-short-name</control-param>
                            <!-- lecm-orgstr:organization-unit -->
                            <control-param name="orgUnit_label">Подразделение</control-param>
                            <control-param name="orgUnit_endpointType">lecm-orgstr:organization-unit</control-param>
                            <control-param name="orgUnit_endpointMany">true</control-param>
                            <control-param name="orgUnit_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура/cm:Холдинг</control-param>
                            <control-param name="orgUnit_nameSubstituteString">{lecm-orgstr:element-short-name}</control-param>
                            <control-param name="orgUnit_plane">false</control-param>
                            <control-param name="orgUnit_showSearch">true</control-param>
                            <control-param name="orgUnit_sortProp">lecm-orgstr:element-short-name</control-param>
                            <!-- lecm-orgstr:workGroup -->
                            <control-param name="workGroup_label">Рабочая группа</control-param>
                            <control-param name="workGroup_endpointType">lecm-orgstr:workGroup</control-param>
                            <control-param name="workGroup_endpointMany">true</control-param>
                            <control-param name="workGroup_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
                            <control-param name="workGroup_nameSubstituteString">{cm:name}</control-param>
                            <control-param name="workGroup_plane">true</control-param>
                            <control-param name="workGroup_showSearch">true</control-param>
                            <control-param name="workGroup_sortProp">lecm-orgstr:element-short-name</control-param>
                            <!-- lecm-review-list:review-list-item -->
                            <control-param name="reviewItem_label">Список ознакомления</control-param>
                            <control-param name="reviewItem_endpointType">lecm-review-list:review-list-item</control-param>
                            <control-param name="reviewItem_endpointMany">true</control-param>
                            <control-param name="reviewItem_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Списки_x0020_ознакомления</control-param>
                            <control-param name="reviewItem_nameSubstituteString">{cm:title}</control-param>
                            <control-param name="reviewItem_plane">true</control-param>
                            <control-param name="reviewItem_showSearch">true</control-param>
                            <control-param name="reviewItem_childrenDataSource">lecm/review/ds/allowedReviewLists</control-param>
                            <control-param name="reviewItem_sortProp">cm:title</control-param>
                        </control>
                    </field>

                    <field id="lecm-resolutions:is-draft" set="end">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-resolutions:base-assoc" set="end">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-resolutions:base-document-assoc" set="end">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecm-resolutions:base-doc-execution-date-attr-name" set="end">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="end">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-resolution/lecm-resolution-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">resolutionFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script3" label-id="label.route-errand" set="end">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">sendResolutionButtonClick</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" label-id="label.save-draft" set="end">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">saveDraftResolutionButtonClick</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="document-template-fields">
                <field-visibility>
                    <show id="lecm-resolutions:number"/>
                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                    <show id="lecm-resolutions:limitation-date"/>
                    <show id="lecm-resolutions:reviewers-assoc"/>
                </field-visibility>
            </form>

            <!-- Форма с набором полей, редактируемых в машине состояний -->
            <form id="statemachine-editable-fields">
                <field-visibility>
                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                    <show id="lecm-resolutions:closers"/>

                    <show id="lecm-resolutions:limitation-date-radio"/>
                    <show id="lecm-resolutions:limitation-date-days"/>
                    <show id="lecm-resolutions:limitation-date-type"/>
                    <show id="lecm-resolutions:limitation-date"/>

                    <show id="lecm-resolutions:errands-json"/>

                    <show id="lecm-resolutions:reviewers-assoc"/>

                    <show id="lecm-resolutions:base-assoc"/>
                    <show id="lecm-resolutions:base-document-assoc"/>
                    <show id="lecm-review-aspects:related-review-records-assoc"/>
                </field-visibility>
            </form>

            <!-- Форма атрибутивного поиска -->
            <form id="search">
                <field-visibility>
                    <show id="lecm-resolutions:number"/>
                    <show id="lecm-resolutions:transition-to-execution-date"/>
                    <show id="lecm-resolutions:limitation-date"/>
                    <show id="lecm-resolutions:limitation-date-radio"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-document:author-assoc"/>
                    <show id="lecm-resolutions:is-expired"/>
                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                </field-visibility>

                <appearance>
                    <set id="block1"/>
                    <set id="two-column" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="block2"/>

                    <field id="lecm-resolutions:number" set="block1">
                        <control>
                            <control-param name="hideValue"/>
                        </control>
                    </field>
                    <field id="lecm-resolutions:transition-to-execution-date" set="block1">
                        <control template="/ru/it/lecm/base-share/components/controls/daterange-control.ftl"/>
                    </field>
                    <field id="lecm-resolutions:limitation-date" set="block1">
                        <control template="/ru/it/lecm/base-share/components/controls/daterange-control.ftl"/>
                    </field>
                    <field id="lecm-resolutions:limitation-date-radio" set="block1">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">LIMITLESS|Без срока,*|Все</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:author-assoc" set="block1">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-document:author-assoc" label-id="label.document.creator" set="block1">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-resolutions:is-expired" set="two-column">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:control" set="two-column">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-empty.ftl">
                            <control-param name="options">true|Да,false|Нет</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:controller-assoc" set="block2">
                        <control>
                            <control-param name="endpointMany">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="searchQueryGrid">
                <field-visibility>
                    <show id="lecm-resolutions:number"/>
                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                    <show id="lecm-resolutions:limitation-date"/>
                    <show id="lecm-resolutions:reviewers-assoc"/>
                </field-visibility>
            </form>
            <form id="search-editor-fields">
                <field-visibility>
                    <show id="lecm-resolutions:number"/>
                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                    <show id="lecm-resolutions:limitation-date"/>
                    <show id="lecm-resolutions:reviewers-assoc"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-resolutions:document">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-resolutions:base-document-assoc"/>
                    <show id="lecm-resolutions:base-assoc"/>

                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-document:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>

                    <show id="lecm-resolutions:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-resolutions:limitation-date"/>

                    <show id="lecm-resolutions:errands-json" force="true"/>

                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-resolutions:reviewers-assoc"/>
                    <show id="lecm-review-aspects:related-review-records-assoc" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="limitation-date" label-id="label.limitation-date" template="/ru/it/lecm/errands/controls/errands-view-limitation-date-set.ftl"/>

                    <set id="execution" appearance="title" label-id="label.execution"/>
                    <set id="reviewers-hidden" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="reviewers" parent="reviewers-hidden" appearance="title" label-id="label.review"/>
                    <set id="reviewers-list-hidden" parent="reviewers" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="reviewers-table-hidden" parent="reviewers" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>

                    <field id="lecm-base-dummy-aspects:script2">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-resolution/lecm-view-resolution-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">resolutionViewFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:base-document-assoc" read-only="true">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:base-assoc" read-only="true">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:author-assoc" label-id="label.resolution.creator"/>

                    <field id="lecm-resolutions:limitation-date-radio" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="options">DATE,LIMITLESS</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:limitation-date" set="limitation-date"  mandatory="true"/>

                    <field id="lecm-resolutions:errands-json" set="execution">
                        <control template="/ru/it/lecm/resolutions/controls/resolution-execution-datagrid-control.ftl">
                            <control-param name="datagridFormId">resolution-execution-datagrid</control-param>
                            <control-param name="expandFormId">resolution-execution-datagrid-expand</control-param>
                        </control>
                    </field>

                    <field id="lecm-resolutions:reviewers-assoc" set="reviewers-list-hidden">
                        <control template="/ru/it/lecm/base-share/components/controls/association-complex-control.ftl">
                            <control-param name="items">employee,orgUnit,workGroup,reviewItem</control-param>
                            <!-- lecm-orgstr:employee -->
                            <control-param name="employee_label">Сотрудник</control-param>
                            <control-param name="employee_endpointType">lecm-orgstr:employee</control-param>
                            <control-param name="employee_endpointMany">true</control-param>
                            <control-param name="employee_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="employee_nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
                            <control-param name="employee_plane">true</control-param>
                            <control-param name="employee_showSearch">true</control-param>
                            <control-param name="employee_useStrictFilterByOrg">true</control-param>
                            <control-param name="employee_sortProp">lecm-orgstr:employee-short-name</control-param>
                            <!-- lecm-orgstr:organization-unit -->
                            <control-param name="orgUnit_label">Подразделение</control-param>
                            <control-param name="orgUnit_endpointType">lecm-orgstr:organization-unit</control-param>
                            <control-param name="orgUnit_endpointMany">true</control-param>
                            <control-param name="orgUnit_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура/cm:Холдинг</control-param>
                            <control-param name="orgUnit_nameSubstituteString">{lecm-orgstr:element-short-name}</control-param>
                            <control-param name="orgUnit_plane">false</control-param>
                            <control-param name="orgUnit_showSearch">true</control-param>
                            <control-param name="orgUnit_sortProp">lecm-orgstr:element-short-name</control-param>
                            <!-- lecm-orgstr:workGroup -->
                            <control-param name="workGroup_label">Рабочая группа</control-param>
                            <control-param name="workGroup_endpointType">lecm-orgstr:workGroup</control-param>
                            <control-param name="workGroup_endpointMany">true</control-param>
                            <control-param name="workGroup_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
                            <control-param name="workGroup_nameSubstituteString">{cm:name}</control-param>
                            <control-param name="workGroup_plane">true</control-param>
                            <control-param name="workGroup_showSearch">true</control-param>
                            <control-param name="workGroup_sortProp">lecm-orgstr:element-short-name</control-param>
                            <!-- lecm-review-list:review-list-item -->
                            <control-param name="reviewItem_label">Список ознакомления</control-param>
                            <control-param name="reviewItem_endpointType">lecm-review-list:review-list-item</control-param>
                            <control-param name="reviewItem_endpointMany">true</control-param>
                            <control-param name="reviewItem_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Списки_x0020_ознакомления</control-param>
                            <control-param name="reviewItem_nameSubstituteString">{cm:title}</control-param>
                            <control-param name="reviewItem_plane">true</control-param>
                            <control-param name="reviewItem_showSearch">true</control-param>
                            <control-param name="reviewItem_childrenDataSource">lecm/review/ds/allowedReviewLists</control-param>
                            <control-param name="reviewItem_sortProp">cm:title</control-param>
                        </control>
                    </field>
                    <field id="lecm-review-aspects:related-review-records-assoc" set="reviewers-table-hidden">
                        <control template="/ru/it/lecm/workflow/review/controls/related-review-list-datagrid-control.ftl">
                            <control-param name="attributeForShow">lecm-document:indexTableRow</control-param>
                            <control-param name="datagridFormId">datagrid</control-param>
                            <control-param name="isTableSortable">false</control-param>
                            <control-param name="editable">true</control-param>
                            <control-param name="forceEditable">true</control-param>
                            <control-param name="showCreateBtn">false</control-param>
                            <control-param name="allowCreate">false</control-param>
                            <control-param name="allowEdit">false</control-param>
                            <control-param name="allowDelete">false</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="editForm">
                <field-visibility>
                    <show id="lecm-resolutions:base-document-assoc"/>

                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                    <show id="lecm-base-dummy-aspects:script8" force="true"/>
                    <show id="lecm-resolutions:closers"/>

                    <show id="lecm-base-dummy-aspects:script4" force="true"/>
                    <show id="lecm-resolutions:limitation-date-radio"/>
                    <show id="lecm-base-dummy-aspects:script" force="true"/>
                    <show id="lecm-resolutions:limitation-date-days"/>
                    <show id="lecm-resolutions:limitation-date-type"/>
                    <show id="lecm-resolutions:limitation-date"/>

                    <show id="lecm-resolutions:errands-json"/>
                    <show id="lecm-base-dummy-aspects:script5" force="true"/>
                    <show id="lecm-base-dummy-aspects:script7" force="true"/>
                    <show id="lecm-base-dummy-aspects:script6" force="true"/>

                    <show id="lecm-resolutions:reviewers-assoc"/>

                    <show id="lecm-resolutions:base-doc-execution-date-attr-name"/>
                    <show id="lecm-base-dummy-aspects:script2" force="true"/>
                    <show id="lecm-base-dummy-aspects:script3" force="true"/>
                </field-visibility>
                <appearance>
                    <set id="start"/>
                    <set id="start-2-column" template="/ru/it/lecm/eds/controls/2-column-parent-set.ftl"/>
                    <set id="start-left" parent="start-2-column"/>
                    <set id="start-right" parent="start-2-column"/>
                    <set id="start-right-start" parent="start-right"/>
                    <set id="limitation-date" parent="start-right" label-id="label.limitation-date" template="/ru/it/lecm/errands/controls/errands-limitation-date-set.ftl"/>
                    <set id="errands"/>
                    <set id="reviewers-hidden" template="/ru/it/lecm/eds/controls/hidden-set.ftl"/>
                    <set id="reviewers-fieldset" parent="reviewers-hidden" appearance="fieldset" label-id="label.review"/>
                    <set id="reviewers" parent="reviewers-fieldset" template="/org/alfresco/components/form/2-column-set.ftl"/>
                    <set id="end"/>

                    <field id="lecm-resolutions:base-document-assoc" read-only="true" set="start">
                        <control>
                            <control-param name="viewUrl">document?nodeRef={nodeRef}</control-param>
                        </control>
                    </field>
                    <field id="lecm-document:subject-assoc" set="start-left"/>
                    <field id="lecm-resolutions:author-assoc" set="start-left"/>
                    <field id="lecm-resolutions:controller-assoc" set="start-left">
                        <control>
                            <control-param name="changeItemsFireAction">resolutionControllerChanged</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.controllerValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script8" set="start-left" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-resolution/resolution-change-controller.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:closers" set="start-left">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>

                    <field id="lecm-resolutions:control" set="start-right-start">
                        <control>
                            <control-param name="fireMandatoryByChange">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script4" set="start-right-start" >
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-resolution/resolutions-change-limitation-date.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:limitation-date-radio" set="limitation-date" mandatory="true">
                        <control template="/ru/it/lecm/eds/controls/selectone-radiobuttons.ftl">
                            <control-param name="fireChangeEventName">changeResolutionLimitationDateRadio</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-base-dummy-aspects:script" set="limitation-date">
                        <control template="/ru/it/lecm/eds/controls/static-text-control.ftl">
                            <control-param name="textCode">label.errand.limitless</control-param>
                        </control>
                    </field>
                    <field id="lecm-resolutions:limitation-date-days" set="limitation-date" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-resolutions:limitation-date-type" set="limitation-date">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-resolutions:limitation-date" set="limitation-date"  mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Resolutions.limitationDateValidation" event="change" />
                        </constraint-handlers>
                    </field>

                    <field id="lecm-resolutions:errands-json" label-id="field.primaryRouting.errands.title" set="errands">
                        <control template="/ru/it/lecm/eds/controls/multi-form-control.ftl">
                            <control-param name="availableRemoveDefault">true</control-param>
                            <control-param name="documentType">lecm-errands:document</control-param>
                            <control-param name="documentFromId">from-resolution</control-param>
                            <control-param name="submitFireEvent">sendResolution</control-param>
                            <control-param name="argsConfig"><![CDATA[{
                                    "assoc_lecm-resolutions_controller-assoc": "assoc_lecm-errands_controller-assoc",
                                    "prop_lecm-resolutions_limitation-date-radio": "prop_lecm-errands_limitation-date-radio",
                                    "prop_lecm-resolutions_limitation-date-days": "prop_lecm-errands_limitation-date-days",
                                    "prop_lecm-resolutions_limitation-date-type": "prop_lecm-errands_limitation-date-type",
                                    "prop_lecm-resolutions_limitation-date": "prop_lecm-errands_limitation-date"
                                }]]></control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script5" set="errands">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-reinit-title-by-type.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script7" set="errands">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-change-limitation-date.js</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script6" set="errands">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-errands/errands-change-controller-handler.js</control-param>
                        </control>
                    </field>

                    <field id="lecm-resolutions:reviewers-assoc" set="reviewers">
                        <control template="/ru/it/lecm/base-share/components/controls/association-complex-control.ftl">
                            <control-param name="items">employee,orgUnit,workGroup,reviewItem</control-param>
                            <!-- lecm-orgstr:employee -->
                            <control-param name="employee_label">Сотрудник</control-param>
                            <control-param name="employee_endpointType">lecm-orgstr:employee</control-param>
                            <control-param name="employee_endpointMany">true</control-param>
                            <control-param name="employee_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
                            <control-param name="employee_nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
                            <control-param name="employee_plane">true</control-param>
                            <control-param name="employee_showSearch">true</control-param>
                            <control-param name="employee_useStrictFilterByOrg">true</control-param>
                            <control-param name="employee_sortProp">lecm-orgstr:employee-short-name</control-param>
                            <!-- lecm-orgstr:organization-unit -->
                            <control-param name="orgUnit_label">Подразделение</control-param>
                            <control-param name="orgUnit_endpointType">lecm-orgstr:organization-unit</control-param>
                            <control-param name="orgUnit_endpointMany">true</control-param>
                            <control-param name="orgUnit_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура/cm:Холдинг</control-param>
                            <control-param name="orgUnit_nameSubstituteString">{lecm-orgstr:element-short-name}</control-param>
                            <control-param name="orgUnit_plane">false</control-param>
                            <control-param name="orgUnit_showSearch">true</control-param>
                            <control-param name="orgUnit_sortProp">lecm-orgstr:element-short-name</control-param>
                            <!-- lecm-orgstr:workGroup -->
                            <control-param name="workGroup_label">Рабочая группа</control-param>
                            <control-param name="workGroup_endpointType">lecm-orgstr:workGroup</control-param>
                            <control-param name="workGroup_endpointMany">true</control-param>
                            <control-param name="workGroup_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
                            <control-param name="workGroup_nameSubstituteString">{cm:name}</control-param>
                            <control-param name="workGroup_plane">true</control-param>
                            <control-param name="workGroup_showSearch">true</control-param>
                            <control-param name="workGroup_sortProp">lecm-orgstr:element-short-name</control-param>
                            <!-- lecm-review-list:review-list-item -->
                            <control-param name="reviewItem_label">Список ознакомления</control-param>
                            <control-param name="reviewItem_endpointType">lecm-review-list:review-list-item</control-param>
                            <control-param name="reviewItem_endpointMany">true</control-param>
                            <control-param name="reviewItem_rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Списки_x0020_ознакомления</control-param>
                            <control-param name="reviewItem_nameSubstituteString">{cm:title}</control-param>
                            <control-param name="reviewItem_plane">true</control-param>
                            <control-param name="reviewItem_showSearch">true</control-param>
                            <control-param name="reviewItem_childrenDataSource">lecm/review/ds/allowedReviewLists</control-param>
                            <control-param name="reviewItem_sortProp">cm:title</control-param>
                        </control>
                    </field>

                    <field id="lecm-resolutions:base-doc-execution-date-attr-name" set="end">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden.ftl"/>
                    </field>
                    <field id="lecm-base-dummy-aspects:script2" set="end">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-resolution/lecm-resolution-form.js</control-param>
                            <control-param name="scriptLoadedFireAction">resolutionFormScriptLoaded</control-param>
                        </control>
                    </field>
                    <field id="lecm-base-dummy-aspects:script3" label-id="label.resolution.edit.save" set="end">
                        <control template="/ru/it/lecm/eds/controls/button-control.ftl">
                            <control-param name="clickFireAction">sendResolutionButtonClick</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <!-- Форма с набором полей для правой области (Общие сведения) на карточке документа-->
            <form id="document">
                <field-visibility>
                    <show id="lecm-resolutions:number"/>
                    <show id="lecm-resolutions:control"/>
                    <show id="lecm-document:subject-assoc"/>
                    <show id="lecm-resolutions:author-assoc"/>
                    <show id="lecm-resolutions:controller-assoc"/>
                    <show id="lecm-statemachine:status"/>
                </field-visibility>
            </form>
            <!-- Форма просмотра на главной странице-->
            <form id="main-page-dashlets">
                <field-visibility>
                    <show id="viewMetadata"/>
                </field-visibility>
                <appearance>
                    <field id="viewMetadata">
                        <control template="/ru/it/lecm/documents/controls/document-view-metadata-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-resolutions-dic:completion-methods">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-resolutions-dic:completion-methods">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                </field-visibility>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="cm:name"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$resolutionDecline">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmResolutionWf:declineReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmResolutionWf:declineReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$resolutionCompletion">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmResolutionWf:completionReason"/>
                    <show id="lecmResolutionWf:completionMethodAssoc"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmResolutionWf:completionReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$resolutionAnnul">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmResolutionWf:annulReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmResolutionWf:annulReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="Workflow">
        <hidden-workflows>
            <workflow name="activiti$resolutionsDecline"/>
            <workflow name="activiti$resolutionCompletion"/>
        </hidden-workflows>
    </config>
</alfresco-config>