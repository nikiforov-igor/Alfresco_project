<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:p="http://www.springframework.org/schema/p"
	   xmlns:util="http://www.springframework.org/schema/util"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<bean id="abstract.workflowRunner" abstract="true"
		  class="ru.it.lecm.workflow.beans.AbstractWorkflowRunner"
		  p:nodeService-ref="nodeService"
		  p:workflowService-ref="WorkflowService"
		  p:alfrescoProcessEngineConfiguration-ref="activitiProcessEngineConfiguration"
		  p:stateMachineService-ref="stateMachineHelper"
		  p:businessJournalService-ref="businessJournalService"
		  p:routeService-ref="routeService"
		  p:workflowAssigneesListService-ref="workflowAssigneesListService"
		  p:authenticationService-ref="authenticationService"
		  p:personService-ref="personService"/>

	<util:list id="approval.inputVariables">
		<value>documentAttachmentCategoryName</value>
		<value>workflowRole</value>
		<value>commentFileAttachmentCategoryName</value>
		<value>workflowDynRole</value>
	</util:list>
	<util:constant id="APPROVAL" static-field="ru.it.lecm.workflow.WorkflowType.APPROVAL"/>
	<bean id="approval.workflowRunner" parent="abstract.workflowRunner"
		  class="ru.it.lecm.workflow.beans.ApprovalWorkflowRunner"
		  p:inputVariables-ref="approval.inputVariables"
		  p:workflowType-ref="APPROVAL"/>

	<util:list id="signing.inputVariables">
		<value>documentAttachmentCategoryName</value>
		<value>workflowRole</value>
		<value>workflowDynRole</value>
	</util:list>
	<util:constant id="SIGNING" static-field="ru.it.lecm.workflow.WorkflowType.SIGNING"/>
	<bean id="signing.workflowRunner" parent="abstract.workflowRunner"
		  class="ru.it.lecm.workflow.beans.SigningWorkflowRunner"
		  p:inputVariables-ref="signing.inputVariables"
		  p:workflowType-ref="SIGNING"/>

	<util:list id="workflow.runners">
		<ref bean="approval.workflowRunner"/>
		<ref bean="signing.workflowRunner"/>
	</util:list>
	<bean id="workflowRunnerService" class="ru.it.lecm.workflow.beans.WorkflowRunnerFactory"
		  p:runners-ref="workflow.runners"/>

</beans>
