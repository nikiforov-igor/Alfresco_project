<alfresco-config>
    <config>
        <forms>
            <default-controls>
                <type name="association:lecm-events-dic:locations" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
                    <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Места_x0020_проведения_x0020_мероприятий</control-param>
                    <control-param name="plane">true</control-param>
                </type>
                <type name="association:lecm-events-dic:resources" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
                    <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Ресурсы</control-param>
                    <control-param name="plane">true</control-param>
                </type>
            </default-controls>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-events:document">
        <forms>
            <form>
                <field-visibility>
                    <!-- Заголовок -->
                    <show id="lecm-events:title"/>
                    <!-- Весмь день -->
                    <show id="lecm-events:all-day"/>
                    <!-- Дата начала мероприятия -->
                    <show id="lecm-events:from-date"/>
                    <!-- Дата окончания мероприятия -->
                    <show id="lecm-events:to-date"/>
                    <!-- Повторное -->
                    <show id="lecm-events:repeatable"/>
                    <!-- Дата начала периода -->
                    <show id="lecm-events:repeatable-start-period"/>
                    <!-- Дата окончания периода -->
                    <show id="lecm-events:repeatable-end-period"/>
                    <!-- Правила -->
                    <show id="lecm-events:repeatable-rule"/>
                    <!-- Участники -->
                    <show id="lecm-events-ts:members-assoc"/>
                    <!-- Приглашённые -->
                    <show id="lecm-events:invited-members-assoc"/>
                    <!-- Место проведения -->
                    <show id="lecm-events:location-assoc"/>
                    <!-- Ресурсы -->
                    <show id="lecm-events-ts:resources-assoc"/>
                    <!-- Инициатор -->
                    <show id="lecm-events:initiator-assoc"/>
                    <!-- Описание -->
                    <show id="lecm-events:description"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events:all-day">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Events.changeAllDayValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-events:repeatable">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Events.changeRepeatableValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-events:repeatable-rule">
                        <control template="/ru/it/lecm/base-share/components/controls/reiteration-control.ftl" />
                    </field>
                    <field id="lecm-events-ts:members-assoc">
                        <control template="/ru/it/lecm/documents/controls/document-table-control.ftl">
                            <control-param name="isTableSortable">false</control-param>
                            <control-param name="refreshAfterCreate">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-events-ts:resources-assoc">
                        <control template="/ru/it/lecm/documents/controls/document-table-control.ftl">
                            <control-param name="isTableSortable">false</control-param>
                            <control-param name="refreshAfterCreate">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-events:description">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                </appearance>
            </form>
            <!-- Форма просмотра на главной странице-->
            <form id="main-page-dashlets">
                <field-visibility>
                    <show id="viewMetadata"/>
                </field-visibility>
                <appearance>
                    <field id="viewMetadata">
                        <control template="/ru/it/lecm/events/controls/event-view-metadata-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-events:document">
        <forms>
            <form>
                <field-visibility>
                    <!-- Заголовок -->
                    <show id="lecm-events:title"/>
                    <!-- Весмь день -->
                    <show id="lecm-events:all-day"/>
                    <!-- Дата начала мероприятия -->
                    <show id="lecm-events:from-date"/>
                    <!-- Дата окончания мероприятия -->
                    <show id="lecm-events:to-date"/>
                    <!-- Повторное -->
                    <show id="lecm-events:repeatable"/>
                    <!-- Дата начала периода -->
                    <show id="lecm-events:repeatable-start-period"/>
                    <!-- Дата окончания периода -->
                    <show id="lecm-events:repeatable-end-period"/>
                    <!-- Правила -->
                    <show id="lecm-events:repeatable-rule"/>
                    <!-- Участники -->
                    <show id="lecm-events:temp-members-assoc"/>
                    <!-- Приглашённые -->
                    <show id="lecm-events:invited-members-assoc"/>
                    <!-- Место проведения -->
                    <show id="lecm-events:location-assoc"/>
                    <!-- Ресурсы -->
                    <show id="lecm-events:temp-resources-assoc"/>
                    <!-- Инициатор -->
                    <show id="lecm-events:initiator-assoc"/>
                    <!-- Описание -->
                    <show id="lecm-events:description"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                    <!--Вложения-->
                    <show id="lecm-document-aspects:attachments-temp-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events:all-day">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Events.changeAllDayValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-events:repeatable">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Events.changeRepeatableValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-events:repeatable-start-period" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Events.repeatableValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-events:repeatable-end-period" mandatory="true">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Events.repeatableValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-events:repeatable-rule" mandatory="true">
                        <control template="/ru/it/lecm/base-share/components/controls/reiteration-control.ftl" />
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.module.Events.repeatableValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-events:location-assoc">
                        <control>
                            <control-param name="childrenDataSource">lecm/events/locations/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-events:temp-resources-assoc">
                        <control>
                            <control-param name="childrenDataSource">lecm/events/resources/picker</control-param>
                        </control>
                    </field>
                    <field id="lecm-events:initiator-assoc">
                        <control>
                            <control-param name="defaultValueDataSource">lecm/orgstructure/api/getCurrentEmployee</control-param>
                        </control>
                    </field>
                    <field id="lecm-events:description">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                    <field id="lecm-document-aspects:attachments-temp-assoc" label="Вложения">
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control-with-preview.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">Вложения</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
            <form id="statemachine-editable-fields">
                <field-visibility>
                    <!-- Заголовок -->
                    <show id="lecm-events:title"/>
                    <!-- Весмь день -->
                    <show id="lecm-events:all-day"/>
                    <!-- Дата начала мероприятия -->
                    <show id="lecm-events:from-date"/>
                    <!-- Дата окончания мероприятия -->
                    <show id="lecm-events:to-date"/>
                    <!-- Повторное -->
                    <show id="lecm-events:repeatable"/>
                    <!-- Участники -->
                    <show id="lecm-events-ts:members-assoc"/>
                    <!-- Приглашённые -->
                    <show id="lecm-events:invited-members-assoc"/>
                    <!-- Место проведения -->
                    <show id="lecm-events:location-assoc"/>
                    <!-- Ресурсы -->
                    <show id="lecm-events-ts:resources-assoc"/>
                    <!-- Инициатор -->
                    <show id="lecm-events:initiator-assoc"/>
                    <!-- Описание -->
                    <show id="lecm-events:description"/>
                    <!-- Тематика -->
                    <show id="lecm-document:subject-assoc"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-events-dic:locations">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="lecm-events-dic:locations-note"/>
                    <show id="lecm-events-dic:locations-organization-assoc"/>
                    <show id="lecm-events-dic:locations-address"/>
                    <show id="lecm-events-dic:locations-privilege-level"/>
                    <show id="lecm-events-dic:locations-code"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:locations-organization-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Контрагенты</control-param>
                            <control-param name="nameSubstituteString">{lecm-contractor:contractor-to-legalform-association/lecm-legalform:short-title} {lecm-contractor:shortname}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="itemType">lecm-contractor:contractor-type</control-param>
                            <control-param name="additionalFilter">ASPECT:\"lecm-orgstr-aspects:is-organization-aspect\"</control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="doNotCheckAccess">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>
    <config evaluator="model-type" condition="lecm-events-dic:locations">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="lecm-events-dic:locations-note"/>
                    <show id="lecm-events-dic:locations-organization-assoc"/>
                    <show id="lecm-events-dic:locations-address"/>
                    <show id="lecm-events-dic:locations-privilege-level"/>
                    <show id="lecm-events-dic:locations-code"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:locations-organization-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Контрагенты</control-param>
                            <control-param name="nameSubstituteString">{lecm-contractor:contractor-to-legalform-association/lecm-legalform:short-title} {lecm-contractor:shortname}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="itemType">lecm-contractor:contractor-type</control-param>
                            <control-param name="additionalFilter">ASPECT:\"lecm-orgstr-aspects:is-organization-aspect\"</control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="doNotCheckAccess">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-events-dic:resources">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="lecm-events-dic:resources-note"/>
                    <show id="lecm-events-dic:resources-responsible-assoc"/>
                    <show id="lecm-events-dic:resources-organization-assoc"/>
                    <show id="lecm-events-dic:resources-require-approval"/>
                    <show id="lecm-events-dic:resources-available"/>
                    <show id="lecm-events-dic:resources-privilege-level"/>
                    <show id="lecm-events-dic:resources-code"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:resources-organization-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Контрагенты</control-param>
                            <control-param name="nameSubstituteString">{lecm-contractor:contractor-to-legalform-association/lecm-legalform:short-title} {lecm-contractor:shortname}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="itemType">lecm-contractor:contractor-type</control-param>
                            <control-param name="additionalFilter">ASPECT:\"lecm-orgstr-aspects:is-organization-aspect\"</control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="doNotCheckAccess">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>
    <config evaluator="model-type" condition="lecm-events-dic:resources">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                    <show id="lecm-events-dic:resources-note"/>
                    <show id="lecm-events-dic:resources-responsible-assoc"/>
                    <show id="lecm-events-dic:resources-organization-assoc"/>
                    <show id="lecm-events-dic:resources-require-approval"/>
                    <show id="lecm-events-dic:resources-available"/>
                    <show id="lecm-events-dic:resources-privilege-level"/>
                    <show id="lecm-events-dic:resources-code"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:resources-organization-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Контрагенты</control-param>
                            <control-param name="nameSubstituteString">{lecm-contractor:contractor-to-legalform-association/lecm-legalform:short-title} {lecm-contractor:shortname}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="employeeAbsenceMarker">true</control-param>
                            <control-param name="itemType">lecm-contractor:contractor-type</control-param>
                            <control-param name="additionalFilter">ASPECT:\"lecm-orgstr-aspects:is-organization-aspect\"</control-param>
                            <control-param name="useStrictFilterByOrg">false</control-param>
                            <control-param name="doNotCheckAccess">true</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-events-dic:resources-pl">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-dic:resources-pl-level"/>
                    <show id="lecm-events-dic:resources-pl-br-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:resources-pl-br-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Бизнес_x0020_роли</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="showViewIncompleteWarning">false</control-param>
                            <control-param name="additionalFilter">@lecm-orgstr\\:business-role-is-dynamic: \"false\"</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>
    <config evaluator="model-type" condition="lecm-events-dic:resources-pl">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-dic:resources-pl-level"/>
                    <show id="lecm-events-dic:resources-pl-br-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:resources-pl-br-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Бизнес_x0020_роли</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="showViewIncompleteWarning">false</control-param>
                            <control-param name="additionalFilter">@lecm-orgstr\\:business-role-is-dynamic: \"false\"</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-events-dic:locations-pl">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-dic:locations-pl-level"/>
                    <show id="lecm-events-dic:locations-pl-br-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:locations-pl-br-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Бизнес_x0020_роли</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="showViewIncompleteWarning">false</control-param>
                            <control-param name="additionalFilter">@lecm-orgstr\\:business-role-is-dynamic: \"false\"</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>
    <config evaluator="model-type" condition="lecm-events-dic:locations-pl">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-dic:locations-pl-level"/>
                    <show id="lecm-events-dic:locations-pl-br-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-events-dic:locations-pl-br-assoc">
                        <control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
                            <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Бизнес_x0020_роли</control-param>
                            <control-param name="nameSubstituteString">{cm:name}</control-param>
                            <control-param name="showCreateNewLink">false</control-param>
                            <control-param name="showCreateNewButton">false</control-param>
                            <control-param name="showViewIncompleteWarning">false</control-param>
                            <control-param name="additionalFilter">@lecm-orgstr\\:business-role-is-dynamic: \"false\"</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-events-ts:members">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-ts:members-status"/>
                </field-visibility>
            </form>
        </forms>
    </config>
    <config evaluator="model-type" condition="lecm-events-ts:members">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-ts:members-employee-assoc"/>
                </field-visibility>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-events-ts:members-employee-assoc"/>
                    <show id="lecm-events-ts:members-status"/>
                </field-visibility>
            </form>
        </forms>
    </config>
    <config evaluator="node-type" condition="lecm-events-ts:resources">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-ts:resources-status"/>
                </field-visibility>
            </form>
        </forms>
    </config>
    <config evaluator="model-type" condition="lecm-events-ts:resources">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-events-ts:resources-data-assoc"/>
                </field-visibility>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-events-ts:resources-data-assoc"/>
                    <show id="lecm-events-ts:resources-status"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$eventsMemberDecline">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmEventsWf:memberDeclineReason"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmEventsWf:memberDeclineReason">
                        <control template="/ru/it/lecm/base-share/components/controls/textarea.ftl">
                            <control-param name="rows">7</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$eventsRequestNewTime">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems"/>
                    <show id="lecmEventsWf:requestNewTimeFromDate"/>
                    <show id="lecmEventsWf:requestNewTimeToDate"/>
                    <show id="lecmEventsWf:requestNewTimeAllDay"/>
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmEventsWf:requestNewTimeAllDay">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Events.requestNewTimeChangeAllDayValidation" event="change"/>
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="Workflow">
        <hidden-workflows>
            <workflow name="activiti$eventsMemberDecline"/>
            <workflow name="activiti$eventsRequestNewTime"/>
        </hidden-workflows>
    </config>
</alfresco-config>