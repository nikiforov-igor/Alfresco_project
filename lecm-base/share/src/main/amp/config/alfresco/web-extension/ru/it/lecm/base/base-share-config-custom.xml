<alfresco-config>

	<!--<config evaluator="string-compare" condition="DocLibCustom">
		<dependencies>
			&lt;!&ndash; JS для регистрации action'а "Разблокировать документ &ndash;&gt;
			<js src="/scripts/lecm-base/document-unlock.js" />
		</dependencies>
	</config>

	<config evaluator="string-compare" condition="LecmDocumentDetails">
		<dependencies>
			<js src="/scripts/lecm-base/document-unlock.js" />
		</dependencies>
	</config>

	&lt;!&ndash; Добавление action'a "Разблокировать документа" &ndash;&gt;
	<config evaluator="string-compare" condition="DocLibActions" replace="true">
		<actions>
			<action id="document-unlock" type="javascript" label="actions.document.unlock" icon="document-unlock">
				<param name="function">onUnlockAction</param>
				<permissions>
					<permission allow="true">Write</permission>
				</permissions>
				<evaluator>evaluator.doclib.action.isLocked</evaluator>
				<evaluator negate="true">evaluator.ru.it.lecm.documents.isBase</evaluator>
			</action>
		</actions>

		&lt;!&ndash;
           Action Group definitions
        &ndash;&gt;
		<actionGroups>
			<actionGroup id="document-browse">
				<action index="101" id="document-unlock" />
			</actionGroup>
			<actionGroup id="document-details">
				<action index="101" id="document-unlock" />
			</actionGroup>
		</actionGroups>
	</config>-->

	<config evaluator="string-compare" condition="CSRFPolicy" replace="true">
		<filter>
			<rule>
				<request>
					<method>POST|PUT|DELETE</method>
					<session>
						<attribute name="_alf_USER_ID">.*</attribute>
					</session>
				</request>
				<action name="assertReferer">
					<param name="always">false</param>
				</action>
				<action name="assertOrigin">
					<param name="always">false</param>
				</action>
			</rule>
		</filter>
	</config>

	<config>
		<forms>
			<default-controls>
				<!--Переопределённые базовые контролы-->
				<!--Переопределяются только контролы с параметрами, потому что параметры затираются (баг в alfresco)-->
				<type name="text" template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
				<type name="mltext" template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
				<type name="int" template="/ru/it/lecm/base-share/components/controls/number.ftl" />
				<type name="float" template="/ru/it/lecm/base-share/components/controls/number.ftl" />
				<type name="double" template="/ru/it/lecm/base-share/components/controls/number.ftl" />
				<type name="long" template="/ru/it/lecm/base-share/components/controls/number.ftl" />
				<type name="boolean" template="/ru/it/lecm/base-share/components/controls/lecm-checkbox-control.ftl" />
				<type name="datetime" template="/ru/it/lecm/base-share/components/controls/date.ftl">
					<control-param name="showTime">true</control-param>
				</type>
				<type name="date" template="/ru/it/lecm/base-share/components/controls/date.ftl" />

				<type name="date-range" template="/ru/it/lecm/base-share/components/controls/daterange-control.ftl"/>
				<type name="int-range" template="/ru/it/lecm/base-share/components/controls/numberrange.ftl"/>
				<type name="float-range" template="/ru/it/lecm/base-share/components/controls/numberrange.ftl"/>
				<type name="double-range" template="/ru/it/lecm/base-share/components/controls/numberrange.ftl"/>
				<type name="long-range" template="/ru/it/lecm/base-share/components/controls/numberrange.ftl"/>

				<type name="category" template="/ru/it/lecm/base-share/components/controls/category.ftl" />

				<type name="association" template="/ru/it/lecm/base-share/components/controls/associationControl.ftl" />
				<type name="association:cm:person" template="/ru/it/lecm/base-share/components/controls/authority.ftl" />
				<type name="association:cm:authority" template="/ru/it/lecm/base-share/components/controls/authority.ftl" />
				<type name="association:cm:authorityContainer" template="/ru/it/lecm/base-share/components/controls/authority.ftl" />

				<!--Контролы оргструктуры-->
				<type name="association:lecm-orgstr:organization-unit" template="/ru/it/lecm/base-share/components/controls/association-tree-picker.ftl">
					<control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура/cm:Холдинг</control-param>
					<control-param name="nameSubstituteString">{lecm-orgstr:element-short-name}</control-param>
					<control-param name="treeNodeSubstituteString">{lecm-orgstr:element-short-name}</control-param>
					<control-param name="treeNodeTitleSubstituteString">{cm:name}</control-param>
					<control-param name="plane">false</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
					<control-param name="showSelectedItemsPath">false</control-param>
					<control-param name="sortProp">lecm-orgstr:element-short-name</control-param>
				</type>
				<type name="association:lecm-orgstr:staff-list" template="/ru/it/lecm/base-share/components/controls/association-tree-picker.ftl">
					<control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
					<control-param name="nameSubstituteString">{lecm-orgstr:element-member-position-assoc/cm:name} {lecm-orgstr:element-member-employee-assoc/lecm-orgstr:employee-link-employee-assoc/cm:name}</control-param>
					<control-param name="selectedItemsNameSubstituteString">{lecm-orgstr:element-member-position-assoc/cm:name} {../lecm-orgstr:element-short-name} {lecm-orgstr:element-member-employee-assoc/lecm-orgstr:employee-link-employee-assoc/cm:name}</control-param>
					<control-param name="treeNodeSubstituteString">{lecm-orgstr:element-short-name}</control-param>
					<control-param name="treeNodeTitleSubstituteString">{cm:name}</control-param>
					<control-param name="treeItemType">lecm-orgstr:organization-unit</control-param>
					<control-param name="plane">false</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
					<control-param name="showSelectedItemsPath">false</control-param>
					<control-param name="showSearch">false</control-param>
				</type>
				<type name="association:lecm-orgstr:workGroup" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
					<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Структура</control-param>
					<control-param name="nameSubstituteString">{cm:name}</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
				</type>
				<type name="association:lecm-orgstr:employee" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
					<control-param name="plane">true</control-param>
					<control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
					<control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
					<control-param name="employeeAbsenceMarker">true</control-param>
					<control-param name="useStrictFilterByOrg">true</control-param>
					<control-param name="additionalFilter">{{EMPLOYEE_HAS_LOGIN}}</control-param>
					<control-param name="showSearch">true</control-param>
				</type>
				<type name="association:lecm-orgstr:workRole" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
					<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Роли_x0020_для_x0020_рабочих_x0020_групп</control-param>
					<control-param name="nameSubstituteString">{cm:name}</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
				</type>
				<type name="association:lecm-orgstr-docType:documentType" template="/ru/it/lecm/base-share/components/controls/association-tree-picker.ftl">
					<control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Виды_x0020_удостоверений_x0020_личности</control-param>
					<control-param name="nameSubstituteString">{cm:name}</control-param>
					<control-param name="plane">true</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
				</type>
				<type name="association:lecm-busjournal:objectType" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
					<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Тип_x0020_объекта</control-param>
					<control-param name="nameSubstituteString">{cm:name}</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
				</type>
				<type name="association:lecm-busjournal:eventCategory" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
					<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Категория_x0020_события</control-param>
					<control-param name="nameSubstituteString">{cm:name}</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
				</type>

				<!--Контролы уведомлений/подписок-->
				<type name="association:lecm-notf-type:notification-type" template="/ru/it/lecm/base-share/components/controls/association-checkboxes-control.ftl">
					<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Типы_x0020_доставки_x0020_уведомлений</control-param>
					<control-param name="nameSubstituteString">{cm:name}</control-param>
					<control-param name="defaultValuesDataSource">lecm/notifications/getDefaultChannels</control-param>
				</type>

				<!--Контролы связей документов-->
				<type name="association:lecm-connect-types:connection-type" template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
					<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Типы_x0020_связи</control-param>
					<control-param name="nameSubstituteString">{cm:name}</control-param>
					<control-param name="showCreateNewLink">false</control-param>
					<control-param name="showCreateNewButton">false</control-param>
				</type>
			</default-controls>

			<dependencies>
				<!--содержит полезные вещи, включая ассинхронную подгрузку других скриптов-->
				<js src="/scripts/lecm-base/components/lecm-validation.js" />
				<js src="/scripts/lecm-base/constraints.js" />
			</dependencies>

			<constraint-handlers>
				<constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup" />
				<constraint type="LECM_NUMBER" validation-handler="LogicECM.constraints.isNumber" event="keyup" />
			</constraint-handlers>

		</forms>
	</config>

	<!-- Переопределяем базовую форму -->
	<!-- cm:content type (existing nodes) -->
	<config evaluator="node-type" condition="cm:content">
		<forms>
			<!-- Default form configuration for the cm:content type -->
			<form>
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
					<field id="cm:author">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:owner">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
				</appearance>
			</form>
			<!-- Document Library pop-up Edit Metadata form -->
			<form id="doclib-simple-metadata">
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
					<field id="cm:author">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:owner">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
				</appearance>
			</form>
			<!-- Document Library Inline Edit form -->
			<form id="doclib-inline-edit">
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="bpm:startTask">
		<forms>
			<form id="reassignTask">
				<field-visibility>
					<show id="cm:owner" force="true"/>
					<show id="taskIds" force="true"/>
				</field-visibility>
				<appearance>
					<field id="cm:owner" label-id="lable.employee" mandatory="true">
						<control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
							<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Структура_x0020_организации_x0020_и_x0020_сотрудников/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="nameSubstituteString">{lecm-orgstr:employee-last-name} {lecm-orgstr:employee-first-name} {lecm-orgstr:employee-middle-name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name} {..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="employeeAbsenceMarker">true</control-param>
							<control-param name="itemType">lecm-orgstr:employee</control-param>
							<control-param name="useStrictFilterByOrg">true</control-param>
						</control>
					</field>
					<field id="taskIds" label-id="lable.employee" mandatory="false">
						<control template="/ru/it/lecm/base-share/components/controls/lecm-arguments-hidden-control.ftl">
							<control-param name="argName">taskIds</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

	<!-- cm:content type (creating nodes) -->
	<config evaluator="model-type" condition="cm:content">
		<forms>
			<!-- Default Create Content form -->
			<form>
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
				</appearance>
			</form>
			 <!-- Document Library Create Google Doc form -->
			<form id="doclib-create-googledoc">
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
				</appearance>
			</form>
			<!-- Search form -->
			<form id="search">
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
				</appearance>
			</form>
			<form id="file-navigator">
				<field-visibility>
					<show id="cm:name"/>
					<show id="creator"/>
					<show id="mimetype"/>
					<show id="size"/>
					<show id="cm:modified"/>
				</field-visibility>
				<appearance>
					<field id="creator" label-id="lable.creator" />
				</appearance>
			</form>
		</forms>
	</config>

	<!-- cm:folder type (existing nodes) -->
	<config evaluator="node-type" condition="cm:folder">
		<forms>
			<!-- Default form configuration for the cm:folder type -->
			<form>
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
				</appearance>
			</form>

			<!-- Document Library pop-up Edit Metadata form -->
			<form id="doclib-simple-metadata">
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
				</appearance>
			</form>
		</forms>
	</config>

	<!-- cm:folder type (creating nodes) -->
	<config evaluator="model-type" condition="cm:folder">
		<forms>
			<!-- Document Library Common form -->
			<form id="doclib-common">
				<appearance>
					<field id="cm:name">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:title">
						<control template="/ru/it/lecm/base-share/components/controls/textfield.ftl" />
					</field>
					<field id="cm:description">
						<control template="/ru/it/lecm/base-share/components/controls/textarea.ftl" />
					</field>
				</appearance>
			</form>
		</forms>
	</config>

</alfresco-config>
