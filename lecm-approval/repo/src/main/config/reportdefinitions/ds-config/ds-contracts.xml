<?xml version="1.0" encoding="UTF-8"?>
<!--
	Договорная деятельность.

Фильтры отчета:
•	Период 
•	Контрагент
•	Актуальные/все
•	Сумма
•	Вид договора
•	Тематика договора

Выходные данные отчета:
•	Номер договора
•	(A) Контрагент
•	(A) Вид договора

•	(A) Тематика договора
•	(!) Статус договора
•	Дата начала действия договора
•	Дата завершения действия договора
•	(!) Исполнитель

  -->

<cmis-ds.config>

	<query_offset>0</query_offset>
	<query_limit>-1</query_limit>
	<query_pgsize>-1</query_pgsize>

	<!--
		select * from lecm:documents
	  -->
	<query>
		<![CDATA[
			select * from lecm-contract:document as Contract
		]]>
	</query>

	<fields.jasper>
		<field queryFldName="lecm-contract:regNumSystem"
				jrFldName="col_Regnum"
				displayName="Регистрационный номер договора" javaValueClass="String"/>

		<field jrFldName="col_numContragent" queryFldName="lecm-contract:regNumContractor" displayName="Регистрационный номер контрагента" />

		<!-- Данные по контрагенту (с типом "lecm-contractor:contractor-type") 
			в виде "а-ля форматной" строки
		  -->
		<field jrFldName="col_Contragent.name"  queryFldName="{lecm-contract:partner-assoc/lecm-contractor:shortname}" displayName="Контрагент"/>
		<field jrFldName="col_Contragent.phone" queryFldName="{lecm-contract:partner-assoc/lecm-contractor:phone}" displayName="Тел Контрагента" />

		<!-- Данные по "Виду договора" (с типом "lecm-contract-dic:contract-type") -->
		<field jrFldName="col_DocKind" queryFldName="{lecm-contract:typeContract-assoc/cm:name}" displayName="Вид договора" />

		<!-- Данные по "Тематика договора" (с типом "lecm-contract-dic:contract-subjects") -->
		<field jrFldName="col_Theme.code" queryFldName="{lecm-contract:subjectContract-assoc/lecm-contract-dic:contract-subjects-code}" displayName="Тематика.Код" />
		<field jrFldName="col_Theme.tname" queryFldName="{lecm-contract:subjectContract-assoc/cm:name}" displayName="Тематика.Название" />
		<field jrFldName="col_Theme.desc" queryFldName="{lecm-contract:subjectContract-assoc/lecm-contract-dic:contract-subjects-description}" displayName="Тематика.Описание" />

		<!-- Статус -->
		<field jrFldName="col_Status" queryFldName="lecm-statemachine:status" displayName="Статус" />

		<!-- Дата изменения статуса -->
		<field jrFldName="col_StatusDate" queryFldName="lecm-document:status-changed-date" displayName="Дата смены статус"
				javaValueClass="java.util.Date"/>

		<field jrFldName="col_DateStart" queryFldName="lecm-contract:startDate" displayName="Дата начала действия договора"
				javaValueClass="java.util.Date"/>

		<field jrFldName="col_DateEnd" queryFldName="lecm-contract:endDate" displayName="Дата окончания действия договора"
				javaValueClass="java.util.Date"/>

		<!-- Создатель договора -->
		<field jrFldName="col_Creator" queryFldName="cm:creator" displayName="Создатель договора" />

		<!--Представители (типа "lecm-representative:representative-type")
			Фамилия Имя Отчество и Должность
		  -->
		<field jrFldName="col_Executor_Family" queryFldName="{lecm-contract:representative-assoc/lecm-representative:surname}" displayName="Исполнитель.Фамилия" />
		<field jrFldName="col_Executor_Name" queryFldName="{lecm-contract:representative-assoc/lecm-representative:firstname}" displayName="Исполнитель.Имя" />
		<field jrFldName="col_Executor_Otchestvo" queryFldName="{lecm-contract:representative-assoc/lecm-representative:middlename}" displayName="Исполнитель.Отчество" />
		<field jrFldName="col_Executor_Staff" queryFldName="{lecm-contract:representative-assoc/lecm-representative:rank}" displayName="Исполнитель.Должность" />

		<!--
			<field queryFldName="fmydata" dislayName="" javaValueClass="my.check.type"/>
		  -->
	</fields.jasper>

	<url>http://localhost:8080/alfresco/service/cmis</url>
	<username>admin</username>
	<password>111</password>
	<allVersions>false</allVersions>

</cmis-ds.config>
