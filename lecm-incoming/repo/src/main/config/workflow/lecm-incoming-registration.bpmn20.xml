<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:activiti="http://activiti.org/bpmn"
             typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath"
             targetNamespace="http://www.it.ru/logicECM/incoming/workflow/registration/1.0">
	<process id="incomingRegistration" name="Входящие: регистрация">
		<startEvent id="startIncomingRegistration" name="Start" activiti:formKey="lecmIncomingWf:registration"></startEvent>
		<endEvent id="endIncomingRegistration" name="End"></endEvent>
		<scriptTask id="registration" name="Registration" scriptFormat="javascript">
			<extensionElements>
				<activiti:executionListener event="start" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
					<activiti:field name="script">
						<activiti:string>
							var document = bpm_package.children[0];
							if (document != null) {
								<!--var executor = null;-->
								<!--var executorAssoc = document.assocs["lecm-errands:executor-assoc"];-->
								<!--if (executorAssoc != null &amp;&amp; executorAssoc.length == 1) {-->
								<!--executor = executorAssoc[0];-->
								<!--}-->
								<!--if (executor != null) {-->
								<!--var logObjects = [];-->
								<!--logObjects.push("" + lecmErrandWf_changeExecutorNewExecutor.nodeRef);-->
								<!--var logText = "Сотрудник #initiator ";-->
								<!--logText += documentScript.wrapperTitle("сменил", lecmErrandWf_changeExecutorReason);-->
								<!--logText += " Исполнителя поручения: #mainobject. Новый исполнитель: #object1";-->
								<!--businessJournal.log(document.nodeRef.toString(), "ERRAND_CHANGE_EXECUTOR", logText, logObjects);-->
	<!---->
								<!--if (lecmErrandWf_changeExecutorNewExecutor != null) {-->
								<!--document.removeAssociation(executor, "lecm-errands:executor-assoc");-->
								<!--document.createAssociation(lecmErrandWf_changeExecutorNewExecutor, "lecm-errands:executor-assoc");-->
								<!--}-->
	<!---->
								<!--lecmPermission.revokeDynamicRole(document, executor, "ERRANDS_EXECUTOR");-->
								<!--}-->
							}
						</activiti:string>
					</activiti:field>
				</activiti:executionListener>
			</extensionElements>
			<script></script>
		</scriptTask>
		<receiveTask id="incomingReceiveTask" name="Receive Task"></receiveTask>
		<sequenceFlow id="flow1" name="" sourceRef="startIncomingRegistration" targetRef="registration"></sequenceFlow>
		<sequenceFlow id="flow2" name="" sourceRef="registration" targetRef="incomingReceiveTask"></sequenceFlow>
		<sequenceFlow id="flow3" name="" sourceRef="incomingReceiveTask" targetRef="endIncomingRegistration"></sequenceFlow>
	</process>
</definitions>