<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="exec-discipline-by-creator" pageWidth="842" pageHeight="595" orientation="Landscape" whenNoDataType="AllSectionsNoDetail" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="28e61b22-f23c-49c3-ba14-4928c3b8793a">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="dataSource" value="ru.it.lecm.errands.reports.ErrandsDisciplineDSProvider"/>
	<style name="styleOdd" mode="Opaque" backcolor="#FFFFFF">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{REPORT_COUNT}%2 == 0]]></conditionExpression>
			<style backcolor="#D2EAF1"/>
		</conditionalStyle>
	</style>
	<parameter name="CMIS_URL" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["http://127.0.0.1:8080/alfresco/cmisatom"]]></defaultValueExpression>
	</parameter>
	<parameter name="CMIS_USER" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["admin"]]></defaultValueExpression>
	</parameter>
	<parameter name="CMIS_PASS" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["111"]]></defaultValueExpression>
	</parameter>
	<parameter name="CMIS_ALLVERSIONS" class="java.lang.Boolean" isForPrompting="false">
		<defaultValueExpression><![CDATA[false]]></defaultValueExpression>
	</parameter>
	<parameter name="CMIS_QUERY" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["select * from lecm-contract:document as Contract"]]></defaultValueExpression>
	</parameter>
	<parameter name="CMIS_XMLCONFIG" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["ds-exec-discipline-by-creator.xml"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[]]>
	</queryString>
	<field name="Col_GroupBy" class="java.lang.String">
		<fieldDescription><![CDATA[Способ группировки]]></fieldDescription>
	</field>
	<field name="Col_NameTag" class="java.lang.String">
		<fieldDescription><![CDATA[Название]]></fieldDescription>
	</field>
	<field name="Col_Period" class="java.util.Date">
		<fieldDescription><![CDATA[Период с-по]]></fieldDescription>
	</field>
	<field name="Col_Param_Creator" class="java.lang.String">
		<fieldDescription><![CDATA[Инициатор (сотрудник)]]></fieldDescription>
	</field>
	<field name="Col_Param_Exec_OrgUnit" class="java.lang.String">
		<fieldDescription><![CDATA[Подразделение инициатора]]></fieldDescription>
	</field>
	<field name="Col_Count_Total" class="java.lang.Integer">
		<fieldDescription><![CDATA[Выдано всего поручений за период]]></fieldDescription>
	</field>
	<field name="Col_Count_Total_Important" class="java.lang.Integer">
		<fieldDescription><![CDATA[Выдано важных поручений за период]]></fieldDescription>
	</field>
	<field name="Col_Count_Closed" class="java.lang.Integer">
		<fieldDescription><![CDATA[Закрыто всего поручений за период]]></fieldDescription>
	</field>
	<field name="Col_Count_Closed_important" class="java.lang.Integer">
		<fieldDescription><![CDATA[Закрытых важных поручений за период]]></fieldDescription>
	</field>
	<field name="Col_Count_Intime" class="java.lang.Integer">
		<fieldDescription><![CDATA[Кол-вот исполнений в срок]]></fieldDescription>
	</field>
	<field name="Col_Count_Boss_Refused" class="java.lang.Integer">
		<fieldDescription><![CDATA[Кол-во поручений, отклонённых руководителем]]></fieldDescription>
	</field>
	<field name="Col_Count_Important_Refused" class="java.lang.Integer">
		<fieldDescription><![CDATA[Кол-во важных поручений, неисполненных в срок]]></fieldDescription>
	</field>
	<field name="Col_Avg_Execution.Value" class="java.lang.Float">
		<fieldDescription><![CDATA[Среднее время исполнения поручения, дн]]></fieldDescription>
	</field>
	<title>
		<band height="30" splitType="Stretch">
			<staticText>
				<reportElement uuid="85bf28f5-7b1d-49a7-b2d0-e31f2a45de0c" stretchType="RelativeToBandHeight" x="0" y="0" width="802" height="30"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="20" isBold="true" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[Исполнительская дисциплина по Исполнителям]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="30" splitType="Stretch">
			<textField>
				<reportElement uuid="6df5d2b4-b246-429d-a894-8f1f1d716bbf" x="0" y="1" width="366" height="29">
					<printWhenExpression><![CDATA[$V{PAGE_NUMBER} > 1]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" isBold="true" isItalic="false" pdfEncoding="Cp1251"/>
				</textElement>
				<textFieldExpression><![CDATA["Страница " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="100" splitType="Stretch">
			<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="false">
				<reportElement uuid="d2334534-0ee4-43cb-82d6-fd1d4e4ed21a" stretchType="RelativeToTallestObject" mode="Opaque" x="0" y="0" width="32" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single" spacingBefore="2" spacingAfter="2"/>
				</textElement>
				<textFieldExpression><![CDATA["№"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement uuid="279c1409-10d9-462c-8311-1bbaaae755e4" stretchType="RelativeToTallestObject" mode="Opaque" x="32" y="0" width="111" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Исполнитель"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement uuid="fddcd90a-ed79-4a6c-9cb4-01504c915527" stretchType="RelativeToTallestObject" mode="Opaque" x="143" y="0" width="110" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Выдано всего поручений за период (из них важных)"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement uuid="5deded13-7b59-4fe2-8010-e47318a37c95" stretchType="RelativeToTallestObject" mode="Opaque" x="253" y="0" width="110" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Закрыто всего поручений за период (из них важных)"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement uuid="1ede53b5-ccec-41e6-9dec-bff1bf22dd41" stretchType="RelativeToTallestObject" mode="Opaque" x="363" y="0" width="110" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Процент исполнения в срок"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement uuid="5c8c984a-aa84-44a7-be82-0f8e19f000a9" stretchType="RelativeToTallestObject" mode="Opaque" x="473" y="0" width="110" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Процент поручений, отклонённых руководителем"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement uuid="eb69c24b-6c21-4538-8f04-a9681f4d7f98" stretchType="RelativeToTallestObject" mode="Opaque" x="583" y="0" width="110" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Процент (кол-во) важных поручений, неисполненных в срок"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement uuid="8589ba2a-9e4e-4cc2-9097-511c3488d66b" stretchType="RelativeToTallestObject" mode="Opaque" x="693" y="0" width="110" height="100" isPrintWhenDetailOverflows="true" forecolor="#FFFFFF" backcolor="#4BACC6"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Среднее время исполнения поручения, дней"]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="30" splitType="Stretch">
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="d2014534-0ee4-43cb-82d6-fd1d4e4ed21a" style="styleOdd" x="0" y="0" width="32" height="30" isPrintWhenDetailOverflows="true"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="DejaVu Sans Mono" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
					<paragraph lineSpacing="Single" spacingBefore="2" spacingAfter="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{REPORT_COUNT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="f9fab493-0abd-43c5-bd9c-2362ff2616e7" style="styleOdd" stretchType="RelativeToTallestObject" x="32" y="0" width="111" height="30"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{Col_NameTag} != null ? $F{Col_NameTag} : "")]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="6b3e2eae-fad6-4b12-9bb4-3b6de9ef6b72" style="styleOdd" stretchType="RelativeToTallestObject" x="143" y="0" width="110" height="30"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{Col_Count_Total} != null ? $F{Col_Count_Total} : "0")
+ " ("
	+ ($F{Col_Count_Total_Important} != null ? $F{Col_Count_Total_Important} : "0")
+ ")"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="2d7f69b0-3314-43ef-864a-2a4a31a6f048" style="styleOdd" stretchType="RelativeToTallestObject" x="253" y="0" width="110" height="30"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{Col_Count_Closed} != null ? $F{Col_Count_Closed} : "0")
+ " ("
	+ ( $F{Col_Count_Closed_important} != null ? $F{Col_Count_Closed_important} : "0")
+ ")"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="c8693afa-5d3a-458c-ad08-153c697f4751" style="styleOdd" stretchType="RelativeToTallestObject" x="363" y="0" width="110" height="30"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[(	(	$F{Col_Count_Total} != null
		&& $F{Col_Count_Total} != 0
		&& $F{Col_Count_Intime} != null
	)
	? msg( "{0,number,percent}", 1.0*$F{Col_Count_Intime}/$F{Col_Count_Total})
	: "0"
)]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="41545a1f-7be5-447e-a33d-bf03b018c83a" style="styleOdd" stretchType="RelativeToTallestObject" x="473" y="0" width="110" height="30"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[(	(	$F{Col_Count_Total} != null
		&& $F{Col_Count_Total} != 0
		&& $F{Col_Count_Boss_Refused} != null
	)
	? msg( "{0,number,percent}", 1.0*$F{Col_Count_Boss_Refused}/$F{Col_Count_Total})
	: "0"
)]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="7ac26120-8a22-4904-8c83-d3791b40a979" style="styleOdd" stretchType="RelativeToTallestObject" x="583" y="0" width="110" height="30"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[( (	$F{Col_Count_Total_Important} != null
	&& $F{Col_Count_Total_Important} != 0
	&& $F{Col_Count_Important_Refused} != null
   )
	? msg( "{0,number,percent}", 1.0*$F{Col_Count_Important_Refused}/$F{Col_Count_Total_Important})
	: "0"
)
+ " ("
	+ ($F{Col_Count_Important_Refused} != null	? $F{Col_Count_Important_Refused} : "0")
+ ")"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="###0.0" isBlankWhenNull="true">
				<reportElement uuid="395d5b94-f71f-4c51-b3cd-7979b971cd7b" style="styleOdd" stretchType="RelativeToTallestObject" x="693" y="0" width="109" height="30"/>
				<box>
					<pen lineWidth="0.5" lineColor="#78C0D4"/>
					<topPen lineWidth="0.5" lineColor="#78C0D4"/>
					<leftPen lineWidth="0.5" lineColor="#78C0D4"/>
					<bottomPen lineWidth="0.5" lineColor="#78C0D4"/>
					<rightPen lineWidth="0.5" lineColor="#78C0D4"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="12" pdfEncoding="Cp1251" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression><![CDATA[($F{Col_Avg_Execution.Value} != null ? $F{Col_Avg_Execution.Value} : 0)]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
