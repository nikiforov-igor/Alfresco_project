<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:util="http://www.springframework.org/schema/util"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd">

	<bean id="regNumbers.regNumbersBootstrap" parent="dictionaryModelBootstrap"
		  depends-on="dictionaryBootstrap, ru.it.lecm.dictionary.dictionary-repo.dictionary">
		<property name="models">
			<list>
				<value>alfresco/module/${artifactId}/models/regnumbers-model.xml</value>
			</list>
		</property>
		<property name="labels">
			<list>
				<value>alfresco/module/${artifactId}/messages/regnumbers</value>
			</list>
		</property>
	</bean>

	<bean id="regNumbers.regNumbersTemplatesDicBootstrap"
		  parent="lecmDictionaryBootstrap" depends-on="regNumbers.regNumbersBootstrap, businessJournalLogEventsPolicy" >
		<property name="dictionaries">
			<list>
				<value>alfresco/module/${artifactId}/models/regnumbers-templates-dictionary.xml</value>
			</list>
		</property>
		<property name="createOrUpdateDictionaries">
			<list>
				<value>alfresco/module/${artifactId}/models/regnumbers-templates-dictionary-items.xml</value>
			</list>
		</property>
	</bean>

	<bean id="regNumbersService" class="ru.it.lecm.regnumbers.bean.RegNumbersServiceImpl" init-method="init"
		  depends-on="regNumbers.regNumbersBootstrap, regNumbersCounterFactory, documentMembersService, serviceOrgstructure">
		<property name="nodeService" ref="nodeService"/>
		<property name="transactionService" ref="transactionService"/>
		<property name="searchService" ref="searchService"/>
		<property name="namespaceService" ref="namespaceService"/>
		<property name="dictionaryService" ref="serviceDictionary"/>
		<property name="documentService" ref="documentService"/>
		<property name="documentConnectionService" ref="documentConnectionService"/>
        <property name="orgstructureService" ref="serviceOrgstructure" />
	</bean>

	<util:constant id="REGNUMBERS_FOLDER_ID" static-field="ru.it.lecm.regnumbers.counter.CounterFactory.REGNUMBERS_FOLDER_ID"/>
	<bean id="regNumbersCounterFactory" class="ru.it.lecm.regnumbers.counter.CounterFactory" init-method="init" parent="baseBean"
		  depends-on="regNumbers.regNumbersBootstrap">
		<property name="nodeService" ref="nodeService"/>
		<property name="transactionService" ref="transactionService"/>
		<property name="namespaceService" ref="namespaceService"/>
		<property name="dictionaryService" ref="dictionaryService"/>
		<property name="folders">
			<map>
				<entry key="#{REGNUMBERS_FOLDER_ID}" value="Сервис Регистрационные номера"/>
			</map>
		</property>
	</bean>

	<bean id="regNumbersTaggedCounterRegistrator" class="ru.it.lecm.regnumbers.counter.TaggedCounterRegistrator" init-method="init" abstract="true">
		<property name="counterFactory" ref="regNumbersCounterFactory"/>
	</bean>

	<bean id="regNumbersTemplateUtils" class="ru.it.lecm.regnumbers.template.Utils" depends-on="serviceOrgstructure"/>

	<bean id="regNumbersJavascriptExtension" class="ru.it.lecm.regnumbers.extension.RegNumbersJavascriptExtension" parent="baseJavaScriptExtension">
		<property name="extensionName" value="regnumbers"/>
		<property name="regNumbersService" ref="regNumbersService"/>
		<property name="nodeService" ref="nodeService"/>
	</bean>

    <bean id="regnumbers.exportSettingsInitializer" parent="dictionary.exportSettingsInitializer" class="ru.it.lecm.dictionary.beans.ExportSettingsInitializerBean">
        <constructor-arg>
            <map>
                <entry key="lecm-regnum:template">
                    <list>
                        <value>cm:name</value>
                        <value>lecm-regnum:template-comment</value>
                        <value>lecm-regnum:template-service-id</value>
                        <value>lecm-regnum:template-string</value>
                    </list>
                </entry>
            </map>
        </constructor-arg>
    </bean>
</beans>
