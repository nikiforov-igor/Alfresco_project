<alfresco-config>

	<config>
		<forms>

			<dependencies>
				<js src="/scripts/lecm-contracts/constraints/contracts-validators.js"/>
				<!--js src="/scripts/lecm-contracts/get-stage-delete-message.js"/-->
			</dependencies>

            <default-controls>
                <type name="association:lecm-contract-dic:contract-type" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
                    <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Вид_x0020_договора</control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="itemType">lecm-contract-dic:contract-type</control-param>
                    <control-param name="plane">true</control-param>
                    <control-param name="showAssocViewForm">false</control-param>
                </type>
                <type name="association:lecm-contract-dic:contract-documents-type" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
                    <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Вид_x0020_документа_x0020_к_x0020_договору</control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="itemType">lecm-contract-dic:contract-documents-type</control-param>
                    <control-param name="plane">true</control-param>
                    <control-param name="showAssocViewForm">false</control-param>
                </type>
                <type name="association:lecm-currency:currency" template="/ru/it/lecm/base-share/components/controls/association-control.ftl">
                    <control-param name="rootLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Валюты</control-param>
                    <control-param name="showCreateNewLink">false</control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="itemType">lecm-currency:currency</control-param>
                    <control-param name="plane">true</control-param>
                </type>
                <type name="association:lecm-contract-dic:delete-reason" template="/ru/it/lecm/base-share/components/controls/association-select-one-control.ftl">
                    <control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Причины_x0020_удаления</control-param>
                    <control-param name="nameSubstituteString">{cm:name}</control-param>
                    <control-param name="notSelectedOptionShow">true</control-param>
                    <control-param name="notSelectedOptionLabel"> </control-param>
                    <control-param name="showCreateNewButton">false</control-param>
                </type>
            </default-controls>
		</forms>
	</config>

    <config evaluator="node-type" condition="lecm-contract-dic:contract-type">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-type-code" force="true"/>
					<show id="lecm-contract-dic:contract-type-description" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required" force="true"/>
                    <show id="lecm-doc-dic-dt:categories-of-attachments-to-sign" force="true"/>
                    <show id="load-set-default-categories-to-sign-script" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-contract-dic:contract-type-code" read-only="true"/>

                    <field id="lecm-doc-dic-dt:categories-of-attachments-to-sign">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-webscript-values.ftl">
                            <control-param name="webscript">lecm/document/attachments/api/categoriesByType?documentType=lecm-contract:document&amp;jsonObjectName=data</control-param>
                            <control-param name="webscriptType">server</control-param>
                            <control-param name="withEmpty">true</control-param>
                            <control-param name="emptyLabel">Все</control-param>
                            <control-param name="multiple">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-doc-dic-dt:es-sign-required">
                        <control>
                            <control-param name="changeFireAction">esSignRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="load-set-default-categories-to-sign-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/set-default-categories-to-sign-script.js</control-param>
                        </control>
                    </field>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-contract-dic:contract-type">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-type-code" force="true"/>
					<show id="lecm-contract-dic:contract-type-description" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required"/>
                    <show id="lecm-doc-dic-dt:categories-of-attachments-to-sign"/>
                    <show id="load-set-default-categories-to-sign-script" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-contract-dic:contract-type-code">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
							<constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup" />
						</constraint-handlers>
					</field>
                    <field id="lecm-doc-dic-dt:categories-of-attachments-to-sign">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-webscript-values.ftl">
                            <control-param name="webscript">lecm/document/attachments/api/categoriesByType?documentType=lecm-contract:document&amp;jsonObjectName=data</control-param>
                            <control-param name="webscriptType">server</control-param>
                            <control-param name="withEmpty">true</control-param>
                            <control-param name="emptyLabel">Все</control-param>
                            <control-param name="multiple">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-doc-dic-dt:es-sign-required">
                        <control>
                            <control-param name="changeFireAction">esSignRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="load-set-default-categories-to-sign-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/set-default-categories-to-sign-script.js</control-param>
                        </control>
                    </field>
				</appearance>
			</form>
			<form id="search">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-type-code" force="true"/>
					<show id="lecm-contract-dic:contract-type-description" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required"/>
                    <show id="lecm-doc-dic-dt:categories-of-attachments-to-sign"/>
				</field-visibility>
				<appearance>
                    <field id="cm:name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
					<field id="lecm-contract-dic:contract-type-code" mandatory="false">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
						</constraint-handlers>
					</field>
                    <field id="lecm-doc-dic-dt:categories-of-attachments-to-sign">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-webscript-values.ftl">
                            <control-param name="webscript">lecm/document/attachments/api/categoriesByType?documentType=lecm-contract:document&amp;jsonObjectName=data</control-param>
                            <control-param name="webscriptType">server</control-param>
                            <control-param name="withEmpty">true</control-param>
                            <control-param name="emptyLabel">Все</control-param>
                            <control-param name="multiple">true</control-param>
                        </control>
                    </field>
				</appearance>
			</form>
			<form id="datagrid">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-type-code" force="true"/>
					<show id="lecm-contract-dic:contract-type-description" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required"/>
                    <show id="categories-of-attachments-to-sign"/>
				</field-visibility>
                <appearance>
                    <field id="lecm-doc-dic-dt:es-sign-required" label-id="label.eds.document_type_dictionary.datagrid.signing_setting.es_required"/>
                    <field id="categories-of-attachments-to-sign" substituteString="{lecm-doc-dic-dt:categories-of-attachments-to-sign}" label-id="label.eds.document_type_dictionary.datagrid.signing_setting.categories"/>
                </appearance>
			</form>
		</forms>
	</config>

	<config evaluator="node-type" condition="lecm-contract-dic:contract-documents-type">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-documents-type-code" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required" force="true"/>
                    <show id="lecm-doc-dic-dt:categories-of-attachments-to-sign" force="true"/>
                    <show id="load-set-default-categories-to-sign-script" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-contract-dic:contract-documents-type-code" read-only="true"/>
                    <field id="lecm-doc-dic-dt:categories-of-attachments-to-sign">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-webscript-values.ftl">
                            <control-param name="webscript">lecm/document/attachments/api/categoriesByType?documentType=lecm-additional-document:additionalDocument&amp;jsonObjectName=data</control-param>
                            <control-param name="webscriptType">server</control-param>
                            <control-param name="withEmpty">true</control-param>
                            <control-param name="emptyLabel">Все</control-param>
                            <control-param name="multiple">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-doc-dic-dt:es-sign-required">
                        <control>
                            <control-param name="changeFireAction">esSignRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="load-set-default-categories-to-sign-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/set-default-categories-to-sign-script.js</control-param>
                        </control>
                    </field>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-contract-dic:contract-documents-type">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-documents-type-code" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required"/>
                    <show id="lecm-doc-dic-dt:categories-of-attachments-to-sign"/>
                    <show id="load-set-default-categories-to-sign-script" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-contract-dic:contract-documents-type-code">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
							<constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup" />
						</constraint-handlers>
					</field>
                    <field id="lecm-doc-dic-dt:categories-of-attachments-to-sign">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-webscript-values.ftl">
                            <control-param name="webscript">lecm/document/attachments/api/categoriesByType?documentType=lecm-additional-document:additionalDocument&amp;jsonObjectName=data</control-param>
                            <control-param name="webscriptType">server</control-param>
                            <control-param name="withEmpty">true</control-param>
                            <control-param name="emptyLabel">Все</control-param>
                            <control-param name="multiple">true</control-param>
                        </control>
                    </field>
                    <field id="lecm-doc-dic-dt:es-sign-required">
                        <control>
                            <control-param name="changeFireAction">esSignRequiredChanged</control-param>
                        </control>
                    </field>
                    <field id="load-set-default-categories-to-sign-script">
                        <control template="/ru/it/lecm/base-share/components/controls/load-script-control.ftl">
                            <control-param name="scripts">scripts/lecm-eds-documents/set-default-categories-to-sign-script.js</control-param>
                        </control>
                    </field>
				</appearance>
			</form>
			<form id="search">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-documents-type-code" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required"/>
                    <show id="lecm-doc-dic-dt:categories-of-attachments-to-sign"/>
				</field-visibility>
				<appearance>
                    <field id="cm:name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
					<field id="lecm-contract-dic:contract-documents-type-code" mandatory="false">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
						</constraint-handlers>
					</field>
                    <field id="lecm-doc-dic-dt:categories-of-attachments-to-sign">
                        <control template="/ru/it/lecm/base-share/components/controls/select-one-with-webscript-values.ftl">
                            <control-param name="webscript">lecm/document/attachments/api/categoriesByType?documentType=lecm-additional-document:additionalDocument&amp;jsonObjectName=data</control-param>
                            <control-param name="webscriptType">server</control-param>
                            <control-param name="withEmpty">true</control-param>
                            <control-param name="emptyLabel">Все</control-param>
                            <control-param name="multiple">true</control-param>
                        </control>
                    </field>
				</appearance>
			</form>
			<form id="datagrid">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:contract-documents-type-code" force="true"/>
                    <show id="lecm-doc-dic-dt:es-sign-required"/>
                    <show id="categories-of-attachments-to-sign"/>
				</field-visibility>
                <appearance>
                    <field id="lecm-doc-dic-dt:es-sign-required" label-id="label.eds.document_type_dictionary.datagrid.signing_setting.es_required"/>
                    <field id="categories-of-attachments-to-sign" substituteString="{lecm-doc-dic-dt:categories-of-attachments-to-sign}" label-id="label.eds.document_type_dictionary.datagrid.signing_setting.categories"/>
                </appearance>
			</form>
		</forms>
	</config>

	<config evaluator="node-type" condition="lecm-contract-dic:delete-reason">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:delete-reason-code" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-contract-dic:delete-reason-code" read-only="true"/>
				</appearance>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-contract-dic:delete-reason">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:delete-reason-code" force="true"/>
				</field-visibility>
				<appearance>
					<field id="lecm-contract-dic:delete-reason-code">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
							<constraint type="LECMUNIQUE" validation-handler="LogicECM.validation.uniquenessValidation" event="keyup" />
						</constraint-handlers>
					</field>
				</appearance>
			</form>
			<form id="search">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:delete-reason-code" force="true"/>
				</field-visibility>
				<appearance>
                    <field id="cm:name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
					<field id="lecm-contract-dic:delete-reason-code" mandatory="false">
						<control template="/ru/it/lecm/base-share/components/controls/unique.value.ftl"/>
						<constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
						</constraint-handlers>
					</field>
				</appearance>
			</form>
			<form id="datagrid">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:delete-reason-code" force="true"/>
				</field-visibility>
			</form>
		</forms>
	</config>

	<config evaluator="node-type" condition="lecm-contract-dic:reference-data">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:reference-data-link" force="true"/>
				</field-visibility>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-contract-dic:reference-data">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:reference-data-link" force="true"/>
				</field-visibility>
			</form>
			<form id="search">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:reference-data-link" force="true"/>
				</field-visibility>
                <appearance>
                    <field id="cm:name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-dic:reference-data-link" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                </appearance>
			</form>
			<form id="datagrid">
				<field-visibility>
					<show id="cm:name" force="true"/>
					<show id="lecm-contract-dic:reference-data-link" force="true"/>
				</field-visibility>
			</form>
		</forms>
	</config>


    <config evaluator="model-type" condition="lecm-orgstr:employee">
        <forms>
            <form id="dashlet-info">
                <field-visibility>
                    <show id="lecm-orgstr:employee-last-name"/>
                    <show id="lecm-orgstr:employee-first-name"/>
                    <show id="lecm-orgstr:employee-middle-name"/>
                    <show id="lecm-orgstr:employee-main-unit" force="true"/>
                    <show id="lecm-orgstr:employee-main-position" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-orgstr:employee-main-unit" substituteString="{..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../../lecm-orgstr:element-short-name}"/>
                    <field id="lecm-orgstr:employee-main-position" substituteString="{..lecm-orgstr:employee-link-employee-assoc(lecm-orgstr:employee-link-is-primary = true)/../lecm-orgstr:element-member-position-assoc/cm:name}"/>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-contract-dic:stage-status">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="cm:description" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-contract-dic:stage-status">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="cm:description" force="true"/>
                </field-visibility>
            </form>
            <form id="search">
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="cm:description" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="cm:name" mandatory="false">
                        <constraint-handlers>
                            <constraint type="MANDATORY" validation-handler="LogicECM.constraints.notMandatory" event="keyup" />
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="cm:name" force="true"/>
                    <show id="cm:description" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-contract-table-structure:stage">
        <forms>
            <form>
                <edit-form template="/ru/it/lecm/contracts/forms/stage-create-edit-form.ftl" />
                <view-form template="/ru/it/lecm/contracts/forms/stage-create-edit-form.ftl" />
                <field-visibility>
                    <show id="lecm-contract-table-structure:stage-status"/>
                    <show id="lecm-document:indexTableRow" force="true"/>
                    <show id="lecm-contract-table-structure:name" force="true"/>
                    <show id="lecm-contract-table-structure:start-date" force="true"/>
                    <show id="lecm-contract-table-structure:end-date" force="true"/>
                    <show id="lecm-contract-table-structure:start-date-real" force="true"/>
                    <show id="lecm-contract-table-structure:end-date-real" force="true"/>
                    <show id="lecm-contract-table-structure:stage-amount" force="true"/>
                    <show id="lecm-contract-table-structure:stage-comment"/>
                    <show id="lecm-contract-table-structure:attachments-temp-assoc" />
                    <show id="lecm-contract-table-structure:status-buttons" />
                </field-visibility>
                <appearance>
                    <field id="lecm-contract-table-structure:stage-amount" help=""/>
                    <field id="lecm-document:indexTableRow" help-id="label.stage.number.help"/>
                    <field id="lecm-contract-table-structure:stage-status">
                        <control template="/ru/it/lecm/base-share/components/controls/view-text-control.ftl"/>
                    </field>
                    <field id="lecm-contract-table-structure:start-date">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-table-structure:end-date">
                        <control>
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-table-structure:attachments-temp-assoc" >
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.contracts.attachments</control-param>
                            <control-param name="showUploadNewVersion">true</control-param>
                            <control-param name="checkRights">true</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                            <control-param name="showPreview">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-contract-table-structure:stage-comment">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                    <field id="lecm-contract-table-structure:status-buttons">
                        <control template="/ru/it/lecm/contracts/controls/status-buttons.ftl"/>
                    </field>
                </appearance>
            </form>
            <form id="table-structure-info">
                <field-visibility>
                    <show id="lecm-contract-table-structure:name" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="model-type" condition="lecm-contract-table-structure:stage">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-contract-table-structure:name" force="true"/>
                    <show id="lecm-contract-table-structure:start-date" force="true"/>
                    <show id="lecm-contract-table-structure:end-date" force="true"/>
                    <show id="lecm-contract-table-structure:stage-amount" force="true"/>
                    <show id="lecm-contract-table-structure:stage-comment" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-contract-table-structure:start-date">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-table-structure:end-date">
                        <control>
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-table-structure:stage-amount" help=""/>
                    <field id="lecm-document:indexTableRow" help-id="label.stage.number.help"/>
                    <field id="lecm-contract-table-structure:stage-comment">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                </appearance>
            </form>
            <form id="json-datagrid-item">
                <field-visibility>
                    <show id="lecm-contract-table-structure:name" force="true"/>
                    <show id="lecm-contract-table-structure:start-date" force="true"/>
                    <show id="lecm-contract-table-structure:end-date" force="true"/>
                    <show id="lecm-contract-table-structure:stage-amount" force="true"/>
                    <show id="lecm-contract-table-structure:stage-comment" force="true"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-contract-table-structure:stage-amount" help=""/>
                    <field id="lecm-document:indexTableRow" help-id="label.stage.number.help"/>
                    <field id="lecm-contract-table-structure:stage-comment">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                    <field id="lecm-contract-table-structure:start-date">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-table-structure:end-date">
                        <control>
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                </appearance>
            </form>
            <form id="json-datagrid-item-edit">
                <create-form template="/ru/it/lecm/contracts/forms/stage-create-edit-form.ftl"/>
                <field-visibility>
                    <show id="lecm-contract-table-structure:stage-status"/>
                    <show id="lecm-document:indexTableRow"/>
                    <show id="lecm-contract-table-structure:name"/>
                    <show id="lecm-contract-table-structure:start-date"/>
                    <show id="lecm-contract-table-structure:end-date"/>
                    <show id="lecm-contract-table-structure:start-date-real"/>
                    <show id="lecm-contract-table-structure:end-date-real"/>
                    <show id="lecm-contract-table-structure:stage-amount"/>
                    <show id="lecm-contract-table-structure:stage-comment"/>
                    <show id="lecm-contract-table-structure:attachments-temp-assoc"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-document:indexTableRow" help-id="label.stage.number.help"/>
                    <field id="lecm-contract-table-structure:stage-status" read-only="true">
                        <control template="/ru/it/lecm/base-share/components/controls/selectone.ftl"/>
                    </field>
                    <field id="lecm-contract-table-structure:start-date">
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-table-structure:end-date">
                        <control>
                            <control-param name="changeFireAction">mandatoryControlValueUpdated</control-param>
                        </control>
                        <constraint-handlers>
                            <constraint type="INVALID" validation-handler="LogicECM.module.Contracts.stageDateRangeValidator" message-id="validation.message.contracts.stage.date.error" event="change"/>
                        </constraint-handlers>
                    </field>
                    <field id="lecm-contract-table-structure:attachments-temp-assoc" >
                        <control template="/ru/it/lecm/base-share/components/controls/lecm-dnd-uploader-control.ftl">
                            <control-param name="uploadDirectoryPath">{usertemp}</control-param>
                            <control-param name="directoryName">label.contracts.attachments</control-param>
                            <control-param name="showUploadNewVersion">true</control-param>
                            <control-param name="checkRights">false</control-param>
                            <control-param name="suppressRefreshEvent">true</control-param>
                            <control-param name="showPreview">false</control-param>
                        </control>
                    </field>
                    <field id="lecm-contract-table-structure:stage-comment">
                        <control template="/ru/it/lecm/base-share/components/controls/richtext.ftl"/>
                    </field>
                </appearance>
            </form>
            <form id="datagrid">
                <field-visibility>
                    <show id="lecm-document:indexTableRow" force="true"/>
                    <show id="lecm-contract-table-structure:name" force="true"/>
                    <show id="lecm-contract-table-structure:stage-amount" force="true"/>
                    <show id="lecm-contract-table-structure:start-date" force="true"/>
                    <show id="lecm-contract-table-structure:end-date" force="true"/>
                    <show id="lecm-contract-table-structure:stage-status" />
                    <show id="lecm-contract-table-structure:attachments-temp-assoc" />
                </field-visibility>
            </form>
            <form id="stages-dashlet">
                <field-visibility>
                    <show id="lecm-contract-table-structure:name" force="true"/>
                    <show id="lecm-contract-table-structure:stage-status"/>
                    <show id="lecm-contract-table-structure:stage-amount"/>
                    <show id="lecm-contract-table-structure:end-date"/>
                </field-visibility>
                <appearance>
                    <field id="lecm-contract-table-structure:name" />
                    <field id="lecm-contract-table-structure:stage-status" />
                    <field id="lecm-contract-table-structure:stage-amount" label-id="stage.totalAmount"/>
                    <field id="lecm-contract-table-structure:end-date" />
                </appearance>
            </form>

        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-contract-ext:dashlet-settings">
        <forms>
            <form>
                <field-visibility>
                    <show id="lecm-contract-ext:dashlet-settings-code" force="true"/>
                    <show id="lecm-contract-ext:dashlet-settings-path" force="true"/>
                </field-visibility>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$createOnBasis">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems" />
					<show id="lecmContractWf:documentType" />
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmContractWf:documentType" label-id="contract.additionalDocumentType">
						<control template="/ru/it/lecm/base-share/components/controls/association-select-one-control.ftl">
							<control-param name="startLocation">/app:company_home/cm:Business_x0020_platform/cm:LECM/cm:Сервис_x0020_Справочники/lecm-dic:Вид_x0020_документа_x0020_к_x0020_договору</control-param>
							<control-param name="nameSubstituteString">{cm:name}</control-param>
							<control-param name="notSelectedOptionShow">true</control-param>
							<control-param name="notSelectedOptionLabel"> </control-param>
							<control-param name="showCreateNewButton">false</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$contractsDeleteReason">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems" />
                    <show id="lecmContractWf:deleteReason" />
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmContractWf:deleteReason" label-id="contract.deleteReason"/>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$contractsContractTime">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems" />
                    <show id="lecmContractWf:contractTimeFromDate" />
                    <show id="lecmContractWf:contractTimeToDate" />
                    <show id="lecmContractWf:contractTimeUnlimited" />
                    <show id="lecmContractWf:contractTimeBaseOnDocument" />
                    <show id="lecmContractWf:fillProperties" />
                </field-visibility>
                <appearance>
                    <set id="dates" appearance="" template="/ru/it/lecm/base-share/components/controls/daterange.ftl" />
                    <set id="documents" appearance=""/>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmContractWf:contractTimeFromDate" set="dates" label-id="contract.daterange"/>
                    <field id="lecmContractWf:contractTimeToDate" set="dates" label=""/>
                    <field id="lecmContractWf:contractTimeUnlimited" set="dates" label-id="contract.contractTime.unlimited"/>
                    <field id="lecmContractWf:contractTimeBaseOnDocument" label-id="contract.contractTime.baseOnDocument" set="documents">
                        <control template="/ru/it/lecm/contracts/component/contracts-based-on-document.ftl"/>
                    </field>
                    <field id="lecmContractWf:fillProperties">
                        <control template="/ru/it/lecm/base-share/components/controls/fill-properties-control.ftl">
                            <control-param name="properties">lecm-contract:startDate->lecmContractWf:contractTimeFromDate, lecm-contract:endDate->lecmContractWf:contractTimeToDate</control-param>
                        </control>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$contractsTermination">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems" />
					<show id="lecmContractWf:contractTerminateBaseOnDocument" />
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmContractWf:contractTerminateBaseOnDocument" label-id="contract.contractTermination.baseOnDocument">
						<control template="/ru/it/lecm/contracts/component/contracts-based-on-document.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config evaluator="string-compare" condition="activiti$contractExecuted">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems" />
                    <show id="lecmContractWf:contractExecutedQuestion" />
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmContractWf:contractExecutedQuestion">
                        <control template="/ru/it/lecm/contracts/controls/stages.ftl" />
                    </field>
                </appearance>
            </form>
        </forms>
    </config>


    <config evaluator="string-compare" condition="Workflow">
		<hidden-workflows>
			<workflow name="activiti$createOnBasis"/>
			<workflow name="activiti$contractsDeleteReason"/>
			<workflow name="activiti$contractsContractTime"/>
			<workflow name="activiti$contractsTermination"/>
			<workflow name="activiti$approvalForce"/>
			<workflow name="activiti$approvalTermination"/>
			<workflow name="activiti$lecm-additional-document_additionalDocument"/>
			<workflow name="activiti$lecm-contract_document"/>
            <workflow name="activiti$contractsSignContractor"/>
            <workflow name="activiti$addDocSignContractor"/>
		    <workflow name="activiti$contractExecuted"/>
            <workflow name="activiti$contractAdditionalDocumentCancel"/>
		</hidden-workflows>
	</config>

	<config evaluator="string-compare" condition="LECMStatemachineWorkflow">
		<hidden-workflows>
			<workflow name="activiti$lecm-additional-document_additionalDocument"/>
			<workflow name="activiti$lecm-contract_document"/>
		</hidden-workflows>
	</config>

    <config evaluator="string-compare" condition="activiti$contractsSignContractor">
        <forms>
            <form>
                <field-visibility>
                    <show id="packageItems" />
                    <show id="lecmContractWf:contractorSigner" />
                </field-visibility>
                <appearance>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                    <field id="lecmContractWf:contractorSigner"/>
                </appearance>
            </form>
        </forms>
    </config>

    <config evaluator="string-compare" condition="activiti$addDocSignContractor">
        <forms>
            <form>
                <field-visibility>
                    <show id="warning"/>
                    <show id="packageItems"/>
                </field-visibility>
                <appearance>
                    <field id="warning">
                        <control template="/ru/it/lecm/base-share/components/controls/message-control.ftl">
                            <control-param name="msg">ru.it.contracts.signContractor</control-param>
                        </control>
                    </field>
                    <field id="packageItems">
                        <control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
                    </field>
                </appearance>
            </form>
        </forms>
    </config>

	<config evaluator="string-compare" condition="activiti$contractAdditionalDocumentCancel">
		<forms>
			<form>
				<field-visibility>
					<show id="packageItems" />
					<show id="lecmContractWf:contractAdditionalDocumentCancelBaseOnDocument" />
				</field-visibility>
				<appearance>
					<field id="packageItems">
						<control template="/ru/it/lecm/base-share/components/controls/hidden-association-control.ftl"/>
					</field>
					<field id="lecmContractWf:contractAdditionalDocumentCancelBaseOnDocument" label-id="contract.contractAdditionalDocumentCancel.baseOnDocument">
						<control template="/ru/it/lecm/contracts/component/contracts-based-on-document.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>

    <config>
        <forms>
            <dependencies>

<!--<js src="/scripts/lecm-contracts/lecm-package-items-finder.js" />-->

<!--<js src="/scripts/lecm-contracts/contracts-based-on-document.js" />-->
                <css src="/css/lecm-contracts/contracts-table-data.css" />
            </dependencies>
        </forms>
    </config>

    <config evaluator="node-type" condition="lecm-contract-table-structure:stagesTable">
        <forms>
            <form>
                <field-visibility>
                    <show id="cm:name"/>
                </field-visibility>
            </form>
        </forms>
    </config>

</alfresco-config>
