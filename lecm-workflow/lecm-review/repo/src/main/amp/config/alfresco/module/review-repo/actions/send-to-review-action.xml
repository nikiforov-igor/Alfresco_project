<?xml version='1.0' encoding='UTF-8'?>
<items updateMode="CreateOrUpdate">
	<item name="cm:Отправить на ознакомление" type="lecm-group-actions:script-action">
		<property name="lecm-group-actions:expression"><![CDATA[doc.hasAspect('lecm-review-ts:review-aspect') AND (lecmPermission.hasPermission(doc, "_lecmPerm_ActionExec") OR user.currentUser.hasBusinessRole('DA_ENGINEER') OR user.currentUser.hasBusinessRole('DA_REGISTRARS'))]]></property>
		<property name="cm:name"><![CDATA[Отправить на ознакомление]]></property>
		<property name="lecm-group-actions:statuses"><![CDATA[]]></property>
		<property name="lecm-group-actions:isGroup"><![CDATA[false]]></property>
		<property name="lecm-group-actions:forCollection"><![CDATA[false]]></property>
		<property name="lecm-group-actions:script"><![CDATA[
<import resource="classpath:/alfresco/templates/webscripts/ru/it/lecm/workflow/review/form/review-ts.form.lib.js">
(function() {
	var i,
		reviewInfo,
		reviewTsItems = [],
		reviewTable = document.associations['lecm-review-ts:review-table-assoc'];

	if (reviewTable && reviewTable.length) {
		reviewTable = reviewTable[0];
		reviewInfo = reviewTable.createNode(null, 'lecm-review-info:info', {
		});
		if ('string' === typeof reviewers) {
			reviewers = reviewers.split(',');
			for (i in reviewers) {
				reviewers[i] = utils.getNodeFromString(reviewers[i]);
			}
		} else {
			reviewers = [reviewers];
		}
		reviewTsItems = createReviewTSItem(reviewInfo, reviewers);
		sendToReview(reviewInfo, reviewTsItems);
	}

	model.message = (reviewTsItems.length) ? 'Документ отправлен на ознакомление' : 'Нет сотрудников для ознакомления с документом';
	model.showModalWindow = true;
})();
]]></property>
		<property name="lecm-group-actions:order"><![CDATA[0]]></property>
		<property name="cm:title"><![CDATA[Отправить на ознакомление]]></property>
		<property name="lecm-group-actions:availableForReader"><![CDATA[false]]></property>
		<items>
			<item name="cm:Ознакамливающийся" type="lecm-group-actions:form-field">
				<property name="cm:name"><![CDATA[Ознакамливающийся]]></property>
				<property name="lecm-group-actions:field-default-value"><![CDATA[]]></property>
				<property name="lecm-group-actions:field-id"><![CDATA[reviewers]]></property>
				<property name="lecm-group-actions:field-is-mandatory"><![CDATA[true]]></property>
				<property name="lecm-group-actions:field-type"><![CDATA[lecm-review-ts:reviewers]]></property>
				<property name="lecm-group-actions:field-priority"><![CDATA[0]]></property>
			</item>
			<item name="cm:Сохранить список" type="lecm-group-actions:form-field">
				<property name="cm:name"><![CDATA[Сохранить список]]></property>
				<property name="lecm-group-actions:field-default-value"><![CDATA[]]></property>
				<property name="lecm-group-actions:field-id"><![CDATA[saveas]]></property>
				<property name="lecm-group-actions:field-is-mandatory"><![CDATA[false]]></property>
				<property name="lecm-group-actions:field-type"><![CDATA[lecm-review-ts:saveas]]></property>
				<property name="lecm-group-actions:field-priority"><![CDATA[1]]></property>
			</item>
		</items>
	</item>
</items>
