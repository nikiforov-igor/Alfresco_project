<?xml version='1.0' encoding='UTF-8'?>
<alfresco-config>
	<!--Список годов-->
	<config evaluator="model-type" condition="lecm-cal:calendar">
		<forms>
			<form id="datagrid">
				<field-visibility>
					<show id="lecm-cal:year"/>
					<show id="lecm-cal:comment"/>
				</field-visibility>
			</form>
			<form id="createNewYearForm">
				<field-visibility>
					<show id="lecm-cal:year"/>
					<show id="lecm-cal:comment"/>
				</field-visibility>
			</form>
		</forms>
	</config>
	<config evaluator="node-type" condition="lecm-cal:calendar">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-cal:comment"/>
				</field-visibility>
			</form>
		</forms>
	</config>
	<!--Рабочие дни-->
	<config evaluator="model-type" condition="lecm-cal:working-days">
		<forms>
			<form id="datagrid">
				<field-visibility>
					<show id="lecm-cal:day"/>
					<show id="lecm-cal:reason"/>
				</field-visibility>
			</form>
			<form id="createNewSpecialDayForm">
				<field-visibility>
					<show id="lecm-cal:day"/>
					<show id="lecm-cal:reason"/>
				</field-visibility>
				<appearance>
					<field id="lecm-cal:day"  mandatory="true">
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Calendar.SpecialDays.dayExistenceValidation"	
										event="blur" message-id="message.new-date.error" />
						</constraint-handlers>
						<control template="/ru/it/lecm/wcalendar/controls/date-augmented.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>
	<config evaluator="node-type" condition="lecm-cal:working-days">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-cal:reason"/>
				</field-visibility>
			</form>
		</forms>
	</config>
	<!--Выходные дни-->
	<config evaluator="model-type" condition="lecm-cal:non-working-days">
		<forms>
			<form id="datagrid">
				<field-visibility>
					<show id="lecm-cal:day"/>
					<show id="lecm-cal:reason"/>
				</field-visibility>
			</form>
			<form id="createNewSpecialDayForm">
				<field-visibility>
					<show id="lecm-cal:day"/>
					<show id="lecm-cal:reason"/>
				</field-visibility>
				<appearance>
					<field id="lecm-cal:day"  mandatory="true">
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Calendar.SpecialDays.dayExistenceValidation"
										event="blur" message-id="message.new-date.error" />
						</constraint-handlers>
						<control template="/ru/it/lecm/wcalendar/controls/date-augmented.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>
	<config evaluator="node-type" condition="lecm-cal:non-working-days">
		<forms>
			<form>
				<field-visibility>
					<show id="lecm-cal:reason"/>
				</field-visibility>
			</form>
		</forms>
	</config>

	<config evaluator="model-type" condition="lecm-shed:shedule">
		<forms>
			<form id="datagrid">
				<field-visibility>
					<show id="lecm-shed:shed-employee-link-assoc"/>
					<show id="lecm-shed:std-begin"/>
					<show id="lecm-shed:std-end"/>
					<show id="lecm-shed:type"/>
				</field-visibility>
			</form>
			<form id="createNewCommonSheduleForm">
				<field-visibility>
					<show id="lecm-shed:shed-employee-link-assoc"/>
					<show id="lecm-shed:std-begin"/>
					<show id="lecm-shed:std-end"/>
					<show id="lecm-shed:type"/>
				</field-visibility>
				<appearance>
					<set id="time" template="/org/alfresco/components/form/2-column-set.ftl" appearance="title" label-id="label.shedule.form.set.work-time" />
					<field id="lecm-shed:std-begin" mandatory="true" set="time">
						<control template="/org/alfresco/components/form/controls/textfield.ftl" />
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Shedule.timeValidation"
										event="keyup" message-id="message.time-format.error" />
						</constraint-handlers>
					</field>
					<field id="lecm-shed:std-end" mandatory="true" set="time">
						<control template="/org/alfresco/components/form/controls/textfield.ftl" />
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Shedule.timeValidation"
										event="keyup" message-id="message.time-format.error" />
						</constraint-handlers>
					</field>
					<field id="lecm-shed:shed-employee-link-assoc" mandatory="true">
						<control template="/ru/it/lecm/wcalendar/controls/double-picker-control.ftl">
							<control-param name="startLocation1">/app:company_home/cm:Организация/cm:Структура</control-param>
							<control-param name="startLocation2">/app:company_home/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="rootNode1">/app:company_home/cm:Организация/cm:Структура</control-param>
							<control-param name="rootNode2">/app:company_home/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="pickerLabel1">label.shedule.form.picker.orgstructure</control-param>
							<control-param name="pickerLabel2">label.shedule.form.picker.employee</control-param>
							<control-param name="itemType1">lecm-orgstr:organization-unit</control-param>
							<control-param name="itemType2">lecm-orgstr:employee</control-param>
							<control-param name="endpointMandatory">true</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="multipleSelectMode">false</control-param>
						</control>
					</field>
					<field id="lecm-shed:type">
						<control template="/ru/it/lecm/wcalendar/controls/hidden-patiently-value.ftl">
							<control-param name="value">COMMON</control-param>
						</control>
					</field>
				</appearance>
			</form>
			<form id="createNewSpecialSheduleForm">
				<field-visibility>
					<show id="lecm-shed:shed-employee-link-assoc"/>
					<show id="lecm-shed:time-limit-start"/>
					<show id="lecm-shed:time-limit-end"/>
					<show id="reiteration-rules"/>
					<show id="lecm-shed:std-begin"/>
					<show id="lecm-shed:std-end"/>
					<show id="lecm-shed:type"/>
				</field-visibility>
				<appearance>
					<set id="time-limit" template="/org/alfresco/components/form/2-column-set.ftl" appearance="title" label-id="label.shedule.form.set.date-interval" />
					<set id="reiteration-rules"  appearance="title" label-id="label.shedule.form.reiteration-rules" />
					<set id="time" template="/org/alfresco/components/form/2-column-set.ftl" appearance="title" label-id="label.shedule.form.set.work-time" />
					<field id="lecm-shed:shed-employee-link-assoc" mandatory="true">
						<control template="/ru/it/lecm/wcalendar/controls/double-picker-control.ftl">
							<control-param name="startLocation1">/app:company_home/cm:Организация/cm:Структура</control-param>
							<control-param name="startLocation2">/app:company_home/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="rootNode1">/app:company_home/cm:Организация/cm:Структура</control-param>
							<control-param name="rootNode2">/app:company_home/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="pickerLabel1">label.shedule.form.picker.orgstructure</control-param>
							<control-param name="pickerLabel2">label.shedule.form.picker.employee</control-param>
							<control-param name="itemType1">lecm-orgstr:organization-unit</control-param>
							<control-param name="itemType2">lecm-orgstr:employee</control-param>
							<control-param name="endpointMandatory">true</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="multipleSelectMode">false</control-param>
						</control>
					</field>
					<field id="lecm-shed:std-begin" mandatory="true" set="time">
						<control template="/org/alfresco/components/form/controls/textfield.ftl" />
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Shedule.timeValidation"
										event="keyup" message-id="message.time-format.error" />
						</constraint-handlers>
					</field>
					<field id="lecm-shed:std-end" mandatory="true" set="time">
						<control template="/org/alfresco/components/form/controls/textfield.ftl" />
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Shedule.timeValidation"
										event="keyup" message-id="message.time-format.error" />
						</constraint-handlers>
					</field>
					<field id="lecm-shed:type">
						<control template="/ru/it/lecm/wcalendar/controls/hidden-patiently-value.ftl">
							<control-param name="value">SPECIAL</control-param>
						</control>
					</field>
					<!-- TODO: добавить валидатор, проверяющий, что окончание срока действия расписания ПОЗЖЕ его начала. -->
					<field id="lecm-shed:time-limit-start" label-id="label.shedule.form.set.date-interval.begin" mandatory="true" set="time-limit"/>
					<field id="lecm-shed:time-limit-end" label-id="label.shedule.form.set.date-interval.end" mandatory="true" set="time-limit"/>
					<!-- TODO: в сам контрол добавить проверку на обязательные поля -->
					<field id="reiteration-rules" label-id="label.shedule.form.reiteration-rules" mandatory="true" set="reiteration-rules">
						<control template="/ru/it/lecm/wcalendar/controls/reiteration-rules-control.ftl"/>
					</field>
				</appearance>
			</form>
		</forms>
	</config>
	<config evaluator="model-type" condition="lecm-absence:absence">
		<forms>
			<form id="absenceProfileDatagrid">
				<field-visibility>
					<show id="lecm-absence:begin"/>
					<show id="lecm-absence:end"/>
					<show id="lecm-absence:unlimited"/>
					<show id="lecm-absence:comment"/>
					<show id="lecm-absence:abscence-reason-assoc"/>
				</field-visibility>
			</form>
			<form id="absenceAdminDatagrid">
				<field-visibility>
					<show id="lecm-absence:abscent-employee-assoc"/>
					<show id="lecm-absence:begin"/>
					<show id="lecm-absence:end"/>
					<show id="lecm-absence:unlimited"/>
					<show id="lecm-absence:comment"/>
					<show id="lecm-absence:abscence-reason-assoc"/>					
				</field-visibility>
			</form>
			<form id="createNewEmployeeAbsenceForm">
				<field-visibility>
					<show id="lecm-absence:abscent-employee-assoc"/>
					<show id="lecm-absence:begin"/>
					<show id="lecm-absence:end"/>
					<show id="lecm-absence:unlimited"/>
					<show id="lecm-absence:comment"/>
					<show id="lecm-absence:abscence-reason-assoc"/>
				</field-visibility>
				<appearance>
					<set id="dates" template="/ru/it/lecm/wcalendar/controls/2-column-set-augmented.ftl" appearance="title" label-id="label.absence.form.set.date-interval" />
					<set id="unlimited"/>
					<set id="abscence-reason"/>
					<set id="comment"/>
					<field id="lecm-absence:abscent-employee-assoc">
						<control template="/ru/it/lecm/base-share/components/controls/association-autocomplete-control.ftl">
							<control-param name="startLocation">/app:company_home/cm:Организация/cm:Сотрудники</control-param>
							<control-param name="showCreateNewLink">false</control-param>
							<control-param name="showCreateNewButton">false</control-param>
							<control-param name="nameSubstituteString">{cm:name}</control-param>
						</control>
					</field>
					<field id="lecm-absence:begin" mandatory="true" set="dates">
						<control template="/org/alfresco/components/form/controls/date.ftl">
							<control-param name="showTime">false</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Absence.dateIntervalValidation" event="blur" />
						</constraint-handlers>
					</field>
					<field id="lecm-absence:end" mandatory="true" set="dates">
						<control template="/org/alfresco/components/form/controls/date.ftl">
							<control-param name="showTime">false</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Absence.dateIntervalValidation" event="blur" />
						</constraint-handlers>
					</field>
					<field id="lecm-absence:unlimited" set="unlimited">
						<control template="/ru/it/lecm/wcalendar/controls/checkbox-disabling-field.ftl"/>
					</field>
					<field id="lecm-absence:abscence-reason-assoc" set="abscence-reason">
						<control template="/ru/it/lecm/base-share/components/controls/association-select-one-control.ftl">
							<control-param name="startLocation">/app:company_home/lecm-dic:Dictionary/lecm-dic:Причины_x0020_отсутствия</control-param>
							<control-param name="nameSubstituteString">{lecm-absence:code} - {cm:name}</control-param>
							<control-param name="notSelectedOptionShow">true</control-param>
							<control-param name="notSelectedOptionLabel"> </control-param>
							<control-param name="showCreateNewButton">true</control-param>
						</control>
					</field>
					<field id="lecm-absence:comment" set="comment"/>
				</appearance>
			</form>
			<form id="createNewMyAbsenceForm">
				<field-visibility>
					<show id="lecm-absence:abscent-employee-assoc"/>
					<show id="lecm-absence:begin"/>
					<show id="lecm-absence:end"/>
					<show id="lecm-absence:unlimited"/>
					<show id="lecm-absence:comment"/>
					<show id="lecm-absence:abscence-reason-assoc"/>
				</field-visibility>
				<appearance>
					<set id="dates" template="/ru/it/lecm/wcalendar/controls/2-column-set-augmented.ftl" appearance="title" label-id="label.absence.form.set.date-interval" />
					<set id="unlimited"/>
					<set id="abscence-reason"/>
					<set id="comment"/>
					<field id="lecm-absence:abscent-employee-assoc" >
						<control template="/ru/it/lecm/wcalendar/controls/hidden-current-employee.ftl"/>
					</field>
					<field id="lecm-absence:begin" set="dates">
						<control template="/org/alfresco/components/form/controls/date.ftl">
							<control-param name="showTime">false</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Absence.dateIntervalValidation" event="blur"/>
						</constraint-handlers>
					</field>
					<field id="lecm-absence:end" mandatory="true" set="dates">
						<control template="/org/alfresco/components/form/controls/date.ftl">
							<control-param name="showTime">false</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Absence.dateIntervalValidation" event="blur"/>
						</constraint-handlers>
					</field>
					<field id="lecm-absence:unlimited" mandatory="true" set="unlimited">
						<control template="/ru/it/lecm/wcalendar/controls/checkbox-disabling-field.ftl"/>
					</field>
					<field id="lecm-absence:abscence-reason-assoc" set="abscence-reason">
						<control template="/ru/it/lecm/base-share/components/controls/association-select-one-control.ftl">
							<control-param name="startLocation">/app:company_home/lecm-dic:Dictionary/lecm-dic:Причины_x0020_отсутствия</control-param>
							<control-param name="nameSubstituteString">{lecm-absence:code} - {cm:name}</control-param>
							<control-param name="notSelectedOptionShow">true</control-param>
							<control-param name="notSelectedOptionLabel"> </control-param>
							<control-param name="showCreateNewButton">false</control-param>
						</control>
					</field>
					<field id="lecm-absence:comment" set="comment"/>
				</appearance>
			</form>
			<form id="createNewInstantAbsenceForm">
				<field-visibility>
					<show id="lecm-absence:abscent-employee-assoc"/>
					<show id="lecm-absence:begin"/>
					<show id="lecm-absence:end"/>
					<show id="lecm-absence:unlimited"/>
					<show id="lecm-absence:abscence-reason-assoc"/>
					<show id="lecm-absence:comment"/>					
				</field-visibility>
				<appearance>
					<!--"fieldset", "panel", "bordered-panel", "title" and "whitespace"-->
					<set id="out-of-office" template="/org/alfresco/components/form/2-column-set.ftl" appearance="" label=""/>
					<set id="additional" template="/org/alfresco/components/form/2-column-set.ftl" appearance="" label=""/>
					<field id="lecm-absence:abscent-employee-assoc" >
						<control template="/ru/it/lecm/wcalendar/controls/hidden-current-employee.ftl"/>
					</field>
					<field id="lecm-absence:begin">
						<control template="/org/alfresco/components/form/controls/hidden.ftl"/>
					</field>
					<field id="lecm-absence:end" mandatory="true" label-id="label.absence.form.out-of-office.back" set="out-of-office">
						<control template="/ru/it/lecm/wcalendar/controls/date-augmented.ftl">
							<control-param name="showTime">false</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Absence.dateIsNotBeforeToday" event="blur"  message-id="message.error.absence.date-interval-validation.early-end"/>
						</constraint-handlers>
					</field>
					<field id="lecm-absence:unlimited" mandatory="true" label-id="label.absence.form.out-of-office.unlimited" set="out-of-office">
						<control template="/ru/it/lecm/wcalendar/controls/checkbox-disabling-field.ftl">
							<control-param name="isTrue">true</control-param>
						</control>
					</field>
					<field id="lecm-absence:abscence-reason-assoc" mandatory="true" set="additional" label-id="label.absence.form.out-of-office.reason">
						<control template="/ru/it/lecm/base-share/components/controls/association-select-one-control.ftl">
							<control-param name="startLocation">/app:company_home/lecm-dic:Dictionary/lecm-dic:Причины_x0020_отсутствия</control-param>
							<control-param name="nameSubstituteString">{lecm-absence:code} - {cm:name}</control-param>
							<control-param name="notSelectedOptionShow">true</control-param>
							<control-param name="notSelectedOptionLabel"> </control-param>
							<control-param name="showCreateNewButton">false</control-param>
						</control>
						<constraint-handlers>
							<constraint type="MANDATORY" validation-handler="LogicECM.module.WCalendar.Absence.instantAbsenceReasonValidation" event="blur"/>
						</constraint-handlers>
					</field>
					<field id="lecm-absence:comment" set="additional"/>
				</appearance>
			</form>
		</forms>
	</config>
	<config evaluator="model-type" condition="lecm-absence:reason">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name"/>
					<show id="lecm-absence:code"/>
					<show id="lecm-absence:color"/>
				</field-visibility>
				<appearance>
					<field id="lecm-absence:color">
						<control template="/ru/it/lecm/wcalendar/controls/color-picker.ftl">
							<control-param name="styleClass">color</control-param>
						</control>
					</field>
				</appearance>
			</form>
			<form id="datagrid">
				<field-visibility>
					<show id="cm:name"/>
					<show id="lecm-absence:code"/>
					<show id="lecm-absence:color"/>
				</field-visibility>
			</form>
		</forms>
	</config>
	<config evaluator="node-type" condition="lecm-absence:reason">
		<forms>
			<form>
				<field-visibility>
					<show id="cm:name"/>
					<show id="lecm-absence:code"/>
					<show id="lecm-absence:color"/>
				</field-visibility>
				<appearance>
					<field id="lecm-absence:color">
						<control template="/ru/it/lecm/wcalendar/controls/color-picker.ftl">
							<control-param name="styleClass">color</control-param>
						</control>
					</field>
				</appearance>
			</form>
		</forms>
	</config>
</alfresco-config>
